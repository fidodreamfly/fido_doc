<!DOCTYPE html>
<html lang="en" dir="ltr" typeof="bibo:Document w3p:REC" about="" property="dcterms:language" content="en">
<head>
    <title>FIDO UAF Application API and Transport Binding Specification v1.0</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    
    
    

  <style>/*****************************************************************
 * ReSpec 3 CSS
 * Robin Berjon - http://berjon.com/
 *****************************************************************/

/* --- INLINES --- */
em.rfc2119 { 
    text-transform:     lowercase;
    font-variant:       small-caps;
    font-style:         normal;
    color:              #900;
}

h1 acronym, h2 acronym, h3 acronym, h4 acronym, h5 acronym, h6 acronym, a acronym,
h1 abbr, h2 abbr, h3 abbr, h4 abbr, h5 abbr, h6 abbr, a abbr {
    border: none;
}

dfn {
    font-weight:    bold;
}

a.internalDFN {
    color:  inherit;
    border-bottom:  1px solid #99c;
    text-decoration:    none;
}

a.externalDFN {
    color:  inherit;
    border-bottom:  1px dotted #ccc;
    text-decoration:    none;
}

a.bibref {
    text-decoration:    none;
}

cite .bibref {
    font-style: normal;
}

code {
    color:  #ff4500;
}

/* --- TOC --- */
.toc a, .tof a {
    text-decoration:    none;
}

a .secno, a .figno {
    color:  #000;
}

ul.tof, ol.tof {
    list-style: none outside none;
}

.caption {
    margin-top: 0.5em;
    font-style:   italic;
}

/* --- TABLE --- */
table.simple {
    border-spacing: 0;
    border-collapse:    collapse;
    border-bottom:  3px solid #003a7c;
}

.simple th {
    background: #003a7c;
    color:  #fff;
    padding:    3px 5px;
    text-align: left;
}

.simple th[scope="row"] {
    background: inherit;
    color:  inherit;
    border-top: 1px solid #ddd;
}

.simple td {
    padding:    3px 10px;
    border-top: 1px solid #ddd;
}

.simple tr:nth-child(even) {
    background: #f0f6ff;
}

/* --- DL --- */
.section dd > p:first-child {
    margin-top: 0;
}

.section dd > p:last-child {
    margin-bottom: 0;
}

.section dd {
    margin-bottom:  1em;
}

.section dl.attrs dd, .section dl.eldef dd {
    margin-bottom:  0;
}

@media print {
    .removeOnSave {
        display: none;
    }
}
</style><style>/* --- EXAMPLES --- */
div.example-title {
    min-width: 7.5em;
    color: #b9ab2d;
}
div.example-title span {
    text-transform: uppercase;   
}
aside.example, div.example, div.illegal-example {
    padding: 0.5em;
    margin: 1em 0;
    position: relative;
    clear: both;
}
div.illegal-example { color: red }
div.illegal-example p { color: black }
aside.example, div.example {
    padding: .5em;
    border-left-width: .5em;
    border-left-style: solid;
    border-color: #e0cb52;
    //background: #fcfaee;    
    background: rgba(252,250,238,0.3);    
}

aside.example div.example {
    border-left-width: .1em;
    border-color: #999;
    background: #fff;
}
aside.example div.example div.example-title {
    color: #999;
}
</style><style>/* --- ISSUES/NOTES --- */
div.issue-title, div.note-title {
    padding-right:  1em;
    min-width: 7.5em;
    color: #b9ab2d;
}
div.issue-title { color: #e05252; }
div.note-title { color: #2b2; }
div.issue-title span, div.note-title span {
    text-transform: uppercase;
}
div.note, div.issue {
    margin-top: 1em;
    margin-bottom: 1em;
}
.note > p:first-child, .issue > p:first-child { margin-top: 0 }
.issue, .note {
    padding: .5em;
    border-left-width: .5em;
    border-left-style: solid;
}
div.issue, div.note {
    padding: 1em 1.2em 0.5em;
    margin: 1em 0;
    position: relative;
    clear: both;
}
span.note, span.issue { padding: .1em .5em .15em; }

.issue {
    border-color: #e05252;
    background: #fbe9e9;
}
.note {
    border-color: #52e052;
    background: #e9fbe9;
}


</style><style>/* HIGHLIGHTS */
code.prettyprint {
    color:  inherit;
}

/* this from google-code-prettify */
.pln{color:#000}@media screen{.str{color:#080}.kwd{color:#008}.com{color:#800}.typ{color:#606}.lit{color:#066}.pun,.opn,.clo{color:#660}.tag{color:#008}.atn{color:#606}.atv{color:#080}.dec,.var{color:#606}.fun{color:red}}@media print,projection{.str{color:#060}.kwd{color:#006;font-weight:bold}.com{color:#600;font-style:italic}.typ{color:#404;font-weight:bold}.lit{color:#044}.pun,.opn,.clo{color:#440}.tag{color:#006;font-weight:bold}.atn{color:#404}.atv{color:#060}}ol.linenums{margin-top:0;margin-bottom:0}li.L0,li.L1,li.L2,li.L3,li.L5,li.L6,li.L7,li.L8{list-style-type:none}li.L1,li.L3,li.L5,li.L7,li.L9{background:#eee}
</style><style>/* --- WEB IDL --- */
pre.idl {
    border-top: 1px solid #364e50;
    border-bottom: 1px solid #364e50;
    padding:    1em;
    line-height:    120%;
}

pre.idl::before {
    content:    "WebIDL";
    display:    block;
    width:      150px;
    background: #364e50;
    color:  #fff;
    font-family:    initial;
    padding:    3px;
    font-weight:    bold;
    margin: -1em 0 1em -1em;
}

.idlType {
    color:  #ff4500;
    font-weight:    bold;
    text-decoration:    none;
}

/*.idlModule*/
/*.idlModuleID*/
/*.idlInterface*/
.idlInterfaceID, .idlDictionaryID, .idlCallbackID, .idlEnumID {
    font-weight:    bold;
    color:  #003a7c;
}
a.idlEnumItem {
    color:  #000;
    border-bottom:  1px dotted #ccc;
    text-decoration: none;
}

.idlSuperclass {
    font-style: italic;
    color:  #003a7c;
}

/*.idlAttribute*/
.idlAttrType, .idlFieldType, .idlMemberType {
    color:  #003a7c;
}
.idlAttrName, .idlFieldName, .idlMemberName {
    color:  #ff4500;
}
.idlAttrName a, .idlFieldName a, .idlMemberName a {
    color:  #ff4500;
    border-bottom:  1px dotted #ff4500;
    text-decoration: none;
}

/*.idlMethod*/
.idlMethType, .idlCallbackType {
    color:  #003a7c;
}
.idlMethName {
    color:  #ff4500;
}
.idlMethName a {
    color:  #ff4500;
    border-bottom:  1px dotted #ff4500;
    text-decoration: none;
}

/*.idlCtor*/
.idlCtorName {
    color:  #ff4500;
}
.idlCtorName a {
    color:  #ff4500;
    border-bottom:  1px dotted #ff4500;
    text-decoration: none;
}

/*.idlParam*/
.idlParamType {
    color:  #003a7c;
}
.idlParamName, .idlDefaultValue {
    font-style: italic;
}

.extAttr {
    color:  #666;
}

/*.idlSectionComment*/
.idlSectionComment {
    color: gray;
}

/*.idlConst*/
.idlConstType {
    color:  #003a7c;
}
.idlConstName {
    color:  #ff4500;
}
.idlConstName a {
    color:  #ff4500;
    border-bottom:  1px dotted #ff4500;
    text-decoration: none;
}

/*.idlException*/
.idlExceptionID {
    font-weight:    bold;
    color:  #c00;
}

.idlTypedefID, .idlTypedefType {
    color:  #003a7c;
}

.idlRaises, .idlRaises a.idlType, .idlRaises a.idlType code, .excName a, .excName a code {
    color:  #c00;
    font-weight:    normal;
}

.excName a {
    font-family:    monospace;
}

.idlRaises a.idlType, .excName a.idlType {
    border-bottom:  1px dotted #c00;
}

.excGetSetTrue, .excGetSetFalse, .prmNullTrue, .prmNullFalse, .prmOptTrue, .prmOptFalse {
    width:  45px;
    text-align: center;
}
.excGetSetTrue, .prmNullTrue, .prmOptTrue { color:  #0c0; }
.excGetSetFalse, .prmNullFalse, .prmOptFalse { color:  #c00; }

.idlImplements a {
    font-weight:    bold;
}

dl.attributes, dl.methods, dl.constants, dl.constructors, dl.fields, dl.dictionary-members {
    margin-left:    2em;
}

.attributes dt, .methods dt, .constants dt, .constructors dt, .fields dt, .dictionary-members dt {
    font-weight:    normal;
}

.attributes dt code, .methods dt code, .constants dt code, .constructors dt code, .fields dt code, .dictionary-members dt code {
    font-weight:    bold;
    color:  #000;
    font-family:    monospace;
}

.attributes dt code, .fields dt code, .dictionary-members dt code {
    background:  #ffffd2;
}

.attributes dt .idlAttrType code, .fields dt .idlFieldType code, .dictionary-members dt .idlMemberType code {
    color:  #003a7c;
    background:  transparent;
    font-family:    inherit;
    font-weight:    normal;
    font-style: italic;
}

.methods dt code {
    background:  #d9e6f8;
}

.constants dt code {
    background:  #ddffd2;
}

.constructors dt code {
    background:  #cfc;
}

.attributes dd, .methods dd, .constants dd, .constructors dd, .fields dd, .dictionary-members dd {
    margin-bottom:  1em;
}

table.parameters, table.exceptions {
    border-spacing: 0;
    border-collapse:    collapse;
    margin: 0.5em 0;
    width:  100%;
}
table.parameters { border-bottom:  1px solid #364e50; }
table.exceptions { border-bottom:  1px solid #deb890; }

.parameters th, .exceptions th {
    color:  #fff;
    padding:    3px 5px;
    text-align: left;
    font-family:    initial;
    font-weight:    normal;
    text-shadow:    #666 1px 1px 0;
}
.parameters th { background: #364e50; }
.exceptions th { background: #deb890; }

.parameters td, .exceptions td {
    padding:    3px 10px;
    border-top: 1px solid #ddd;
    vertical-align: top;
}

.parameters tr:first-child td, .exceptions tr:first-child td {
    border-top: none;
}

.parameters td.prmName, .exceptions td.excName, .exceptions td.excCodeName {
    width:  100px;
}

.parameters td.prmType {
    width:  120px;
}

table.exceptions table {
    border-spacing: 0;
    border-collapse:    collapse;
    width:  100%;
}
</style><link rel="stylesheet" href="resources/FIDO-PS.css"><!--[if lt IE 9]><script src='https://www.w3.org/2008/site/js/html5shiv.js'></script><![endif]--></head>
  <body style="" class="h-entry" role="document" id="respecDocument"><div class="head" role="contentinfo" id="respecHeader">
  <p>
    
      <a href="https://www.fidoalliance.org/"><img width="250" id="toplogo" src="resources/logo.png" alt="FIDO Alliance"></a>
    
  </p>
  <h1 class="title p-name" id="title" property="dcterms:title">FIDO UAF Application API and Transport Binding Specification v1.0</h1>
  
  <h2 property="dcterms:issued" datatype="xsd:dateTime" content="2014-12-08T08:00:00.000Z" id="fido-alliance-proposed-standard-08-december-2014"><abbr title="FIDO Alliance">FIDO Alliance</abbr> Proposed Standard <time class="dt-published" datetime="2014-12-08">08 December 2014</time></h2>
  <dl>
    
      <dt>This version:</dt>
      <dd><a class="u-url" href="https://fidoalliance.org/specs/fido-uaf-v1.0-ps-20141208/fido-uaf-client-api-transport-v1.0-ps-20141208.html">https://fidoalliance.org/specs/fido-uaf-v1.0-ps-20141208/fido-uaf-client-api-transport-v1.0-ps-20141208.html</a></dd>
      <!--<dt>Latest published version:</dt>
      <dd><a href='https://fidoalliance.org/specs/fido-uaf-client-api-transport/'>https://fidoalliance.org/specs/fido-uaf-client-api-transport/</a></dd>
    
    -->
    
    
    
    
    
      <dt>Previous version:</dt>
      <dd><a rel="dcterms:replaces" href="https://fidoalliance.org/specs/fido-uaf-client-api-transport-v1.0-rd-20141008.pdf">https://fidoalliance.org/specs/fido-uaf-client-api-transport-v1.0-rd-20141008.pdf</a></dd>
    
    
    <dt>Editor:</dt>
    <dd class="p-author h-card vcard" rel="bibo:editor" inlist=""><span typeof="foaf:Person"><a class="u-url url p-name fn" rel="foaf:homepage" property="foaf:name" content="Brad Hill" href="mailto:bhill@paypal.com">Brad Hill</a>, <a rel="foaf:workplaceHomepage" class="p-org org h-org h-card" href="https://www.paypal.com/">PayPal, Inc.</a></span>
</dd>

    
      <dt>Contributors:</dt>
      <dd class="p-author h-card vcard" rel="dcterms:contributor"><span typeof="foaf:Person"><span property="foaf:name" class="p-name fn">Davit Baghdasaryan</span>, <a rel="foaf:workplaceHomepage" class="p-org org h-org h-card" href="https://www.noknok.com/">Nok Nok Labs, Inc.</a></span>
</dd>
<dd class="p-author h-card vcard" rel="dcterms:contributor"><span typeof="foaf:Person"><span property="foaf:name" class="p-name fn">Bill Blanke</span>, <a rel="foaf:workplaceHomepage" class="p-org org h-org h-card" href="https://www.noknok.com/">Nok Nok Labs, Inc.</a></span>
</dd>
<dd class="p-author h-card vcard" rel="dcterms:contributor"><span typeof="foaf:Person"><span property="foaf:name" class="p-name fn">Dr. Rolf Lindemann</span>, <a rel="foaf:workplaceHomepage" class="p-org org h-org h-card" href="https://www.noknok.com/">Nok Nok Labs, Inc.</a></span>
</dd>
<dd class="p-author h-card vcard" rel="dcterms:contributor"><span typeof="foaf:Person"><a class="u-url url p-name fn" rel="foaf:homepage" property="foaf:name" content="Jeff Hodges" href="mailto:Jeff.Hodges@KingsMountain.com">Jeff Hodges</a>, <a rel="foaf:workplaceHomepage" class="p-org org h-org h-card" href="https://www.paypal.com/">PayPal, Inc.</a></span>
</dd>

    
    
  </dl>
  
  
  
    <p>
      The English version of this specification is the only normative version. Non-normative
      <a href="https://www.fidoalliance.org/specifications/translation/">translations</a> may also be available.
    </p>
  
  
    
      <p class="copyright">
        Copyright ©
        2013-2014
        
        <a href="https://www.fidoalliance.org/"><abbr title="FIDO Alliance">FIDO Alliance</abbr></a>
        All Rights Reserved.
      </p>
    
  
  <hr>
</div>

    <!-- only put content here if you want a custom status of document not
    the specification-maturity-appropriate boilerplate -->
    

    <section id="abstract" class="introductory" property="dcterms:abstract" datatype="" typeof="bibo:Chapter" resource="#ref" rel="bibo:Chapter"><h2 aria-level="1" role="heading" id="h2_abstract">Abstract</h2><p>
      Describes APIs and an interoperability profile for client
      applications to utilize FIDO UAF. This includes methods of
      communicating with a FIDO UAF Client for both Web platform and
      Android applications, transport requirements, and an HTTPS
      interoperability profile for sending FIDO UAF messages to a
      compatible server.
    </p></section><section id="sotd" class="introductory" typeof="bibo:Chapter" resource="#ref" rel="bibo:Chapter"><h2 aria-level="1" role="heading" id="h2_sotd">Status of This Document</h2>
  
    
      
        <p>
          <em>This section describes the status of this document at the time of its publication.
          Other documents may supersede this document. A list of current <abbr title="FIDO Alliance">FIDO Alliance</abbr> publications and the
          latest revision of this technical report can be found in the <a href="https://www.fidoalliance.org/specifications/"><abbr title="FIDO Alliance">FIDO Alliance</abbr> specifications index</a> at
          https://www.fidoalliance.org/specifications/.</em>
        </p>
        
        <p>
          This document was published by the <a href="https://fidoalliance.org/"><abbr title="FIDO Alliance">FIDO Alliance</abbr></a> as a Proposed Standard.
          
          
            If you wish to make comments regarding this document, please 
            <a href="https://fidoalliance.org/contact">Contact Us</a>.
          
          
          
          
            All comments are welcome.
          
        </p>
        
	
	
	
        
          <p>
	    Implementation of certain elements of this Specification may require licenses under third party intellectual 
	    property rights, including without limitation, patent rights. The <abbr title="FIDO Alliance">FIDO Alliance</abbr>, Inc. and its Members
            and any other contributors to the Specification are not, and shall not be held, responsible in any manner
            for identifying or failing to identify any or all such third party intellectual property rights.
	  </p>
	  <p>
	    THIS FIDO ALLIANCE SPECIFICATION IS PROVIDED “AS IS” AND WITHOUT ANY 
            WARRANTY OF ANY KIND, INCLUDING, WITHOUT LIMITATION, ANY EXPRESS OR IMPLIED
	    WARRANTY OF NON-INFRINGEMENT, MERCHANTABILITY OR FITNESS FOR A
	    PARTICULAR PURPOSE.
          </p>
        
        
          <p>
            This document has been reviewed by FIDO Aliance Members
            and is endorsed as a Proposed Standard.
            It is a stable document and may be used as reference material or cited from another
            document. <abbr title="FIDO Alliance">FIDO Alliance</abbr>'s role in making the Recommendation is to draw attention to the
            specification and to promote its widespread deployment.
          </p>
        
        
        
      
    
  
</section><section id="toc"><h2 class="introductory" aria-level="1" role="heading" id="h2_toc">Table of Contents</h2><ul class="toc" role="directory" id="respecContents"><li class="tocline"><a href="#notation" class="tocxref"><span class="secno">1. </span>Notation</a><ul class="toc"><li class="tocline"><a href="#key-words" class="tocxref"><span class="secno">1.1 </span>Key Words</a></li></ul></li><li class="tocline"><a href="#overview" class="tocxref"><span class="secno">2. </span>Overview</a><ul class="toc"><li class="tocline"><a href="#audience" class="tocxref"><span class="secno">2.1 </span>Audience</a></li><li class="tocline"><a href="#scope" class="tocxref"><span class="secno">2.2 </span>Scope</a></li><li class="tocline"><a href="#architecture" class="tocxref"><span class="secno">2.3 </span>Architecture</a><ul class="toc"><li class="tocline"><a href="#protocol-conversation" class="tocxref"><span class="secno">2.3.1 </span>Protocol Conversation</a></li></ul></li></ul></li><li class="tocline"><a href="#common-definitions" class="tocxref"><span class="secno">3. </span>Common Definitions</a><ul class="toc"><li class="tocline"><a href="#uaf-status-codes" class="tocxref"><span class="secno">3.1 </span>UAF Status Codes</a></li></ul></li><li class="tocline"><a href="#shared-definitions" class="tocxref"><span class="secno">4. </span>Shared Definitions</a><ul class="toc"><li class="tocline"><a href="#uafmessage-dictionary" class="tocxref"><span class="secno">4.1 </span>UAFMessage Dictionary</a><ul class="toc"><li class="tocline"><a href="#dictionary-uafmessage-members" class="tocxref"><span class="secno">4.1.1 </span>Dictionary <span class="formerLink"><code>UAFMessage</code></span> Members</a></li></ul></li><li class="tocline"><a href="#version-interface" class="tocxref"><span class="secno">4.2 </span>Version interface</a><ul class="toc"><li class="tocline"><a href="#attributes" class="tocxref"><span class="secno">4.2.1 </span>Attributes</a></li></ul></li><li class="tocline"><a href="#authenticator-interface" class="tocxref"><span class="secno">4.3 </span>Authenticator interface</a><ul class="toc"><li class="tocline"><a href="#attributes-1" class="tocxref"><span class="secno">4.3.1 </span>Attributes</a></li><li class="tocline"><a href="#authenticator-interface-constants" class="tocxref"><span class="secno">4.3.2 </span>Authenticator Interface Constants</a></li></ul></li><li class="tocline"><a href="#discoverydata-dictionary" class="tocxref"><span class="secno">4.4 </span>DiscoveryData dictionary</a><ul class="toc"><li class="tocline"><a href="#dictionary-discoverydata-members" class="tocxref"><span class="secno">4.4.1 </span>Dictionary <span class="formerLink"><code>DiscoveryData</code></span> Members</a></li></ul></li><li class="tocline"><a href="#errorcode-interface" class="tocxref"><span class="secno">4.5 </span>ErrorCode interface</a><ul class="toc"><li class="tocline"><a href="#constants" class="tocxref"><span class="secno">4.5.1 </span>Constants</a></li></ul></li></ul></li><li class="tocline"><a href="#dom-api" class="tocxref"><span class="secno">5. </span>DOM API</a><ul class="toc"><li class="tocline"><a href="#feature-detection" class="tocxref"><span class="secno">5.1 </span>Feature Detection</a></li><li class="tocline"><a href="#uaf-interface" class="tocxref"><span class="secno">5.2 </span>uaf Interface</a><ul class="toc"><li class="tocline"><a href="#methods" class="tocxref"><span class="secno">5.2.1 </span>Methods</a></li></ul></li><li class="tocline"><a href="#uafresponsecallback" class="tocxref"><span class="secno">5.3 </span>UAFResponseCallback</a><ul class="toc"><li class="tocline"><a href="#callback-uafresponsecallback-parameters" class="tocxref"><span class="secno">5.3.1 </span>Callback <span class="formerLink"><code>UAFResponseCallback</code></span> Parameters</a></li></ul></li><li class="tocline"><a href="#discoverycallback" class="tocxref"><span class="secno">5.4 </span>DiscoveryCallback</a><ul class="toc"><li class="tocline"><a href="#callback-discoverycallback-parameters" class="tocxref"><span class="secno">5.4.1 </span>Callback <span class="formerLink"><code>DiscoveryCallback</code></span> Parameters</a></li></ul></li><li class="tocline"><a href="#errorcallback" class="tocxref"><span class="secno">5.5 </span>ErrorCallback</a><ul class="toc"><li class="tocline"><a href="#callback-errorcallback-parameters" class="tocxref"><span class="secno">5.5.1 </span>Callback <span class="formerLink"><code>ErrorCallback</code></span> Parameters</a></li></ul></li><li class="tocline"><a href="#privacy-considerations-for-the-dom-api" class="tocxref"><span class="secno">5.6 </span>Privacy Considerations for the DOM API</a></li><li class="tocline"><a href="#security-considerations-for-the-dom-api" class="tocxref"><span class="secno">5.7 </span>Security Considerations for the DOM API</a><ul class="toc"><li class="tocline"><a href="#insecure-mixed-content" class="tocxref"><span class="secno">5.7.1 </span>Insecure Mixed Content</a></li><li class="tocline"><a href="#the-same-origin-policy-http-redirects-and-cross-origin-content" class="tocxref"><span class="secno">5.7.2 </span>The Same Origin Policy, HTTP Redirects and Cross-Origin Content</a></li></ul></li><li class="tocline"><a href="#implementation-notes-for-browser-plugin-authors" class="tocxref"><span class="secno">5.8 </span>Implementation Notes for Browser/Plugin Authors</a></li></ul></li><li class="tocline"><a href="#android-intent-api" class="tocxref"><span class="secno">6. </span>Android Intent API</a><ul class="toc"><li class="tocline"><a href="#android-specific-definitions" class="tocxref"><span class="secno">6.1 </span>Android-specific Definitions</a><ul class="toc"><li class="tocline"><a href="#org.fidoalliance.uaf.permissions.fido_client" class="tocxref"><span class="secno">6.1.1 </span>org.fidoalliance.uaf.permissions.FIDO_CLIENT</a></li><li class="tocline"><a href="#org.fidoalliance.uaf.permissions.act_as_web_browser" class="tocxref"><span class="secno">6.1.2 </span>org.fidoalliance.uaf.permissions.ACT_AS_WEB_BROWSER</a></li><li class="tocline"><a href="#channelbindings" class="tocxref"><span class="secno">6.1.3 </span>channelBindings</a></li><li class="tocline"><a href="#uafintenttype-enumeration" class="tocxref"><span class="secno">6.1.4 </span>UAFIntentType enumeration</a></li></ul></li><li class="tocline"><a href="#org.fidoalliance.intent.fido_operation-intent" class="tocxref"><span class="secno">6.2 </span>org.fidoalliance.intent.FIDO_OPERATION Intent</a><ul class="toc"><li class="tocline"><a href="#uafintenttype.discover" class="tocxref"><span class="secno">6.2.1 </span>UAFIntentType.DISCOVER</a></li><li class="tocline"><a href="#uafintenttype.discover_result" class="tocxref"><span class="secno">6.2.2 </span>UAFIntentType.DISCOVER_RESULT</a></li><li class="tocline"><a href="#uafintenttype.check_policy" class="tocxref"><span class="secno">6.2.3 </span>UAFIntentType.CHECK_POLICY</a></li><li class="tocline"><a href="#uafintenttype.check_policy_result" class="tocxref"><span class="secno">6.2.4 </span>UAFIntentType.CHECK_POLICY_RESULT</a></li><li class="tocline"><a href="#uafintenttype.uaf_operation" class="tocxref"><span class="secno">6.2.5 </span>UAFIntentType.UAF_OPERATION</a></li><li class="tocline"><a href="#uafintenttype.uaf_operation_result" class="tocxref"><span class="secno">6.2.6 </span>UAFIntentType.UAF_OPERATION_RESULT</a></li><li class="tocline"><a href="#uafintenttype.uaf_operation_completion_status" class="tocxref"><span class="secno">6.2.7 </span>UAFIntentType.UAF_OPERATION_COMPLETION_STATUS</a></li></ul></li><li class="tocline"><a href="#security-considerations-for-android-implementations" class="tocxref"><span class="secno">6.3 </span>Security Considerations for Android Implementations</a></li></ul></li><li class="tocline"><a href="#ios-custom-url-api" class="tocxref"><span class="secno">7. </span>iOS Custom URL API</a><ul class="toc"><li class="tocline"><a href="#ios-specific-definitions" class="tocxref"><span class="secno">7.1 </span>iOS-specific Definitions</a><ul class="toc"><li class="tocline"><a href="#x-callback-url-transport" class="tocxref"><span class="secno">7.1.1 </span>X-Callback-URL Transport</a></li><li class="tocline"><a href="#secret-key-generation" class="tocxref"><span class="secno">7.1.2 </span>Secret Key Generation</a></li><li class="tocline"><a href="#origin" class="tocxref"><span class="secno">7.1.3 </span>Origin</a></li><li class="tocline"><a href="#channelbindings-1" class="tocxref"><span class="secno">7.1.4 </span>channelBindings</a></li><li class="tocline"><a href="#uafxtype" class="tocxref"><span class="secno">7.1.5 </span>UAFxType</a></li></ul></li><li class="tocline"><a href="#json-values" class="tocxref"><span class="secno">7.2 </span>JSON Values</a><ul class="toc"><li class="tocline"><a href="#discover" class="tocxref"><span class="secno">7.2.1 </span>DISCOVER</a></li><li class="tocline"><a href="#discover_result" class="tocxref"><span class="secno">7.2.2 </span>DISCOVER_RESULT</a></li><li class="tocline"><a href="#check_policy" class="tocxref"><span class="secno">7.2.3 </span>CHECK_POLICY</a></li><li class="tocline"><a href="#check_policy_result" class="tocxref"><span class="secno">7.2.4 </span>CHECK_POLICY_RESULT</a></li><li class="tocline"><a href="#uaf_operation" class="tocxref"><span class="secno">7.2.5 </span>UAF_OPERATION</a></li><li class="tocline"><a href="#uaf_operation_result" class="tocxref"><span class="secno">7.2.6 </span>UAF_OPERATION_RESULT</a></li><li class="tocline"><a href="#uaf_operation_completion_status" class="tocxref"><span class="secno">7.2.7 </span>UAF_OPERATION_COMPLETION_STATUS</a></li></ul></li><li class="tocline"><a href="#implementation-guidelines-for-ios-implementations" class="tocxref"><span class="secno">7.3 </span>Implementation Guidelines for iOS Implementations</a></li><li class="tocline"><a href="#security-considerations-for-ios-implementations" class="tocxref"><span class="secno">7.4 </span>Security Considerations for iOS Implementations</a></li></ul></li><li class="tocline"><a href="#transport-binding-profile" class="tocxref"><span class="secno">8. </span>Transport Binding Profile</a><ul class="toc"><li class="tocline"><a href="#TransportSecurityRequirements" class="tocxref"><span class="secno">8.1 </span>Transport Security Requirements</a></li><li class="tocline"><a href="#tls-security-requirements" class="tocxref"><span class="secno">8.2 </span>TLS Security Requirements</a></li><li class="tocline"><a href="#HttpsTransportInteroperabilityProfile" class="tocxref"><span class="secno">8.3 </span>HTTPS Transport Interoperability Profile</a><ul class="toc"><li class="tocline"><a href="#obtaining-a-uaf-request-message" class="tocxref"><span class="secno">8.3.1 </span>Obtaining a UAF Request message</a></li><li class="tocline"><a href="#operation-enum" class="tocxref"><span class="secno">8.3.2 </span>Operation enum</a></li><li class="tocline"><a href="#getuafrequest-dictionary" class="tocxref"><span class="secno">8.3.3 </span>GetUAFRequest dictionary</a><ul class="toc"><li class="tocline"><a href="#dictionary-getuafrequest-members" class="tocxref"><span class="secno">8.3.3.1 </span>Dictionary <span class="formerLink"><code>GetUAFRequest</code></span> Members</a></li></ul></li><li class="tocline"><a href="#returnuafrequest-dictionary" class="tocxref"><span class="secno">8.3.4 </span>ReturnUAFRequest dictionary</a><ul class="toc"><li class="tocline"><a href="#dictionary-returnuafrequest-members" class="tocxref"><span class="secno">8.3.4.1 </span>Dictionary <span class="formerLink"><code>ReturnUAFRequest</code></span> Members</a></li></ul></li><li class="tocline"><a href="#senduafresponse-dictionary" class="tocxref"><span class="secno">8.3.5 </span>SendUAFResponse dictionary</a><ul class="toc"><li class="tocline"><a href="#dictionary-senduafresponse-members" class="tocxref"><span class="secno">8.3.5.1 </span>Dictionary <span class="formerLink"><code>SendUAFResponse</code></span> Members</a></li></ul></li><li class="tocline"><a href="#delivering-a-uaf-response" class="tocxref"><span class="secno">8.3.6 </span>Delivering a UAF Response</a></li><li class="tocline"><a href="#serverresponse-interface" class="tocxref"><span class="secno">8.3.7 </span>ServerResponse Interface</a><ul class="toc"><li class="tocline"><a href="#attributes-2" class="tocxref"><span class="secno">8.3.7.1 </span>Attributes</a></li></ul></li><li class="tocline"><a href="#token-interface" class="tocxref"><span class="secno">8.3.8 </span>Token interface</a><ul class="toc"><li class="tocline"><a href="#attributes-3" class="tocxref"><span class="secno">8.3.8.1 </span>Attributes</a></li></ul></li><li class="tocline"><a href="#tokentype-enum" class="tocxref"><span class="secno">8.3.9 </span>TokenType enum</a></li><li class="tocline"><a href="#security-considerations" class="tocxref"><span class="secno">8.3.10 </span>Security Considerations</a></li></ul></li></ul></li><li class="tocline"><a href="#references" class="tocxref"><span class="secno">A. </span>References</a><ul class="toc"><li class="tocline"><a href="#normative-references" class="tocxref"><span class="secno">A.1 </span>Normative references</a></li><li class="tocline"><a href="#informative-references" class="tocxref"><span class="secno">A.2 </span>Informative references</a></li></ul></li></ul></section>
    
    <section id="notation">
      <!--OddPage--><h2 aria-level="1" role="heading" id="h2_notation"><span class="secno">1. </span>Notation</h2>
      
      <p>Type names, attribute names and element names are written as <code>code</code>.</p>
	
      <p>String literals are enclosed in “”, e.g. “UAF-TLV”.</p>
	  
      <p>In formulas we use “|” to denote byte wise concatenation
	operations.</p>
      
	<p>The notation base64url refers to "Base 64 Encoding with URL and Filename
	  Safe Alphabet" [<cite><a class="bibref" href="#bib-RFC4648">RFC4648</a></cite>] <em>without padding</em>.  </p>

	<p>DOM APIs are described using the ECMAScript [<cite><a class="bibref" href="#bib-ECMA-262">ECMA-262</a></cite>] bindings
	  for WebIDL [<cite><a class="bibref" href="#bib-WebIDL-ED">WebIDL-ED</a></cite>].</p>

	<p>Following [<cite><a class="bibref" href="#bib-WebIDL-ED">WebIDL-ED</a></cite>], dictionary members are optional unless they are explicitly 
	  marked as <code>required</code>.</p>

	<p>WebIDL dictionary members <em class="rfc2119" title="MUST NOT">MUST NOT</em> have a value of null.</p>
	
	<p>Unless otherwise specified, if a WebIDL dictionary member is DOMString, 
	  it <em class="rfc2119" title="MUST NOT">MUST NOT</em> be empty.</p>
	
	<p>Unless otherwise specified, if a WebIDL dictionary member is a List, 
	  it <em class="rfc2119" title="MUST NOT">MUST NOT</em> be an empty list.</p>
	
	<p>UAF specific terminology used in this document is defined in
	  [<cite><a class="bibref" href="#bib-FIDOGlossary">FIDOGlossary</a></cite>].</p>

	<p>All diagrams, examples, notes in this specification are non-normative.</p>

	<div class="note"><div class="note-title" aria-level="2" role="heading" id="h_note_1"><span>Note</span></div><p class="">
	  Note: Certain dictionary members need to be present in order to
	  comply with FIDO requirements. Such members are marked in the
	  WebIDL definitions found in this document, as
	  <code>required</code>. The keyword <code>required</code> has been
	  introduced by [<cite><a class="bibref" href="#bib-WebIDL-ED">WebIDL-ED</a></cite>], which is a work-in-progress. If you
	  are using a WebIDL parser which implements [<cite><a class="bibref" href="#bib-WebIDL">WebIDL</a></cite>], then you
	  may remove the keyword <code>required</code> from your WebIDL and
	  use other means to ensure those fields are present.  
	</p></div>

	<section id="key-words">
	  <h3 aria-level="2" role="heading" id="h3_key-words"><span class="secno">1.1 </span>Key Words</h3>
	  
	  <p>The key words “<em class="rfc2119" title="MUST">MUST</em>”, “<em class="rfc2119" title="MUST NOT">MUST NOT</em>”, “<em class="rfc2119" title="REQUIRED">REQUIRED</em>”, “<em class="rfc2119" title="SHALL">SHALL</em>”, “<em class="rfc2119" title="SHALL
	    NOT">SHALL
	    NOT</em>”, “<em class="rfc2119" title="SHOULD">SHOULD</em>”, “<em class="rfc2119" title="SHOULD NOT">SHOULD NOT</em>”, “<em class="rfc2119" title="RECOMMENDED">RECOMMENDED</em>”, “<em class="rfc2119" title="MAY">MAY</em>”, and
	    “<em class="rfc2119" title="OPTIONAL">OPTIONAL</em>” in this document are to be interpreted as
	    described in [<cite><a class="bibref" href="#bib-RFC2119">RFC2119</a></cite>].</p>
	</section>
    </section>

    <section class="informative" id="overview">
      <!--OddPage--><h2 aria-level="1" role="heading" id="h2_overview"><span class="secno">2. </span>Overview</h2><p><em>This section is non-normative.</em></p>
      
      <p>The FIDO UAF technology replaces traditional username and
	password-based authentication solutions for online services,
	with a stronger and simpler alternative. The core UAF protocol
	consists of four conceptual conversations between a FIDO UAF Client
	and FIDO Server: Registration, Authentication, Transaction
	Confirmation, and Deregistration. As specified in the core
	protocol, these messages do not have a defined network
	transport, or describe how application software that a user
	interfaces with can use UAF. This document describes the
	API surface that a client application can use to communicate
	with FIDO UAF Client software, and transport patterns and security
	requirements for delivering UAF Protocol messages to a
	remote server.
      </p>
      <p>The reader should also be familiar with the FIDO Glossary of
	Terms [<cite><a class="bibref" href="#bib-FIDOGlossary">FIDOGlossary</a></cite>] and the UAF Protocol specification [<cite><a class="bibref" href="#bib-UAFProtocol">UAFProtocol</a></cite>].</p>
      
      <section id="audience">
	<h3 aria-level="2" role="heading" id="h3_audience"><span class="secno">2.1 </span>Audience</h3>
	
	<p>This document is of interest to client-side application authors
	  that wish to utilize FIDO UAF, as well as implementers of web
	  browsers, browser plugins and FIDO clients, in that it
	  describes the API surface they need to expose to application
	  authors.
	</p>
      </section>
      
      <section id="scope">
	<h3 aria-level="2" role="heading" id="h3_scope"><span class="secno">2.2 </span>Scope</h3>
	
	<p>This document describes:</p>
	
	<ul>
	  <li>The local ECMAScript [<cite><a class="bibref" href="#bib-ECMA-262">ECMA-262</a></cite>] API exposed by a FIDO
	    UAF-enabled web browser to client-side web applications.</li>
	  
	  <li>The mechanisms and APIs for Android [<cite><a class="bibref" href="#bib-ANDROID">ANDROID</a></cite>] applications to
	    discover and utilize a shared FIDO UAF Client service.</li>
	  
	  <li>The general security requirements for applications initiating
	    and transporting UAF protocol exchanges.</li>
	  
	  <li>An interoperability profile for transporting FIDO UAF messages over
	    HTTPS [<cite><a class="bibref" href="#bib-RFC2818">RFC2818</a></cite>].</li>
	</ul>
	
	<p>The following are out of scope for this document:</p>
	<ul>
	  <li>The format and details of the underlying UAF Protocol messages</li>
	  
	  <li>APIs for, and any details of interactions between FIDO Server
	    software and the server-side application stack.</li>
	</ul>
	
	<p>The goal of describing standard APIs and an interoperability
	  profile for the transport of FIDO UAF messages here is to provide an
	  example of how to develop a FIDO-enabled application and to
	  promote the ease of integrating interoperable layers from
	  different vendors to build a complete FIDO UAF solution. For
	  any given application instance, these particular patterns may
	  not be ideal and are not mandatory. Applications may use
	  alternate transports, bundle UAF Protocol messages with other
	  network data, or discover and utilize alternative APIs as they
	  see fit.</p>
      </section>
      <section id="architecture">
	<h3 aria-level="2" role="heading" id="h3_architecture"><span class="secno">2.3 </span>Architecture</h3>
	
	<p>The overall architecture of the UAF protocol and its various
	  operations is described in the FIDO UAF Protocol Specification
	  [<cite><a class="bibref" href="#bib-UAFProtocol">UAFProtocol</a></cite>]. The following simplified architecture diagram
	  illustrates the interactions and actors this document is
	  concerned with:</p>
	
	<figure title="UAF Architecture" alt="Diagram showing layers addressed by this specification." id="fig-uaf-application-api-architecture-and-transport-layers"> 
	  <img src="./img/fido-uaf-client-api-transport-layers.png" onerror="./img/fido-uaf-client-api-transport-layers.png" alt="UAF Application API Architecture and Transport Layers">
	  
	  <figcaption>Fig. <span class="figno">1</span> <span class="fig-title">UAF Application API Architecture and Transport Layers</span></figcaption>	
	</figure>

	<p>This document describes the shaded components in Fig 1.</p>
	
	<section id="protocol-conversation">
	  <h4 aria-level="3" role="heading" id="h4_protocol-conversation"><span class="secno">2.3.1 </span>Protocol Conversation</h4>

	  <p>The core UAF protocol consists of five conceptual phases:</p>
	  <ul>
	    <li><strong>Discovery</strong> allows the relying party server to determine the
	      availability of FIDO capabilities at the client, including
	      metadata about the available authenticators.</li>
	    
	    <li><strong>Registration</strong> allows the client to generate and associate new key
	      material with an account at the relying party server, subject to
	      policy set by the server and acceptable attestation that the
	      authenticator and registration matches that policy.</li>
	    
	    <li><strong>Authentication</strong> allows a user to provide an account identifier,
	      proof-of-possession of previously registered key material
	      associated with that identifier, and potentially other attested
	      data, to the relying party server.</li>
	    
	    <li><strong>Transaction Confirmation</strong> allows a server to request that a FIDO
	      client and authenticator with the appropriate capabilities
	      display some information to the user, request that the user
	      authenticate locally to their FIDO authenticator to confirm it,
	      and provide proof-of-possession of previously registered key
	      material and an attestation of the confirmation back to the
	      relying party server.</li>
	    
	    <li><strong>Deregistration</strong> allows a relying party
	      server to tell an authenticator to forget selected
	      locally managed key material associated with that
	      relying party in case such keys are no longer considered
	      valid by the relying party.</li>
	  </ul>
	  
	  <p>Discovery does not involve a protocol exchange with the
	    FIDO Server. However, the information available through the
	    discovery APIs might be communicated back to the server in
	    an application-specific manner, such as by obtaining a UAF
	    protocol request message containing an authenticator policy
	    tailored to the specific capabilities of the FIDO user
	    device.</p>
	  
	  <p>Although the UAF protocol abstractly defines the FIDO
	    server as the initiator of requests, UAF client applications
	    working as described in this document will always transport
	    UAF protocol messages over a client-initiated
	    request/response protocol such as HTTP.</p>
	  
	  <p>The protocol flow from the point of view of the relying party
	    client application for registration, authentication, and
	    transaction confirmation is as follows:</p>

	  <ol>
	    <li>The client application either explicitly contacts the server to
	      obtain a UAF Protocol Request Message, or this message is
	      delivered along with other client application content.</li>
	    
	    <li>The client application invokes the appropriate API to pass the
	      UAF protocol request message asynchronously to the FIDO UAF Client,
	      and receives a set of callbacks.</li>
	    
	    <li>The FIDO UAF Client performs any necessary interactions with the
	      user and authenticator(s) to complete the request and uses a
	      callback to either notify the client application of an error, or to
	      return a UAF response message.</li>
	    
	    <li>The client application delivers the UAF response message to
	      the server over a transport protocol such as HTTP.</li>
	    
	    <li>The server optionally returns an indication of the results of
	      the operation and additional data such as authorization tokens
	      or a redirect.</li>
	    
	    <li>The client application optionally uses the appropriate API to
	      inform the FIDO UAF Client of the results of the operation. This
	      allows the FIDO UAF Client to perform “housekeeping” tasks for a
	      better user experience, e.g. by not attempting to use again
	      later a key that the server refused to register.</li>
	    
	    <li>The client application optionally processes additional data
	      returned to it in an application-specific manner, e.g.
	      processing new authorization tokens, redirecting the user to a
	      new resource or interpreting an error code to determine if and
	      how it should retry a failed operation.</li>
	  </ol>

	  <p>Deregister does not involve a UAF protocol round-trip. If the
	    relying party server instructs the client application to
	    perform a deregistration, the client application simply
	    delivers the UAF protocol Request message to the FIDO UAF Client
	    using the appropriate API. The FIDO UAF Client does not return the
	    results of a deregister operation to the relying party client
	    application or FIDO Server.</p>
	  
	  <p>UAF protocol Messages are JSON [<cite><a class="bibref" href="#bib-ECMA-404">ECMA-404</a></cite>] structures, but client
	    applications are discouraged from modifying them. These messages
	    may contain embedded cryptographic integrity protections and any
	    modifications might invalidate the messages from the point of
	    view of the FIDO UAF Client or Server.</p>
	  
	</section>
      </section>
    </section>
    <section class="normativeDisclaimer" id="common-definitions">
      <!--OddPage--><h2 aria-level="1" role="heading" id="h2_common-definitions"><span class="secno">3. </span>Common Definitions</h2><p><em>This section is normative.</em></p>

      <p>These elements are shared by several APIs and layers.</p>
      
      <section id="uaf-status-codes">
	<h3 aria-level="2" role="heading" id="h3_uaf-status-codes"><span class="secno">3.1 </span>UAF Status Codes</h3>
	
	<p>This table lists UAF protocol status codes. </p>
	<div class="note"><div class="note-title" aria-level="3" role="heading" id="h_note_2"><span>Note</span></div><div class="">
	  These codes indicate the
	  result of the UAF operation at the FIDO Server. They do not
	  represent the HTTP [<cite><a class="bibref" href="#bib-RFC7230">RFC7230</a></cite>] layer or other transport layers. These
	  codes are intended for consumption by both the client-side web
	  app and FIDO UAF Client to inform application-specific error
	  reporting, retry and housekeeping behavior.
	</div></div>

	<table title="Table 1" border="1" cellspacing="0" cellpadding="5">
	  <tbody><tr><th>Code</th><th>Meaning</th></tr>	
	  <tr><td>1200</td><td>
	    OK. Operation completed</td></tr>
	  <tr><td>1202</td><td>
	    Accepted. Message accepted, but not completed at this time. The
	    RP may need time to process the attestation, run risk scoring,
	    etc. The server <em class="rfc2119" title="SHOULD NOT">SHOULD NOT</em> send an authenticationToken with a
	    1202 response</td></tr>
	  <tr><td>1400</td><td>	    
	    Bad Request. The server did not understand the message</td></tr>
	  <tr><td>1401</td><td>
	    Unauthorized. The userid must be authenticated to perform this
	    operation, or this KeyID is not associated with this UserID.</td></tr>
	  <tr><td>1403</td><td>
	    Forbidden. The userid is not allowed to perform this operation.
	    Client <em class="rfc2119" title="SHOULD NOT">SHOULD NOT</em> retry</td></tr>
	  <tr><td>1404</td><td>
	    Not Found.</td></tr>
	  <tr><td>1408</td><td>
	    Request Timeout.</td></tr>
	  <tr><td>1480</td><td>
	    Unknown AAID. The server was unable to locate authoritative
	    metadata for the AAID.</td></tr>
	  <tr><td>1481</td><td>
	    Unknown KeyID. The server was unable to locate a registration
	    for the given UserID and KeyID combination.
	    <p> This error indicates that there is an invalid registration on the user's device. It is recommended
	      that FIDO UAF Client deletes the key from local device when this error is received.</p>
	  </td></tr>
	  <tr><td>1490</td><td>
	    Channel Binding Refused. The server refused to service the
	    request due to a missing or mismatched channel binding(s).</td></tr>
	  <tr><td>1491</td><td>
	    Request Invalid. The server refused to service the request
	    because the request message nonce was unknown, expired or the
	    server has previously serviced a message with the same nonce
	    and user ID.</td></tr>
	  <tr><td>1492</td><td>
	    Unacceptable Authenticator. The authenticator is not acceptable
	    according to the server's policy, for example because the
	    capability registry used by the server reported different
	    capabilities than client-side discovery.</td></tr>
	  <tr><td>1493</td><td>
	    Revoked Authenticator. The authenticator is considered revoked
	    by the server.</td></tr>
	  <tr><td>1494</td><td>	    
	    Unacceptable Key. The key used is unacceptable. Perhaps it is on
	    a list of known weak keys or uses insecure parameter choices.</td></tr>
	  <tr><td>1495</td><td>
	    Unacceptable Algorithm. The server believes the authenticator to
	    be capable of using a stronger mutually-agreeable algorithm than
	    was presented in the request.</td></tr>
	  <tr><td>1496</td><td>
	    Unacceptable Attestation. The attestation(s) provided were not
	    accepted by the server.</td></tr>
	  <tr><td>1497</td><td>
	    Unacceptable Client Capabilities. The server was unable or
	    unwilling to use required capabilities provided supplementally
	    to the authenticator by the client software.</td></tr>
	  <tr><td>1498</td><td>
	    Unacceptable Content. There was a problem with the contents of
	    the message and the server was unwilling or unable to process
	    it.</td></tr>
	  <tr><td>1500</td><td>
	    Internal Server Error</td></tr>
	</tbody></table>
      </section>
    </section>

    <section class="normativeDisclaimer" id="shared-definitions">
      <!--OddPage--><h2 aria-level="1" role="heading" id="h2_shared-definitions"><span class="secno">4. </span>Shared Definitions</h2><p><em>This section is normative.</em></p>
      <div class="note"><div class="note-title" aria-level="2" role="heading" id="h_note_3"><span>Note</span></div><p class="">This section defines a number of JSON structures, specified 
	with WebIDL [<cite><a class="bibref" href="#bib-WebIDL-ED">WebIDL-ED</a></cite>].  These structures are 
	shared among APIs for multiple target platforms.
      </p></div>
      <section id="uafmessage-dictionary">
	<h3 aria-level="2" role="heading" id="h3_uafmessage-dictionary"><span class="secno">4.1 </span>UAFMessage Dictionary</h3>

	<p>The UAFMessage dictionary is a wrapper object that contains the
	  raw UAF protocol Message and additional JSON data that may be
	  used to carry application-specific data for use by either the
	  client application or FIDO UAF Client.
	</p>	
	<pre class="idl"><span class="idlDictionary" id="idl-def-UAFMessage">dictionary <span class="idlDictionaryID">UAFMessage</span> {
<span class="idlMember">    <span class="idlMemberType">required DOMString</span> <span class="idlMemberName"><a href="#widl-UAFMessage-uafProtocolMessage">uafProtocolMessage</a></span>;</span>
<span class="idlMember">    <span class="idlMemberType">Object</span>             <span class="idlMemberName"><a href="#widl-UAFMessage-additionalData">additionalData</a></span>;</span>
};</span></pre><section id="dictionary-uafmessage-members"><h4 aria-level="3" role="heading" id="h4_dictionary-uafmessage-members"><span class="secno">4.1.1 </span>Dictionary <a class="idlType" href="#idl-def-UAFMessage"><code>UAFMessage</code></a> Members</h4><dl class="dictionary-members"><dt id="widl-UAFMessage-uafProtocolMessage"><code>uafProtocolMessage</code> of type <span class="idlMemberType">required DOMString</span></dt><dd>This key contains the UAF protocol Message that will be
	    processed by the FIDO UAF Client or Server. Modification by the
	    client application may invalidate the message. A client
	    application <em class="rfc2119" title="MAY">MAY</em> examine the contents of a message, for example,
	    to determine if a message is still fresh. Details of the
	    structure of the message can be found in the UAF protocol
	    Specification [<cite><a class="bibref" href="#bib-UAFProtocol">UAFProtocol</a></cite>].</dd><dt id="widl-UAFMessage-additionalData"><code>additionalData</code> of type <span class="idlMemberType">Object</span></dt><dd>This key allows the FIDO Server or client application to attach
	    additional data for use by the FIDO UAF Client as a JSON object, or
	    the FIDO UAF Client or client application to attach additional data
	    for use by the client application.</dd></dl></section>
      </section>
      
      <section id="version-interface">
	<h3 aria-level="2" role="heading" id="h3_version-interface"><span class="secno">4.2 </span>Version interface</h3>
	
	<p>Describes a version of the UAF protocol or FIDO UAF Client for
	  compatibility checking.
	</p>
	<pre class="idl"><span class="idlInterface" id="idl-def-Version">interface <span class="idlInterfaceID">Version</span> {
<span class="idlAttribute">    readonly    attribute <span class="idlAttrType">unsigned short</span> <span class="idlAttrName"><a href="#widl-Version-major">major</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class="idlAttrType">unsigned short</span> <span class="idlAttrName"><a href="#widl-Version-minor">minor</a></span>;</span>
};</span></pre><section id="attributes"><h4 aria-level="3" role="heading" id="h4_attributes"><span class="secno">4.2.1 </span>Attributes</h4><dl class="attributes"><dt id="widl-Version-major"><code>major</code> of type <span class="idlAttrType">unsigned short</span>, readonly   </dt><dd>Major version number.</dd><dt id="widl-Version-minor"><code>minor</code> of type <span class="idlAttrType">unsigned short</span>, readonly   </dt><dd>Minor version number.</dd></dl></section>
      </section>
      <section id="authenticator-interface">
	<h3 aria-level="2" role="heading" id="h3_authenticator-interface"><span class="secno">4.3 </span>Authenticator interface</h3>      
	<p>Used by several phases of UAF, the <code>Authenticator</code> interface
	  exposes a subset of both verified metadata [<cite><a class="bibref" href="#bib-UAFAuthnrMetadata">UAFAuthnrMetadata</a></cite>] and
	  transient information about the state of an available
	  authenticator.
	</p>
	<pre class="idl"><span class="idlInterface" id="idl-def-Authenticator">interface <span class="idlInterfaceID">Authenticator</span> {
<span class="idlAttribute">    readonly    attribute <span class="idlAttrType">DOMString</span>                             <span class="idlAttrName"><a href="#widl-Authenticator-title">title</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class="idlAttrType">AAID</span>                                  <span class="idlAttrName"><a href="#widl-Authenticator-aaid">aaid</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class="idlAttrType">DOMString</span>                             <span class="idlAttrName"><a href="#widl-Authenticator-description">description</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class="idlAttrType"><a href="#idl-def-Version" class="idlType"><code>Version</code></a>[]</span>                             <span class="idlAttrName"><a href="#widl-Authenticator-supportedUAFVersions">supportedUAFVersions</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class="idlAttrType">DOMString</span>                             <span class="idlAttrName"><a href="#widl-Authenticator-assertionScheme">assertionScheme</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class="idlAttrType">unsigned short</span>                        <span class="idlAttrName"><a href="#widl-Authenticator-authenticationAlgorithm">authenticationAlgorithm</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class="idlAttrType">unsigned short[]</span>                      <span class="idlAttrName"><a href="#widl-Authenticator-attestationTypes">attestationTypes</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class="idlAttrType">unsigned long</span>                         <span class="idlAttrName"><a href="#widl-Authenticator-userVerification">userVerification</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class="idlAttrType">unsigned short</span>                        <span class="idlAttrName"><a href="#widl-Authenticator-keyProtection">keyProtection</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class="idlAttrType">unsigned short</span>                        <span class="idlAttrName"><a href="#widl-Authenticator-matcherProtection">matcherProtection</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class="idlAttrType">unsigned long</span>                         <span class="idlAttrName"><a href="#widl-Authenticator-attachmentHint">attachmentHint</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class="idlAttrType">boolean</span>                               <span class="idlAttrName"><a href="#widl-Authenticator-isSecondFactorOnly">isSecondFactorOnly</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class="idlAttrType">unsigned short</span>                        <span class="idlAttrName"><a href="#widl-Authenticator-tcDisplay">tcDisplay</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class="idlAttrType">DOMString</span>                             <span class="idlAttrName"><a href="#widl-Authenticator-tcDisplayContentType">tcDisplayContentType</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class="idlAttrType">DisplayPNGCharacteristicsDescriptor[]</span> <span class="idlAttrName"><a href="#widl-Authenticator-tcDisplayPNGCharacteristics">tcDisplayPNGCharacteristics</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class="idlAttrType">DOMString</span>                             <span class="idlAttrName"><a href="#widl-Authenticator-icon">icon</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class="idlAttrType">DOMString[]</span>                           <span class="idlAttrName"><a href="#widl-Authenticator-supportedExtensionIDs">supportedExtensionIDs</a></span>;</span>
};</span></pre><section id="attributes-1"><h4 aria-level="3" role="heading" id="h4_attributes-1"><span class="secno">4.3.1 </span>Attributes</h4><dl class="attributes"><dt id="widl-Authenticator-title"><code>title</code> of type <span class="idlAttrType">DOMString</span>, readonly   </dt><dd>
	    A short, user-friendly name for the authenticator.
	    <div class="note"><div class="note-title" aria-level="4" role="heading" id="h_note_4"><span>Note</span></div><div class="">
	      <p>This text must be localized for current locale.</p>
	      <p>If the ASM doesn't return a title in the <code>AuthenticatorInfo</code> object [<cite><a class="bibref" href="#bib-UAFASM">UAFASM</a></cite>], 
		the FIDO UAF Client must generate a title based 
		on the other fields in <code>AuthenticatorInfo</code>, because <code>title</code> must not be empty 
		(see section <a href="#notation" class="sec-ref"><span class="secno">1.</span> <span class="sec-title">Notation</span></a>).</p>
	    </div></div>
	  </dd><dt id="widl-Authenticator-aaid"><code>aaid</code> of type <span class="idlAttrType">AAID</span>, readonly   </dt><dd>
	    The <em>Authenticator Attestation ID</em>, which identifies the type and
	    batch of the authenticator. See [<cite><a class="bibref" href="#bib-UAFProtocol">UAFProtocol</a></cite>] for the definition of the AAID structure.
	  </dd><dt id="widl-Authenticator-description"><code>description</code> of type <span class="idlAttrType">DOMString</span>, readonly   </dt><dd>
	    A user-friendly description string for the authenticator.
	    <div class="note"><div class="note-title" aria-level="4" role="heading" id="h_note_5"><span>Note</span></div><div class="">
	      <p>This text must be localized for current locale.</p>
	      <p>It is intended to be displayed to the user. It might deviate from the description 
		specified in the authenticator's metadata statement [<cite><a class="bibref" href="#bib-UAFAuthnrMetadata">UAFAuthnrMetadata</a></cite>].</p>
	      <p>If the ASM doesn't return a description in the <code>AuthenticatorInfo</code> object [<cite><a class="bibref" href="#bib-UAFASM">UAFASM</a></cite>], 
		the FIDO UAF Client must generate a meaningful description to the calling App based 
		on the other fields in <code>AuthenticatorInfo</code>, because <code>description</code> must not be empty 
		(see section <a href="#notation" class="sec-ref"><span class="secno">1.</span> <span class="sec-title">Notation</span></a>).</p>
	    </div></div>
	  </dd><dt id="widl-Authenticator-supportedUAFVersions"><code>supportedUAFVersions</code> of type array of <span class="idlAttrType"><a href="#idl-def-Version" class="idlType"><code>Version</code></a></span>, readonly   </dt><dd>
	    Indicates the UAF protocol Versions supported by the
	    authenticator.
	  </dd><dt id="widl-Authenticator-assertionScheme"><code>assertionScheme</code> of type <span class="idlAttrType">DOMString</span>, readonly   </dt><dd>
	    <p>The assertion scheme the authenticator uses for attested data and
	      signatures.
	    </p>
	    <p>Assertion scheme identifiers are defined in the UAF Registry of Predefined
	      Values. [<cite><a class="bibref" href="#bib-UAFRegistry">UAFRegistry</a></cite>]</p>
	  </dd><dt id="widl-Authenticator-authenticationAlgorithm"><code>authenticationAlgorithm</code> of type <span class="idlAttrType">unsigned short</span>, readonly   </dt><dd>
	    Supported Authentication Algorithm. The value <em class="rfc2119" title="MUST">MUST</em> be related to
	    constants with prefix <code>UAF_ALG_SIGN</code>.
	  </dd><dt id="widl-Authenticator-attestationTypes"><code>attestationTypes</code> of type array of <span class="idlAttrType">unsigned short</span>, readonly   </dt><dd>
            A list of supported attestation types. The values are defined in [<cite><a class="bibref" href="#bib-UAFRegistry">UAFRegistry</a></cite>] by the
            constants with the prefix <code>TAG_ATTESTATION</code>.
	  </dd><dt id="widl-Authenticator-userVerification"><code>userVerification</code> of type <span class="idlAttrType">unsigned long</span>, readonly   </dt><dd>
	    A set of bit flags indicating the user verification methods
	    supported by the authenticator. The values are defined by the
	    constants with the prefix <code>USER_VERIFY</code>.
	  </dd><dt id="widl-Authenticator-keyProtection"><code>keyProtection</code> of type <span class="idlAttrType">unsigned short</span>, readonly   </dt><dd>
	    A set of bit flags indicating the key protection used by the
	    authenticator. The values are defined by the constants with
	    the prefix <code>KEY_PROTECTION</code>.
	  </dd><dt id="widl-Authenticator-matcherProtection"><code>matcherProtection</code> of type <span class="idlAttrType">unsigned short</span>, readonly   </dt><dd>
	    A set of bit flags indicating the matcher protection used by the
	    authenticator. The values are defined by the constants with
	    the prefix <code>MATCHER_PROTECTION</code>.  
	  </dd><dt id="widl-Authenticator-attachmentHint"><code>attachmentHint</code> of type <span class="idlAttrType">unsigned long</span>, readonly   </dt><dd>
	    A set of bit flags indicating how the authenticator is <i>currently</i>
	    connected to the FIDO User Device. The values are defined by the 
	    constants with the prefix <code>ATTACHMENT_HINT</code>.
	    <div class="note"><div class="note-title" aria-level="4" role="heading" id="h_note_6"><span>Note</span></div><p class="">
	      Because the connection state and topology of an
	      authenticator may be transient, these values are only
	      hints that can be used in applying server-supplied
	      policy to guide the user experience. This can be used
	      to, for example, prefer a device that is connected and
	      ready for authenticating or confirming a low-value
	      transaction, rather than one that is more secure but
	      requires more user effort.</p></div>
	    <p>These values are not
	      reflected in authenticator metadata and cannot be relied
	      upon by the relying party, although some models of
	      authenticator may provide attested measurements with
	      similar semantics as part of UAF protocol messages.</p>
	  </dd><dt id="widl-Authenticator-isSecondFactorOnly"><code>isSecondFactorOnly</code> of type <span class="idlAttrType">boolean</span>, readonly   </dt><dd>
	    Indicates whether the authenticator can only be used as a second-factor.
	  </dd><dt id="widl-Authenticator-tcDisplay"><code>tcDisplay</code> of type <span class="idlAttrType">unsigned short</span>, readonly   </dt><dd>
	    A set of bit flags indicating the availability and type of
	    transaction confirmation display. The values are defined by the constants with
	    the prefix <code>TRANSACTION_CONFIRMATION_DISPLAY</code>.
	    <p>This value <em class="rfc2119" title="MUST">MUST</em> be 0 if transaction confirmation is not supported by the authenticator.</p>
	  </dd><dt id="widl-Authenticator-tcDisplayContentType"><code>tcDisplayContentType</code> of type <span class="idlAttrType">DOMString</span>, readonly   </dt><dd>
	    The MIME content-type [<cite><a class="bibref" href="#bib-RFC2045">RFC2045</a></cite>] supported by the transaction confirmation display, such as
	    <code>text/plain</code> or <code>image/png</code>.
	    <p>This value <em class="rfc2119" title="MUST">MUST</em> be non-empty if transaction confirmation is supported (<code>tcDisplay</code> is non-zero).</p>
	  </dd><dt id="widl-Authenticator-tcDisplayPNGCharacteristics"><code>tcDisplayPNGCharacteristics</code> of type array of <span class="idlAttrType">DisplayPNGCharacteristicsDescriptor</span>, readonly   </dt><dd>
	    The set of PNG characteristics <i>currently</i> supported by the transaction confirmation display (if any).
	    <div class="note"><div class="note-title" aria-level="4" role="heading" id="h_note_7"><span>Note</span></div><p class="">See [<cite><a class="bibref" href="#bib-UAFAuthnrMetadata">UAFAuthnrMetadata</a></cite>] for additional information on the format of
	      this field and the definition of the <code>DisplayPNGCharacteristicsDescriptor</code> structure. </p></div>
	    <p>This list <em class="rfc2119" title="MUST">MUST</em> be non-empty if transaction confirmation is supported (<code>tcDisplay</code> is non-zero).</p>
	  </dd><dt id="widl-Authenticator-icon"><code>icon</code> of type <span class="idlAttrType">DOMString</span>, readonly   </dt><dd>
	    A PNG [<cite><a class="bibref" href="#bib-PNG">PNG</a></cite>] icon for the authenticator, encoded as a <code>data:</code> url
	    [<cite><a class="bibref" href="#bib-RFC2397">RFC2397</a></cite>].
	    <div class="note"><div class="note-title" aria-level="4" role="heading" id="h_note_8"><span>Note</span></div><p class="">If the ASM doesn't return an icon in the <code>AuthenticatorInfo</code> object [<cite><a class="bibref" href="#bib-UAFASM">UAFASM</a></cite>], 
	      the FIDO UAF Client must set a default icon, because <code>icon</code> must not be empty 
	      (see section <a href="#notation" class="sec-ref"><span class="secno">1.</span> <span class="sec-title">Notation</span></a>).</p></div>
	  </dd><dt id="widl-Authenticator-supportedExtensionIDs"><code>supportedExtensionIDs</code> of type array of <span class="idlAttrType">DOMString</span>, readonly   </dt><dd>
	    A list of supported UAF protocol extension identifiers. These <em class="rfc2119" title="MAY">MAY</em> be vendor-specific.
	  </dd></dl></section>

	<section id="authenticator-interface-constants">
	  <h4 aria-level="3" role="heading" id="h4_authenticator-interface-constants"><span class="secno">4.3.2 </span>Authenticator Interface Constants</h4>
	  <p>	
	    A number of constants are defined for use with the bit flag
	    fields <code>userVerification</code>, <code>keyProtection</code>,
	    <code>attachmentHint</code>, and <code>tcDisplay</code>. 
	    To avoid duplication and inconsistencies, 
	    these are defined in the FIDO UAF
	    Registry of Predefined Values [<cite><a class="bibref" href="#bib-UAFRegistry">UAFRegistry</a></cite>].
	  </p>
	</section>
      </section>

      <section id="discoverydata-dictionary">
	<h3 aria-level="2" role="heading" id="h3_discoverydata-dictionary"><span class="secno">4.4 </span>DiscoveryData dictionary</h3>
	
	<pre class="idl"><span class="idlDictionary" id="idl-def-DiscoveryData">dictionary <span class="idlDictionaryID">DiscoveryData</span> {
<span class="idlMember">    <span class="idlMemberType">required Version[]</span>       <span class="idlMemberName"><a href="#widl-DiscoveryData-supportedUAFVersions">supportedUAFVersions</a></span>;</span>
<span class="idlMember">    <span class="idlMemberType">required DOMString</span>       <span class="idlMemberName"><a href="#widl-DiscoveryData-clientVendor">clientVendor</a></span>;</span>
<span class="idlMember">    <span class="idlMemberType">required Version</span>         <span class="idlMemberName"><a href="#widl-DiscoveryData-clientVersion">clientVersion</a></span>;</span>
<span class="idlMember">    <span class="idlMemberType">required Authenticator[]</span> <span class="idlMemberName"><a href="#widl-DiscoveryData-availableAuthenticators">availableAuthenticators</a></span>;</span>
};</span></pre><section id="dictionary-discoverydata-members"><h4 aria-level="3" role="heading" id="h4_dictionary-discoverydata-members"><span class="secno">4.4.1 </span>Dictionary <a class="idlType" href="#idl-def-DiscoveryData"><code>DiscoveryData</code></a> Members</h4><dl class="dictionary-members"><dt id="widl-DiscoveryData-supportedUAFVersions"><code>supportedUAFVersions</code> of type array of <span class="idlMemberType">required Version</span></dt><dd>A list of the FIDO UAF protocol versions supported by the client, most-preferred first.</dd><dt id="widl-DiscoveryData-clientVendor"><code>clientVendor</code> of type <span class="idlMemberType">required DOMString</span></dt><dd>The vendor of the FIDO UAF Client.</dd><dt id="widl-DiscoveryData-clientVersion"><code>clientVersion</code> of type <span class="idlMemberType">required Version</span></dt><dd>The version of the FIDO UAF Client. This is a vendor-specific version for the client
	    software, not a UAF version.</dd><dt id="widl-DiscoveryData-availableAuthenticators"><code>availableAuthenticators</code> of type array of <span class="idlMemberType">required Authenticator</span></dt><dd>An array containing Authenticator dictionaries describing the available UAF authenticators.
	    The order is not significant. The list <em class="rfc2119" title="MAY">MAY</em> be empty.</dd></dl></section>      
      </section>

      <section id="errorcode-interface">
	<h3 aria-level="2" role="heading" id="h3_errorcode-interface"><span class="secno">4.5 </span>ErrorCode interface</h3>
	<pre class="idl"><span class="idlInterface" id="idl-def-ErrorCode">interface <span class="idlInterfaceID">ErrorCode</span> {
<span class="idlConst">    const <span class="idlConstType">short</span> <span class="idlConstName"><a href="#NO_ERROR">NO_ERROR</a></span> = <span class="idlConstValue">0x0</span>;</span>
<span class="idlConst">    const <span class="idlConstType">short</span> <span class="idlConstName"><a href="#WAIT_USER_ACTION">WAIT_USER_ACTION</a></span> = <span class="idlConstValue">0x1</span>;</span>
<span class="idlConst">    const <span class="idlConstType">short</span> <span class="idlConstName"><a href="#INSECURE_TRANSPORT">INSECURE_TRANSPORT</a></span> = <span class="idlConstValue">0x2</span>;</span>
<span class="idlConst">    const <span class="idlConstType">short</span> <span class="idlConstName"><a href="#USER_CANCELLED">USER_CANCELLED</a></span> = <span class="idlConstValue">0x3</span>;</span>
<span class="idlConst">    const <span class="idlConstType">short</span> <span class="idlConstName"><a href="#UNSUPPORTED_VERSION">UNSUPPORTED_VERSION</a></span> = <span class="idlConstValue">0x4</span>;</span>
<span class="idlConst">    const <span class="idlConstType">short</span> <span class="idlConstName"><a href="#NO_SUITABLE_AUTHENTICATOR">NO_SUITABLE_AUTHENTICATOR</a></span> = <span class="idlConstValue">0x5</span>;</span>
<span class="idlConst">    const <span class="idlConstType">short</span> <span class="idlConstName"><a href="#PROTOCOL_ERROR">PROTOCOL_ERROR</a></span> = <span class="idlConstValue">0x6</span>;</span>
<span class="idlConst">    const <span class="idlConstType">short</span> <span class="idlConstName"><a href="#UNTRUSTED_FACET_ID">UNTRUSTED_FACET_ID</a></span> = <span class="idlConstValue">0x7</span>;</span>
<span class="idlConst">    const <span class="idlConstType">short</span> <span class="idlConstName"><a href="#UNKNOWN">UNKNOWN</a></span> = <span class="idlConstValue">0xFF</span>;</span>
};</span></pre><section id="constants"><h4 aria-level="3" role="heading" id="h4_constants"><span class="secno">4.5.1 </span>Constants</h4><dl class="constants"><dt id="widl-ErrorCode-NO_ERROR"><code>NO_ERROR</code> of type <span class="idlConstType">short</span></dt><dd>The operation completed with no error condition encountered.
	    Upon receipt of this code, an application should no longer
	    expect an associated <a title="UAFResponseCallback" href="#idl-def-UAFResponseCallback" class="idlType"><code>UAFResponseCallback</code></a> to fire.
	  </dd><dt id="widl-ErrorCode-WAIT_USER_ACTION"><code>WAIT_USER_ACTION</code> of type <span class="idlConstType">short</span></dt><dd>Waiting on user action to proceed. For example, selecting an
	    authenticator in the FIDO client user interface, performing
	    user verification, or completing an enrollment step with an
	    authenticator.
	  </dd><dt id="widl-ErrorCode-INSECURE_TRANSPORT"><code>INSECURE_TRANSPORT</code> of type <span class="idlConstType">short</span></dt><dd><code>window.location.protocol</code> is not "https" or the DOM contains
	    insecure mixed content.
	  </dd><dt id="widl-ErrorCode-USER_CANCELLED"><code>USER_CANCELLED</code> of type <span class="idlConstType">short</span></dt><dd>The user declined any necessary part of the interaction to
	    complete the registration.
	  </dd><dt id="widl-ErrorCode-UNSUPPORTED_VERSION"><code>UNSUPPORTED_VERSION</code> of type <span class="idlConstType">short</span></dt><dd>The <a title="UAFMessage" href="#idl-def-UAFMessage" class="idlType"><code>UAFMessage</code></a> does not specify a protocol version supported by
	    this FIDO UAF Client.
	  </dd><dt id="widl-ErrorCode-NO_SUITABLE_AUTHENTICATOR"><code>NO_SUITABLE_AUTHENTICATOR</code> of type <span class="idlConstType">short</span></dt><dd>No authenticator matching the authenticator policy specified in
	    the <a title="UAFMessage" href="#idl-def-UAFMessage" class="idlType"><code>UAFMessage</code></a> is available to
	    service the request, or the user declined to consent to the
	    use of a suitable authenticator.
	  </dd><dt id="widl-ErrorCode-PROTOCOL_ERROR"><code>PROTOCOL_ERROR</code> of type <span class="idlConstType">short</span></dt><dd>A violation of the UAF protocol occurred. The interaction may have
	    timed out; the origin associated with the message may not match
	    the origin of the calling DOM context, or the protocol message
	    may be malformed or tampered with.
	  </dd><dt id="widl-ErrorCode-UNTRUSTED_FACET_ID"><code>UNTRUSTED_FACET_ID</code> of type <span class="idlConstType">short</span></dt><dd>The client declined to process the operation because the
	    caller's calculated facet identifier was not found in the
	    trusted list for the application identifier specified in the
	    request message.
	  </dd><dt id="widl-ErrorCode-UNKNOWN"><code>UNKNOWN</code> of type <span class="idlConstType">short</span></dt><dd>An error condition not described by the above-listed codes.
	  </dd></dl></section>
      </section>
    </section>

    <section class="normativeDisclaimer" id="dom-api">
      <!--OddPage--><h2 aria-level="1" role="heading" id="h2_dom-api"><span class="secno">5. </span>DOM API</h2><p><em>This section is normative.</em></p>

      <p>This section describes the API details exposed by a web browser
	or browser plugin to a client-side web application executing in
	a <code>Document</code> [<cite><a class="bibref" href="#bib-DOM">DOM</a></cite>] context.</p>
      
      <section id="feature-detection">
	<h3 aria-level="2" role="heading" id="h3_feature-detection"><span class="secno">5.1 </span>Feature Detection</h3>
	
	<p>FIDO's UAF DOM APIs are rooted in a new <code>fido</code> object, a property
	  of <code>window.navigator</code> code; the existence and properties of which
	  <em class="rfc2119" title="MAY">MAY</em> be used for feature detection.</p>
	
	<p>Example 1: Feature Detection of UAF APIs</p>
	
	<div class="example"><div class="example-title"><span>Example 1</span></div><pre class="example">&lt;script&gt;

if(!!window.navigator.fido.uaf) { var useUAF = true; }

&lt;/script&gt;</pre></div>
      </section>

      <section id="uaf-interface">
	<h3 aria-level="2" role="heading" id="h3_uaf-interface"><span class="secno">5.2 </span>uaf Interface</h3>
	<p>The <code>window.navigator.fido.uaf</code> interface is the primary means of
	  interacting with the FIDO UAF Client.  All operations are asynchronous.</p>
	
	<pre class="idl"><span class="idlInterface" id="idl-def-uaf">interface <span class="idlInterfaceID">uaf</span> {
<span class="idlMethod">    <span class="idlMethType">void</span> <span class="idlMethName"><a href="#widl-uaf-discover-void-DiscoveryCallback-completionCallback-ErrorCallback-errorCallback">discover</a></span> (<span class="idlParam"><span class="idlParamType"><a href="#idl-def-DiscoveryCallback" class="idlType"><code>DiscoveryCallback</code></a></span> <span class="idlParamName">completionCallback</span></span>, <span class="idlParam"><span class="idlParamType"><a href="#idl-def-ErrorCallback" class="idlType"><code>ErrorCallback</code></a></span> <span class="idlParamName">errorCallback</span></span>);</span>
<span class="idlMethod">    <span class="idlMethType">void</span> <span class="idlMethName"><a href="#widl-uaf-checkPolicy-void-UAFMessage-message-ErrorCallback-cb">checkPolicy</a></span> (<span class="idlParam"><span class="idlParamType"><a href="#idl-def-UAFMessage" class="idlType"><code>UAFMessage</code></a></span> <span class="idlParamName">message</span></span>, <span class="idlParam"><span class="idlParamType"><a href="#idl-def-ErrorCallback" class="idlType"><code>ErrorCallback</code></a></span> <span class="idlParamName">cb</span></span>);</span>
<span class="idlMethod">    <span class="idlMethType">void</span> <span class="idlMethName"><a href="#widl-uaf-processUAFOperation-void-UAFMessage-message-UAFResponseCallback-completionCallback-ErrorCallback-errorCallback">processUAFOperation</a></span> (<span class="idlParam"><span class="idlParamType"><a href="#idl-def-UAFMessage" class="idlType"><code>UAFMessage</code></a></span> <span class="idlParamName">message</span></span>, <span class="idlParam"><span class="idlParamType"><a href="#idl-def-UAFResponseCallback" class="idlType"><code>UAFResponseCallback</code></a></span> <span class="idlParamName">completionCallback</span></span>, <span class="idlParam"><span class="idlParamType"><a href="#idl-def-ErrorCallback" class="idlType"><code>ErrorCallback</code></a></span> <span class="idlParamName">errorCallback</span></span>);</span>
<span class="idlMethod">    <span class="idlMethType">void</span> <span class="idlMethName"><a href="#widl-uaf-notifyUAFResult-void-int-responseCode-UAFMessage-uafResponse">notifyUAFResult</a></span> (<span class="idlParam"><span class="idlParamType">int</span> <span class="idlParamName">responseCode</span></span>, <span class="idlParam"><span class="idlParamType"><a href="#idl-def-UAFMessage" class="idlType"><code>UAFMessage</code></a></span> <span class="idlParamName">uafResponse</span></span>);</span>
};</span></pre><section id="methods"><h4 aria-level="3" role="heading" id="h4_methods"><span class="secno">5.2.1 </span>Methods</h4><dl class="methods"><dt id="widl-uaf-discover-void-DiscoveryCallback-completionCallback-ErrorCallback-errorCallback"><code>discover</code></dt><dd>
	    <p>Discover if the user's client software and devices support
	      UAF and if authenticator capabilities are available that it may
	      be willing to accept for authentication.</p>
	    
	  <table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">completionCallback</td><td class="prmType"><code><a href="#idl-def-DiscoveryCallback" class="idlType"><code>DiscoveryCallback</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">✘</span></td><td class="prmOptFalse"><span role="img" aria-label="False">✘</span></td><td class="prmDesc">The callback that receives <a title="DiscoveryData" href="#idl-def-DiscoveryData" class="idlType"><code>DiscoveryData</code></a> from
		the FIDO UAF Client.</td></tr><tr><td class="prmName">errorCallback</td><td class="prmType"><code><a href="#idl-def-ErrorCallback" class="idlType"><code>ErrorCallback</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">✘</span></td><td class="prmOptFalse"><span role="img" aria-label="False">✘</span></td><td class="prmDesc">A callback function to receive error and progress events.</td></tr></tbody></table><div><em>Return type: </em><code>void</code></div></dd><dt id="widl-uaf-checkPolicy-void-UAFMessage-message-ErrorCallback-cb"><code>checkPolicy</code></dt><dd>
	    <p>Ask the browser or browser plugin if it would be able to process the supplied
	      request message without prompting the user.
	    </p>
	    <p>Unlike other operations using an <a title="ErrorCallback" href="#idl-def-ErrorCallback" class="idlType"><code>ErrorCallback</code></a>,
	      this operation <em class="rfc2119" title="MUST">MUST</em> always trigger the callback and
	      return <code>NO_ERROR</code> if
	      it believes that the message can be processed and a
	      suitable authenticator matching the embedded policy is
	      available, or the appropriate<a title="ErrorCode" href="#idl-def-ErrorCode" class="idlType"><code>ErrorCode</code></a> value otherwise. 
	    </p>
	    <div class="note"><div class="note-title" aria-level="4" role="heading" id="h_note_9"><span>Note</span></div><p class="">Because this call should not prompt
	      the user, it should not incur a potentially disrupting
	      context-switch even if the FIDO UAF Client is implemented
	      out-of-process.</p></div>
	    
	  <table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">message</td><td class="prmType"><code><a href="#idl-def-UAFMessage" class="idlType"><code>UAFMessage</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">✘</span></td><td class="prmOptFalse"><span role="img" aria-label="False">✘</span></td><td class="prmDesc">
		A <a title="UAFMessage" href="#idl-def-UAFMessage" class="idlType"><code>UAFMessage</code></a> containing the policy and operation to be
		tested.
	      </td></tr><tr><td class="prmName">cb</td><td class="prmType"><code><a href="#idl-def-ErrorCallback" class="idlType"><code>ErrorCallback</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">✘</span></td><td class="prmOptFalse"><span role="img" aria-label="False">✘</span></td><td class="prmDesc">The callback function which receives the status of the operation.</td></tr></tbody></table><div><em>Return type: </em><code>void</code></div></dd><dt id="widl-uaf-processUAFOperation-void-UAFMessage-message-UAFResponseCallback-completionCallback-ErrorCallback-errorCallback"><code>processUAFOperation</code></dt><dd>
	    Invokes the FIDO UAF Client, transferring control to prompt the user
	    as necessary to complete the operation, and returns to the
	    callback a message in one of the supported protocol versions
	    indicated by the UAFMessage.
  	    
	  <table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">message</td><td class="prmType"><code><a href="#idl-def-UAFMessage" class="idlType"><code>UAFMessage</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">✘</span></td><td class="prmOptFalse"><span role="img" aria-label="False">✘</span></td><td class="prmDesc">The <a title="UAFMessage" href="#idl-def-UAFMessage" class="idlType"><code>UAFMessage</code></a> to be used by the FIDO client software.</td></tr><tr><td class="prmName">completionCallback</td><td class="prmType"><code><a href="#idl-def-UAFResponseCallback" class="idlType"><code>UAFResponseCallback</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">✘</span></td><td class="prmOptFalse"><span role="img" aria-label="False">✘</span></td><td class="prmDesc">The callback that receives the client response <a title="UAFMessage" href="#idl-def-UAFMessage" class="idlType"><code>UAFMessage</code></a> from
		the FIDO UAF Client, to be delivered to the relying party server.</td></tr><tr><td class="prmName">errorCallback</td><td class="prmType"><code><a href="#idl-def-ErrorCallback" class="idlType"><code>ErrorCallback</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">✘</span></td><td class="prmOptFalse"><span role="img" aria-label="False">✘</span></td><td class="prmDesc">A callback function to receive error and progress events from
		the FIDO UAF Client.</td></tr></tbody></table><div><em>Return type: </em><code>void</code></div></dd><dt id="widl-uaf-notifyUAFResult-void-int-responseCode-UAFMessage-uafResponse"><code>notifyUAFResult</code></dt><dd>
	    <p>Used to indicate the status code resulting from a FIDO UAF message delivered to the
	      remote server. Applications <em class="rfc2119" title="MUST">MUST</em> make this call when they
	      receive a UAF status code from a server. This allows the FIDO UAF Client to
	      perform housekeeping for a better user experience, for example
	      not attempting to use keys that a server refused to register.</p>
	    
	    <div class="note"><div class="note-title" aria-level="4" role="heading" id="h_note_10"><span>Note</span></div><p class="">If, and how, a status code is delivered by the server, is
	      application and transport specific. A non-normative example can
	      be found below in the <a href="#HttpsTransportInteroperabilityProfile">
 	      HTTPS Transport Interoperability Profile</a>.</p></div>
	    
	    
	  <table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">responseCode</td><td class="prmType"><code>int</code></td><td class="prmNullFalse"><span role="img" aria-label="False">✘</span></td><td class="prmOptFalse"><span role="img" aria-label="False">✘</span></td><td class="prmDesc">The <code>uafResult</code> field of a <a title="ServerResponse" href="#idl-def-ServerResponse" class="idlType"><code>ServerResponse</code></a>.</td></tr><tr><td class="prmName">uafResponse</td><td class="prmType"><code><a href="#idl-def-UAFMessage" class="idlType"><code>UAFMessage</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">✘</span></td><td class="prmOptFalse"><span role="img" aria-label="False">✘</span></td><td class="prmDesc">The <a title="UAFMessage" href="#idl-def-UAFMessage" class="idlType"><code>UAFMessage</code></a> to which this <code>responseCode</code> applies.</td></tr></tbody></table><div><em>Return type: </em><code>void</code></div></dd></dl></section>
      </section>

      <section id="uafresponsecallback">
	<h3 aria-level="2" role="heading" id="h3_uafresponsecallback"><span class="secno">5.3 </span>UAFResponseCallback</h3>
	
	<p>A <code>UAFResponseCallback</code> is used upon successful completion of an
	  asynchronous operation by the FIDO UAF Client to return the
	  protocol response message to the client application for
	  transport to the server.</p>
	
	<pre class="idl"><span class="idlCallback" id="idl-def-UAFResponseCallback">callback <span class="idlCallbackID">UAFResponseCallback</span> = <span class="idlCallbackType">void</span> (<span class="idlParam"><span class="idlParamType"><a href="#idl-def-UAFMessage" class="idlType"><code>UAFMessage</code></a></span> <span class="idlParamName">uafResponse</span></span>);</span></pre><section id="callback-uafresponsecallback-parameters"><h4 aria-level="3" role="heading" id="h4_callback-uafresponsecallback-parameters"><span class="secno">5.3.1 </span>Callback <a class="idlType" href="#idl-def-UAFResponseCallback"><code>UAFResponseCallback</code></a> Parameters</h4><dl class="callback-members"><dt id="widl-UAFResponseCallback-uafResponse"><code>uafResponse</code> of type <span class="idlMemberType"><a href="#idl-def-UAFMessage" class="idlType"><code>UAFMessage</code></a></span></dt><dd>The message and any additional data representing the FIDO
	    UAF Client's response to the server's request message.</dd></dl></section>
	
      </section>
      
      <section id="discoverycallback">
	<h3 aria-level="2" role="heading" id="h3_discoverycallback"><span class="secno">5.4 </span>DiscoveryCallback</h3>
	
	<p>A <code>DiscoveryCallback</code> is used upon successful completion of an
	  asynchronous discover operation by the FIDO UAF Client to return the 
	  <a title="DiscoveryData" href="#idl-def-DiscoveryData" class="idlType"><code>DiscoveryData</code></a> to the client application.</p>
	
	<pre class="idl"><span class="idlCallback" id="idl-def-DiscoveryCallback">callback <span class="idlCallbackID">DiscoveryCallback</span> = <span class="idlCallbackType">void</span> (<span class="idlParam"><span class="idlParamType"><a href="#idl-def-DiscoveryData" class="idlType"><code>DiscoveryData</code></a></span> <span class="idlParamName">data</span></span>);</span></pre><section id="callback-discoverycallback-parameters"><h4 aria-level="3" role="heading" id="h4_callback-discoverycallback-parameters"><span class="secno">5.4.1 </span>Callback <a class="idlType" href="#idl-def-DiscoveryCallback"><code>DiscoveryCallback</code></a> Parameters</h4><dl class="callback-members"><dt id="widl-DiscoveryCallback-data"><code>data</code> of type <span class="idlMemberType"><a href="#idl-def-DiscoveryData" class="idlType"><code>DiscoveryData</code></a></span></dt><dd>Describes the current state of FIDO UAF client software and authenticators available to the application.</dd></dl></section>
	
      </section>
      
      
      <section id="errorcallback">
	<h3 aria-level="2" role="heading" id="h3_errorcallback"><span class="secno">5.5 </span>ErrorCallback</h3>
	
	<p>An ErrorCallback is used to return progress and error codes from
	  asynchronous operations performed by the FIDO UAF Client.</p>
	
	<pre class="idl"><span class="idlCallback" id="idl-def-ErrorCallback">callback <span class="idlCallbackID">ErrorCallback</span> = <span class="idlCallbackType">void</span> (<span class="idlParam"><span class="idlParamType"><a href="#idl-def-ErrorCode" class="idlType"><code>ErrorCode</code></a></span> <span class="idlParamName">code</span></span>);</span></pre><section id="callback-errorcallback-parameters"><h4 aria-level="3" role="heading" id="h4_callback-errorcallback-parameters"><span class="secno">5.5.1 </span>Callback <a class="idlType" href="#idl-def-ErrorCallback"><code>ErrorCallback</code></a> Parameters</h4><dl class="callback-members"><dt id="widl-ErrorCallback-code"><code>code</code> of type <span class="idlMemberType"><a href="#idl-def-ErrorCode" class="idlType"><code>ErrorCode</code></a></span></dt><dd>A value from the <code>ErrorCode</code> interface indicating the 
	    result of the operation.</dd></dl></section>
	<p>For certain operations, an ErrorCallback may be called multiple
	  times, for example with the <code>WAIT_USER_ACTION</code> code.</p>
      </section>

      
      <section class="informative" id="privacy-considerations-for-the-dom-api">
	<h3 aria-level="2" role="heading" id="h3_privacy-considerations-for-the-dom-api"><span class="secno">5.6 </span>Privacy Considerations for the DOM API</h3><p><em>This section is non-normative.</em></p>
	
	<p>Differences in the FIDO capabilities on a user device may (among
	  many other characteristics) allow a server to "fingerprint" a
	  remote client and attempt to persistently identify it, even in
	  the absence of any explicit session state maintenance
	  mechanism. Although it may contribute some amount of signal to
	  servers attempting to fingerprint clients, the attributes
	  exposed by the Discovery API are designed to have a large
	  anonymity set size and should present little or no
	  qualitatively new privacy risk. Nonetheless, an unusual
	  configuration of FIDO Authenticators may be sufficient to
	  uniquely identify a user.</p>
	<p>It is recommended that user agents
	  expose the Discovery API to all applications without requiring
	  explicit user consent by default, but user agents or FIDO
	  Client implementers should provide users with the means to
	  opt-out of discovery if they wish to do so for privacy reasons.
	</p>
      </section>
      <section class="informative" id="security-considerations-for-the-dom-api">
	<h3 aria-level="2" role="heading" id="h3_security-considerations-for-the-dom-api"><span class="secno">5.7 </span>Security Considerations for the DOM API</h3><p><em>This section is non-normative.</em></p>
	
	<section id="insecure-mixed-content">
	  <h4 aria-level="3" role="heading" id="h4_insecure-mixed-content"><span class="secno">5.7.1 </span>Insecure Mixed Content</h4>
	  
	  <p>When FIDO UAF APIs are called and operations are performed in a
	    <code>Document</code> context in a web user agent, such a context <em class="rfc2119" title="MUST NOT">MUST NOT</em>
	    contain insecure mixed content. The exact definition insecure
	    mixed content is specific to each user agent, but generally
	    includes any script, plugins and other "active" content,
	    forming part of or with access to the DOM, that was not itself
	    loaded over HTTPS.</p>
	  
	  <p>The UAF APIs must immediately trigger the <a title="ErrorCallback" href="#idl-def-ErrorCallback" class="idlType"><code>ErrorCallback</code></a> with the
	    <code>INSECURE_TRANSPORT</code> code and cease any further processing if any
	    APIs defined in this document are invoked by a Document context
	    that was not loaded over a secure transport and/or which
	    contains insecure mixed content.</p>
	</section>
	<section id="the-same-origin-policy-http-redirects-and-cross-origin-content">
	  <h4 aria-level="3" role="heading" id="h4_the-same-origin-policy-http-redirects-and-cross-origin-content"><span class="secno">5.7.2 </span>The Same Origin Policy, HTTP Redirects and Cross-Origin Content</h4>
	  
	  <p>When retrieving or transporting UAF protocol messages over HTTP,
	    it is important to maintain consistency among the web origin of
	    the document context and the origin embedded in the UAF
	    protocol message. Mismatches may cause the protocol to fail or
	    enable attacks against the protocol. Therefore:</p>

	  <p>FIDO UAF messages should not be transported using methods that
	    opt-out of the Same Origin Policy [<cite><a class="bibref" href="#bib-SOP">SOP</a></cite>], for example, using
	    <code>&lt;script src=”url”&gt;</code> to non-same-origin
	    URLs or by setting the <code>Access-Control-Allow-Origin</code> header
	    at the server.</p>
	  
	  <p>When transporting FIDO UAF messages using XMLHttpRequest
	    [<cite><a class="bibref" href="#bib-XHR">XHR</a></cite>] the client should not follow redirects that are to
	    URLs with a different origin than the requesting document.</p>
	  
	  <p>FIDO UAF messages should not be exposed in HTTP responses where the
	    entire response body parses as valid ECMAScript. Resources
	    exposed in this manner may be subject to unauthorized
	    interactions by hostile applications hosted at untrusted
	    origins through cross-origin embedding using <code>&lt;script
	    src=”url”&gt;</code>.
	    
	    </p><p>Web applications should not share FIDO UAF messages
	      across origins through channels such as <code>postMessage()</code> [<cite><a class="bibref" href="#bib-webmessaging">webmessaging</a></cite>].
	</p></section>
      </section>

      <section class="informative" id="implementation-notes-for-browser-plugin-authors">
	<h3 aria-level="2" role="heading" id="h3_implementation-notes-for-browser-plugin-authors"><span class="secno">5.8 </span>Implementation Notes for Browser/Plugin Authors</h3><p><em>This section is non-normative.</em></p>

	<p>Web applications utilizing UAF depend on services from the web
	  browser as a trusted platform. The APIs for web applications do
	  not provide a means to assert an origin as an application
	  identity for the purposes of FIDO operations as this will be
	  provided to the FIDO UAF Client by the browser based on its
	  privileged understanding of the actual origin context. 
	</p>
	<p>The browser must enforce that the web origin communicated to the
	  FIDO UAF Client as the application identity is accurate
	</p>
	<p>
	  The browser must also enforce that resource instances containing
	  insecure mixed-content cannot utilize the UAF DOM APIs.</p>
      </section>
    </section>

    <section class="normativeDisclaimer" id="android-intent-api">
      <!--OddPage--><h2 aria-level="1" role="heading" id="h2_android-intent-api"><span class="secno">6. </span>Android Intent API</h2><p><em>This section is normative.</em></p>
      <p>This section describes how an Android [<cite><a class="bibref" href="#bib-ANDROID">ANDROID</a></cite>] client
	application can locate and communicate with a conforming FIDO
	Client installation operating on the host device.</p>
      
      <div class="note"><div class="note-title" aria-level="2" role="heading" id="h_note_11"><span>Note</span></div><p class="">As with web applications, a variety of integration patterns are
	possible on the Android platform. The API described here allows
	an app to communicate with a shared FIDO UAF Client on the user device
	in a loosely-coupled fashion using Android <em>Intents</em>.</p></div>
      
      <section id="android-specific-definitions">
	<h3 aria-level="2" role="heading" id="h3_android-specific-definitions"><span class="secno">6.1 </span>Android-specific Definitions</h3>
	
	<section id="org.fidoalliance.uaf.permissions.fido_client">      
	  <h4 aria-level="3" role="heading" id="h4_org.fidoalliance.uaf.permissions.fido_client"><span class="secno">6.1.1 </span>org.fidoalliance.uaf.permissions.FIDO_CLIENT</h4>
	  
	  <p>FIDO UAF Clients running on Android versions prior to Android 5 <em class="rfc2119" title="MUST">MUST</em> declare
            the <code>org.fidoalliance.uaf.permissions.FIDO_CLIENT</code>
            permission and they also <em class="rfc2119" title="MUST">MUST</em> declare the related "uses-permission". 
	    See the below example of this permission expressed in an Android app manifest file 
            <code>&lt;permission/&gt;</code> and <code>&lt;uses-permission/&gt;</code> element [<cite><a class="bibref" href="#bib-AndroidAppManifest">AndroidAppManifest</a></cite>].</p>
	  <p>FIDO UAF Clients running on Android version 5 or later <em class="rfc2119" title="SHOULD NOT">SHOULD NOT</em> declare this permission and they 
	    also <em class="rfc2119" title="SHOULD NOT">SHOULD NOT</em> declare the related "uses-permission".</p>
	  <div class="example"><div class="example-title"><span>Example 2</span></div><pre class="example highlight prettyprint prettyprinted" style=""><span class="tag">&lt;permission</span><span class="pln">
    </span><span class="atn">android:name</span><span class="pun">=</span><span class="atv">"org.fidoalliance.uaf.permissions.FIDO_CLIENT"</span><span class="pln">
    </span><span class="atn">android:label</span><span class="pun">=</span><span class="atv">"Act as a FIDO Client."</span><span class="pln">
    </span><span class="atn">android:description</span><span class="pun">=</span><span class="atv">"This application acts as a FIDO Client. It may 
       access authentication devices available on the system, create and 
       delete FIDO registrations on behalf of other applications."</span><span class="pln">
    </span><span class="atn">android:protectionLevel</span><span class="pun">=</span><span class="atv">"dangerous"</span><span class="pln"> 
</span><span class="tag">/&gt;</span><span class="pln">
</span><span class="tag">&lt;uses-permission</span><span class="pln"> </span><span class="atn">android:name</span><span class="pun">=</span><span class="atv">"org.fidoalliance.uaf.permissions.FIDO_CLIENT"</span><span class="tag">/&gt;</span></pre></div>
	  <div class="note"><div class="note-title" aria-level="4" role="heading" id="h_note_12"><span>Note</span></div><div class="">
  	  <ul>
  	  <li>
  	    Since FIDO Clients perform security relevant tasks (e.g. verifying 
  	    the AppID/FacetID relation and asking for user consent), 
  	    users should carefully select the FIDO Clients they use. 
  	    Requiring apps acting as FIDO Clients to declare and use this permission
  	    allows them to be identified as such to users.
  	  </li>
  	  <li>
  	    There are not any FIDO Client resources needing "protection" 
  	    based upon the FIDO_CLIENT permission. 
  	    The reason for having FIDO Client declare the FIDO_CLIENT 
  	    permission is solely that users should be able to
  	    carefully decide which FIDO Clients to install.
  	    </li>
	  <li>
	    Android version 5 changed the way it handles the case where multiple apps declare the same 
	    permission [<cite><a class="bibref" href="#bib-Android5Changes">Android5Changes</a></cite>]; it blocks
	    the installation of all subsequent apps declaring that permission.
	  </li>
	  <li><em>The best way to flag the fact that an app 
	    may act as a FIDO Client needs to be determined for Android version 5.</em>
	  </li>
  	  </ul>
	  </div></div>
	 
	</section>
	<section id="org.fidoalliance.uaf.permissions.act_as_web_browser">
	  <h4 aria-level="3" role="heading" id="h4_org.fidoalliance.uaf.permissions.act_as_web_browser"><span class="secno">6.1.2 </span>org.fidoalliance.uaf.permissions.ACT_AS_WEB_BROWSER</h4>
	  <p>Android applications requesting services from the FIDO UAF
	    Client can do so under their own identity, or they can act as
	    the user's agent by explicitly declaring an RFC6454
	    [<cite><a class="bibref" href="#bib-RFC6454">RFC6454</a></cite>] serialization of the remote server's origin when
	    invoking the FIDO UAF Client.</p>
	  
	  <p>An application that is operating on behalf of a single entity
	    <em class="rfc2119" title="MUST NOT">MUST NOT</em> set an explicit origin. Omitting an explicit origin
	    will cause the FIDO UAF Client to determine the caller's identity as
	    <code>android:apk-key-hash:&lt;hash-of-public-key&gt;</code>. The FIDO UAF Client will
	    then compare this with the list of authorized application facets
	    for the target AppID and proceed if it is listed as trusted.</p>
	  
	  <div class="note"><div class="note-title" aria-level="4" role="heading" id="h_note_13"><span>Note</span></div><p class="">See the UAF Protocol Specification [<cite><a class="bibref" href="#bib-UAFProtocol">UAFProtocol</a></cite>] for more
	    information on application and facet identifiers.</p></div>
	  
	  <p>If the application is explicitly intended to operate as the
	    user's agent in the context of an arbitrary number of remote
	    applications (as when implementing a full web browser) it may
	    set its origin to the RFC6454 [<cite><a class="bibref" href="#bib-RFC6454">RFC6454</a></cite>] Unicode
	    serialization of the remote application's Origin. The
	    application <em class="rfc2119" title="MUST">MUST</em> satisfy the necessary conditions described in
	    <a href="#TransportSecurityRequirements">Transport Security Requirements</a>
	    for authenticating the remote server before
	    setting the origin.</p>
	  
	  <p>Use of the origin parameter requires the application to declare
	    the <code>org.fidoalliance.uaf.permissions.ACT_AS_WEB_BROWSER</code>
	    permission, and the FIDO UAF Client <em class="rfc2119" title="MUST">MUST</em> verify that the calling
	    application has this permission before processing the
	    operation.</p>
	  
	  <div class="example"><div class="example-title"><span>Example 3</span></div><pre class="example highlight prettyprint prettyprinted" style=""><span class="tag">&lt;permission</span><span class="pln"> 
   </span><span class="atn">android:name</span><span class="pun">=</span><span class="atv">"org.fidoalliance.uaf.permissions.ACT_AS_WEB_BROWSER"</span><span class="pln">
   </span><span class="atn">android:label</span><span class="pun">=</span><span class="atv">"Act as a browser for FIDO registrations."</span><span class="pln">
   </span><span class="atn">android:description</span><span class="pun">=</span><span class="atv">"This application may act as a web browser,
       creating new and accessing existing FIDO registrations for any domain."</span><span class="pln">
   </span><span class="atn">android:protectionLevel</span><span class="pun">=</span><span class="atv">"dangerous"</span><span class="pln"> 
</span><span class="tag">/&gt;</span></pre></div>
	</section>

	<section class="informative" id="channelbindings">
	  <h4 aria-level="3" role="heading" id="h4_channelbindings"><span class="secno">6.1.3 </span>channelBindings</h4><p><em>This section is non-normative.</em></p>
	  <p>In the DOM API, the browser or browser plugin is responsible for
	    supplying any available channel binding information to the FIDO
	    Client, but an Android application, as the direct owner of the
	    transport channel, must provide this information itself.</p>
	  
	  <p>The <code>channelBindings</code> data structure is:</p>
	  <p><code>Map&lt;String,String&gt;</code></p>
	  <p>with the keys as defined for the <code>ChannelBinding</code> structure in the UAF
	    Protocol Specification. [<cite><a class="bibref" href="#bib-UAFProtocol">UAFProtocol</a></cite>]</p>
	  
	  <p>The use of channel bindings for TLS helps assure the server that
	    the channel over which UAF protocol messages are transported is
	    the same channel the legitimate client is using and that
	    messages have not been forwarded through a malicious party.</p>
	  <p>UAF defines support for the <code>tls-unique</code> and
	    <code>tls-server-end-point</code> bindings from [<cite><a class="bibref" href="#bib-RFC5929">RFC5929</a></cite>], as well as
	    server certificate and ChannelID [<cite><a class="bibref" href="#bib-ChannelID">ChannelID</a></cite>] bindings. The
	    client should supply all channel binding information available
	    to it.</p>
	  <p>Missing or invalid channel binding information may cause a relying
	    party server to reject a transaction.</p>
	</section>
	
	<section id="uafintenttype-enumeration">
	  <h4 aria-level="3" role="heading" id="h4_uafintenttype-enumeration"><span class="secno">6.1.4 </span>UAFIntentType enumeration</h4>
	  <p>This enumeration describes the type of operation for the intent implementing the Android API.</p>
	  
	  <div class="note"><div class="note-title" aria-level="4" role="heading" id="h_note_14"><span>Note</span></div><p class="">UAF uses only a single intent to simplify
	    behavior in the situation even where multiple FIDO clients may be
	    installed. In such a case, the user will be prompted which of
	    the installed FIDO UAF clients should be used to handle an
	    implicit intent.</p></div>  
	  <p>If the user selected to make different FIDO
	    UAF Clients the default for different intents representing
	    different phases, it could produce inconsistent results or
	    fail to function at all.</p>
	  <p>If the application workflow requries
	    multiple calls to the client (and it usually does)
	    the application should read the <code>componentName</code> from the intent extras it receives
	    from <code>startActivityForResult()</code>
	    and pass it to <code>setComponent()</code> for subsequent intents to be sure they are 
	    explicitly resolved to the same FIDO UAF Client.</p>
	  
	  <pre class="idl"><span class="idlEnum" id="idl-def-UAFIntentType">enum <span class="idlEnumID">UAFIntentType</span> {
    "<a href="#idl-def-UAFIntentType.xDISCOVER" class="idlEnumItem">DISCOVER</a>",
    "<a href="#idl-def-UAFIntentType.xDISCOVER_RESULT" class="idlEnumItem">DISCOVER_RESULT</a>",
    "<a href="#idl-def-UAFIntentType.xCHECK_POLICY" class="idlEnumItem">CHECK_POLICY</a>",
    "<a href="#idl-def-UAFIntentType.xCHECK_POLICY_RESULT" class="idlEnumItem">CHECK_POLICY_RESULT</a>",
    "<a href="#idl-def-UAFIntentType.xUAF_OPERATION" class="idlEnumItem">UAF_OPERATION</a>",
    "<a href="#idl-def-UAFIntentType.xUAF_OPERATION_RESULT" class="idlEnumItem">UAF_OPERATION_RESULT</a>",
    "<a href="#idl-def-UAFIntentType.xUAF_OPERATION_COMPLETION_STATUS" class="idlEnumItem">UAF_OPERATION_COMPLETION_STATUS</a>"
};</span></pre><table class="simple"><tbody><tr><th colspan="2">Enumeration description</th></tr><tr><td><code id="idl-def-UAFIntentType.xDISCOVER">DISCOVER</code></td><td>Discovery</td></tr><tr><td><code id="idl-def-UAFIntentType.xDISCOVER_RESULT">DISCOVER_RESULT</code></td><td>Discovery results</td></tr><tr><td><code id="idl-def-UAFIntentType.xCHECK_POLICY">CHECK_POLICY</code></td><td>Perform a no-op check if a message could be processed.</td></tr><tr><td><code id="idl-def-UAFIntentType.xCHECK_POLICY_RESULT">CHECK_POLICY_RESULT</code></td><td>Check Policy results.</td></tr><tr><td><code id="idl-def-UAFIntentType.xUAF_OPERATION">UAF_OPERATION</code></td><td>Process a Registration, Authentication, Transaction Confirmation 
	      or Deregistration message.</td></tr><tr><td><code id="idl-def-UAFIntentType.xUAF_OPERATION_RESULT">UAF_OPERATION_RESULT</code></td><td>UAF Operation results.</td></tr><tr><td><code id="idl-def-UAFIntentType.xUAF_OPERATION_COMPLETION_STATUS">UAF_OPERATION_COMPLETION_STATUS</code></td><td>Inform the FIDO UAF Client 
	      of the completion status of a Registration, Authentication, Transaction Confirmation 
	      or Deregistration message.</td></tr></tbody></table>
	</section>
      </section>
      
      <section id="org.fidoalliance.intent.fido_operation-intent">
	<h3 aria-level="2" role="heading" id="h3_org.fidoalliance.intent.fido_operation-intent"><span class="secno">6.2 </span>org.fidoalliance.intent.FIDO_OPERATION Intent</h3>
	
	<p>All interactions between a FIDO UAF Client and an application
	  on Android takes place via a single Android intent:</p>
	
	<code>org.fidoalliance.intent.FIDO_OPERATION</code>
	
	<p>The specifics of the operation are carried by the MIME media type and various extra data included with the intent.</p>
	
	<p>The operations described in this document are of MIME media type <code>application/fido.uaf_client+json</code> 
	  and this <em class="rfc2119" title="MUST">MUST</em> be set as the <code>type</code> attribute of any intent.</p>
	
	<div class="note"><div class="note-title" aria-level="3" role="heading" id="h_note_15"><span>Note</span></div><p class="">Client applications can discover if a FIDO UAF Client (or several) is available on the system by using 
	  <code><a href="http://developer.android.com/reference/android/content/pm/PackageManager.html#queryIntentActivities(android.content.Intent,%20int)">PackageManager.queryIntentActivities(Intent intent, int flags)</a></code>
	  with this intent to see if any activities are available.</p></div>
	
	<table class="tlv">
	  <thead>
	    <tr><th>Extra</th><th>Type</th><th>Description</th></tr>
	  </thead>
	  <tbody>
	    <tr>
	      <td><code>UAFIntentType</code></td>
	      <td>String</td>
	      <td>One of the <a title="UAFIntentType" href="#idl-def-UAFIntentType" class="idlType"><code>UAFIntentType</code></a> enumeration values describing the intent.</td>
	    </tr>
	    <tr>
	      <td><code>discoveryData</code></td>
	      <td>String</td>
	      <td><a title="DiscoveryData" href="#idl-def-DiscoveryData" class="idlType"><code>DiscoveryData</code></a> JSON dictionary.</td>
	    </tr>
	    <tr>
	      <td><code>componentName</code></td>
	      <td>String</td>
	      <td>The component name of the responding FIDO UAF Client. It must be serialized using
		<a href="http://developer.android.com/reference/android/content/ComponentName.html#flattenToString()">
		  ComponentName.flattenString()</a>
	    </td></tr>
	    <tr>
	      <td><code>errorCode</code></td>
	      <td>short</td>
	      <td><a title="ErrorCode" href="#idl-def-ErrorCode" class="idlType"><code>ErrorCode</code></a> value for operation</td>
	    </tr>
	    <tr>
	      <td><code>message</code></td>
	      <td>String</td>
	      <td><a title="UAFMessage" href="#idl-def-UAFMessage" class="idlType"><code>UAFMessage</code></a> request to test or process, 
		depending on <a title="UAFIntentType" href="#idl-def-UAFIntentType" class="idlType"><code>UAFIntentType</code></a>.</td>
	    </tr>
	    <tr>
	      <td><code>origin</code></td>
	      <td>String</td>
	      <td>An RFC6454 Web Origin [<cite><a class="bibref" href="#bib-RFC6454">RFC6454</a></cite>] 
		string for the request, if the caller has 
		the <code>org.fidoalliance.permissions.ACT_AS_WEB_BROWSER</code> permission.</td>
	    </tr>
	    <tr>
	      <td><code>channelBindings</code></td>
	      <td>String</td>
	      <td>The JSON dictionary of channel bindings for the
		operation.</td>
	    </tr>
	    <tr>
	      <td><code>responseCode</code></td>
	      <td>short</td>
	      <td>The <code>uafResult</code> field of a <code>ServerResponse</code>. </td>
	    </tr>
	  </tbody>
	</table>
	
	<p>The following table shows what intent extras are expected, depending on the value of the <code>UAFIntentType</code> extra:</p>
	<table class="tlv">
	  <thead>
	    <tr>
	      <th>UAFIntentType value</th>
	      <th><font size="-1">discoveryData</font></th>
	      <th><font size="-1">componentName</font></th>
	      <th><font size="-1">errorCode</font></th>
	      <th><font size="-1">message</font></th>
	      <th><font size="-1">origin</font></th>
	      <th><font size="-1">channelBindings</font></th>
	      <th><font size="-1">responseCode</font></th>
	    </tr>
	  </thead>
	  <tbody>
	    <tr>
	      <td>"DISCOVER"</td>
	      <td></td>
	      <td></td>
	      <td></td>
	      <td></td>
	      <td></td>
	      <td></td>
	      <td></td>
	    </tr>
	    <tr>
	      <td>"DISCOVER_RESULT"</td>
	      <td><em class="rfc2119" title="OPTIONAL">OPTIONAL</em></td>
	      <td><em class="rfc2119" title="REQUIRED">REQUIRED</em></td>
	      <td><em class="rfc2119" title="REQUIRED">REQUIRED</em></td>
	      <td></td>
	      <td></td>
	      <td></td>
	      <td></td>
	    </tr>
	    <tr>
	      <td>"CHECK_POLICY"</td>
	      <td></td>
	      <td></td>
	      <td></td>
	      <td><em class="rfc2119" title="REQUIRED">REQUIRED</em></td>
	      <td><em class="rfc2119" title="OPTIONAL">OPTIONAL</em></td>
	      <td></td>
	      <td></td>
	    </tr>
	    <tr>
	      <td>"CHECK_POLICY_RESULT"</td>
	      <td></td>
	      <td><em class="rfc2119" title="REQUIRED">REQUIRED</em></td>
	      <td><em class="rfc2119" title="REQUIRED">REQUIRED</em></td>
	      <td></td>
	      <td></td>
	      <td></td>
	      <td></td>
	    </tr>
	    <tr>
	      <td>"UAF_OPERATION"</td>
	      <td></td>
	      <td></td>
	      <td></td>
	      <td><em class="rfc2119" title="REQUIRED">REQUIRED</em></td>
	      <td><em class="rfc2119" title="OPTIONAL">OPTIONAL</em></td>
	      <td><em class="rfc2119" title="REQUIRED">REQUIRED</em></td>
	      <td></td>
	    </tr>
	    <tr>
	      <td>"UAF_OPERATION_RESULT"</td>
	      <td></td>
	      <td><em class="rfc2119" title="REQUIRED">REQUIRED</em></td>
	      <td><em class="rfc2119" title="REQUIRED">REQUIRED</em></td>
	      <td><em class="rfc2119" title="OPTIONAL">OPTIONAL</em></td>
	      <td></td>
	      <td></td>
	      <td></td>
	    </tr>
	    <tr>
	      <td>"UAF_OPERATION_COMPLETION_STATUS"</td>
	      <td></td>
	      <td></td>
	      <td></td>
	      <td><em class="rfc2119" title="REQUIRED">REQUIRED</em></td>
	      <td></td>
	      <td></td>
	      <td><em class="rfc2119" title="REQUIRED">REQUIRED</em></td>
	    </tr>
	  </tbody>
	</table>

	<section id="uafintenttype.discover">
	  <h4 aria-level="3" role="heading" id="h4_uafintenttype.discover"><span class="secno">6.2.1 </span>UAFIntentType.DISCOVER</h4>
	  <p>This Android intent invokes the FIDO UAF Client to discover the available authenticators and capabilties.
	    The FIDO UAF Client generally will not show a UI associated with the handling of this intent, but
	    immediately return the JSON structure.  The calling
	    application cannot depend on this however, as the FIDO UAF Client <em class="rfc2119" title="MAY">MAY</em> show a UI for privacy purposes,
	    allowing the user to choose whether and which authenticators to disclose to the calling application.</p>
	  
	  <p>This intent <em class="rfc2119" title="MUST">MUST</em> be invoked with <code>startActivityForResult()</code>.</p>      
	</section>
	<section id="uafintenttype.discover_result">
	  <h4 aria-level="3" role="heading" id="h4_uafintenttype.discover_result"><span class="secno">6.2.2 </span>UAFIntentType.DISCOVER_RESULT</h4>
	  
	  <p>An intent with this type is returned by the FIDO UAF Client as an argument to <code>onActivityResult()</code> 
	    in response to receiving an intent of type <code>DISCOVER</code>.</p>
	  
	  <p>If the <code>resultCode</code> passed to <code>onActivityResult()</code> is <code>RESULT_OK</code>,
	    and the intent extra <code>errorCode</code> is <a href="#NO_ERROR">NO_ERROR</a>,
	    this intent has an extra, <code>discoveryData</code>, containing a <code>String</code> 
	    representation of a <a title="DiscoveryData" href="#idl-def-DiscoveryData" class="idlType"><code>DiscoveryData</code></a> JSON dictionary with the 
	    available authenticators and capabilities. </p>
	</section>
	<section id="uafintenttype.check_policy">
	  <h4 aria-level="3" role="heading" id="h4_uafintenttype.check_policy"><span class="secno">6.2.3 </span>UAFIntentType.CHECK_POLICY</h4>
	  <p>This intent invokes the FIDO UAF Client to discover if it would be able to process the supplied
	    message without prompting the user.  The action handling this intent <em class="rfc2119" title="SHOULD NOT">SHOULD NOT</em> show a UI to
	    the user.</p>
	  
	  <p>This intent requires the following extras: </p>
	  <ul>
	    <li><code>message</code>, containing a <code>String</code> representation
     	      of a <a title="UAFMessage" href="#idl-def-UAFMessage" class="idlType"><code>UAFMessage</code></a> representing the request message to test.</li>
	    <li><code>origin</code>, an <em class="rfc2119" title="OPTIONAL">OPTIONAL</em> extra that allows a caller with the
              <code>org.fidoalliance.uaf.permissions.ACT_AS_WEB_BROWSER</code> permission 
	      to supply an RFC6454 Origin [<cite><a class="bibref" href="#bib-RFC6454">RFC6454</a></cite>] string to be used instead of the application's
	      own identity.</li>
	  </ul>
	  
	  <p>This intent <em class="rfc2119" title="MUST">MUST</em> be invoked with <code>startActivityForResult()</code>.</p>
	  
	</section>
	<section id="uafintenttype.check_policy_result">
	  <h4 aria-level="3" role="heading" id="h4_uafintenttype.check_policy_result"><span class="secno">6.2.4 </span>UAFIntentType.CHECK_POLICY_RESULT</h4>
	  
	  <p>This Android intent is returned by the FIDO UAF Client as an argument to <code>onActivityResult()</code> 
	    in response to receiving a <code>CHECK_POLICY</code> intent.</p>
	  
	  <p>In addition to the <code>resultCode</code> passed to <code>onActivityResult()</code>,
	    this intent has an extra, <code>errorCode</code>, containing an <a title="ErrorCode" href="#idl-def-ErrorCode" class="idlType"><code>ErrorCode</code></a> value
	    indicating the specific error condition or <a href="#NO_ERROR">NO_ERROR</a> if the FIDO UAF Client could
	    process the message.</p>
	  
	</section>
	
	<section id="uafintenttype.uaf_operation">
	  <h4 aria-level="3" role="heading" id="h4_uafintenttype.uaf_operation"><span class="secno">6.2.5 </span>UAFIntentType.UAF_OPERATION</h4>
	  
	  
	  <p>This Android intent invokes the FIDO UAF Client to process the supplied request
	    message and return a response message ready for delivery to the FIDO UAF Server.</p>
	  <p>
	    The sender <em class="rfc2119" title="SHOULD">SHOULD</em> assume that the FIDO UAF Client will display
	    a user interface allowing the user to handle this intent,
	    for example, prompting the user to complete their verification
	    ceremony.</p>
	  
	  <p>This intent requires the following extras: </p>
	  <ul>
	    <li><code>message</code>, containing a <code>String</code> representation
     	      of a <a title="UAFMessage" href="#idl-def-UAFMessage" class="idlType"><code>UAFMessage</code></a> representing the request message to process.</li>
	    <li><code>channelBindings</code>, containing a <code>String</code> representation
     	      of a JSON dictionary as defined by the <code>ChannelBinding</code> structure in the 
              FIDO UAF Protocol Specification [<cite><a class="bibref" href="#bib-UAFProtocol">UAFProtocol</a></cite>].</li>
	    <li><code>origin</code>, an <em class="rfc2119" title="OPTIONAL">OPTIONAL</em> parameter that allows a caller with the
              <code>org.fidoalliance.uaf.permissions.ACT_AS_WEB_BROWSER</code> permission 
	      to supply an RFC6454 Origin [<cite><a class="bibref" href="#bib-RFC6454">RFC6454</a></cite>] string to be used instead of the application's
	      own identity.</li>
	  </ul>
	  
	  <p>This intent <em class="rfc2119" title="MUST">MUST</em> be invoked with <code>startActivityForResult()</code>.</p>
	  
	</section>
	
	<section id="uafintenttype.uaf_operation_result">
	  <h4 aria-level="3" role="heading" id="h4_uafintenttype.uaf_operation_result"><span class="secno">6.2.6 </span>UAFIntentType.UAF_OPERATION_RESULT</h4>
	  
	  <p>This intent is returned by the FIDO UAF Client as an argument to <code>onActivityResult()</code>, 
	    in response to receiving a <code>UAF_OPERATION</code> intent.</p>
	  
	  <p>If the <code>resultCode</code> passed to <code>onActivityResult()</code> is <code>RESULT_CANCELLED</code>,
	    this intent will have an extra, <code>errorCode</code> parameter, containing an <a title="ErrorCode" href="#idl-def-ErrorCode" class="idlType"><code>ErrorCode</code></a> value
	    indicating the specific error condition.</p>
	  
	  <p>If the <code>resultCode</code> passed to <code>onActivityResult()</code> is <code>RESULT_OK</code>,
            and the <code>errorCode</code> is <a href="#NO_ERROR">NO_ERROR</a>,
	    this intent has a <code>message</code>, containing a <code>String</code> 
	    representation of a <a title="UAFMessage" href="#idl-def-UAFMessage" class="idlType"><code>UAFMessage</code></a>, being the UAF protocol response message
	    to be delivered to the FIDO Server. </p>
	</section>
	
	
	<section id="uafintenttype.uaf_operation_completion_status">
	  <h4 aria-level="3" role="heading" id="h4_uafintenttype.uaf_operation_completion_status"><span class="secno">6.2.7 </span>UAFIntentType.UAF_OPERATION_COMPLETION_STATUS</h4>
	  
	  <p>This intent <em class="rfc2119" title="MUST">MUST</em> be delivered to the FIDO UAF Client to
	    indicate the processing status of a FIDO UAF message delivered
	    to the remote server.  This is especially important as a new
	    registration may be considered by the client to be in a
	    pending state until it is communicated that the server
	    accepted it.</p>
	  
	</section>
	
      </section>
      
      <section class="informative" id="security-considerations-for-android-implementations">
	<h3 aria-level="2" role="heading" id="h3_security-considerations-for-android-implementations"><span class="secno">6.3 </span>Security Considerations for Android Implementations</h3><p><em>This section is non-normative.</em></p>
	
	<p>Android applications may choose to implement the
	  user-interactive portion of FIDO in at least two ways:
	  </p><ul>
	    <li>
	      by authoring an Android Activity using Android-native user interface
	      components, or</li>
	    <li>
	      with an HTML-based experience by loading an
	      Android WebView and injecting the UAF DOM APIs with
	      <code>addJavaScriptInterface()</code>.
	    </li>
	  </ul>
	  
	  <p>
	    An application that chooses to inject the UAF interface into a
	    WebView <em class="rfc2119" title="MUST">MUST</em> follow all appropriate security considerations
	    that apply to usage of the DOM APIs, <em>and</em> those that apply to
	    user agent implementers.</p>
	  
	  <p>In particular, the content of a WebView
	    into which an API will be injected <em class="rfc2119" title="MUST">MUST</em> be loaded only from
	    trusted local content or over a secure channel as specified in
	    <a href="#TransportSecurityRequirements">Transport Security Requirements</a>
	    and must not contain insecure mixed-content.</p>
	  
	  <p>Applications should not declare the <code>ACT_AS_WEB_BROWSER</code> permission
	    unless they need to act as the user's agent for an un-predetermined
	    number of third party applications. Where an Android application
	    has an explicit relationship with a relying party application(s),
	    the preferred method of access control is for those applications
	    to list the Android application's identity as a trusted facet. See the UAF 
	    Protocol Specification [UAFProtocol] for more information on application and facet identifiers.</p>
	  
	  <p>To protect against a malicious application registering itself
	    as a FIDO UAF Client, relying party applications can obtain
	    the identity of the responding application, and utilize it in
	    risk management decisions around the authentication or
	    transaction events. </p>
	  <p>For example, a relying party might
	    maintain a list of application identities known to belong to
	    malware and refuse to accept operations completed with such
	    clients, or a list of application identities of known-good
	    clients that receive preferred risk-scoring.</p>
	  <p>Relying party applications running on Android versions prior to Android 5 must make sure that a FIDO UAF Client has 
	    the "uses-permission" for <code>org.fidoalliance.uaf.permissions.FIDO_CLIENT</code>.  Relying party 
	    applications running on Android 5 should not implement this check.
	  </p>
	  <div class="note"><div class="note-title" aria-level="3" role="heading" id="h_note_16"><span>Note</span></div><p class="">Relying party applications should implement the check on Android prior to 5 by using the 
	    package manager to verify that the FIDO Client indeed 
	    declared the <code>org.fidoalliance.uaf.permissions.FIDO_CLIENT</code> permission (see example below).  
	    Relying party applications should not use a "uses-permission" for <code>FIDO_CLIENT</code>.  
	  </p></div>
	  <div class="example"><div class="example-title"><span>Example 4</span></div><pre class="example highlight prettyprint prettyprinted" style=""><span class="pln">boolean checkFIDOClientPermission</span><span class="pun">(</span><span class="typ">String</span><span class="pln"> packageName</span><span class="pun">)</span><span class="pln"> 
                                       throws </span><span class="typ">NameNotFoundException</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="typ">String</span><span class="pln"> requestedPermission </span><span class="pun">:</span><span class="pln"> 
         getPackageManager</span><span class="pun">().</span><span class="pln">getPackageInfo</span><span class="pun">(</span><span class="pln">packageName</span><span class="pun">,</span><span class="pln"> 
             </span><span class="typ">PackageManager</span><span class="pun">.</span><span class="pln">GET_PERMISSIONS</span><span class="pun">).</span><span class="pln">requestedPermissions</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
      </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">requestedPermission</span><span class="pun">.</span><span class="pln">matches</span><span class="pun">(</span><span class="pln">
           </span><span class="str">"org.fidoalliance.uaf.permissions.FIDO_CLIENT"</span><span class="pun">))</span><span class="pln"> 
        </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">;</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
 </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></pre></div>
	  
      </section>
      
    </section>
    
    <section class="normativeDisclaimer" id="ios-custom-url-api">
      <!--OddPage--><h2 aria-level="1" role="heading" id="h2_ios-custom-url-api"><span class="secno">7. </span>iOS Custom URL API</h2><p><em>This section is normative.</em></p>
      <p>This section describes how an iOS relying party
	application can locate and communicate with a conforming FIDO UAF
	Client installed on the host device.</p>
      <div class="note"><div class="note-title" aria-level="2" role="heading" id="h_note_17"><span>Note</span></div><div class="">
	<p>Because of sandboxing and no true multitasking support, the iOS operating 
	  system offers very limited ways to do interprocess communication (IPC). 
	</p>
	<p>
	  Any IPC solution for a FIDO UAF Client must be able to:</p>
	<ol>
	  <li>Identify the calling app in order to provide FacetID approval.</li>
	  <li>Allow transition to another app without user intervention</li>
	</ol>
	<p>Currently the only IPC method on iOS that satisfies both of these requirements is custom URL handlers.</p>
	
	<p>Custom URL handlers use the iOS operating system to handle URL requests from the sender, 
	  launch the receiving app, and then pass the request to the receiving app for processing. 
	  By enabling custom URL handlers for two different applications, it is possible to achieve bidirectional 
	  IPC between them--one custom URL handler to send data from app A to app B and another custom URL 
	  handler to send data from app B to app A.</p>
	
	<p>Because iOS has no true multitasking, there must be an app transition to process each 
	  request and response. Too many app transitions can negatively affect the user experience, 
	  so relying party applications must carefully choose when it is necessary to query the FIDO UAF Client.</p>
      </div></div>
      
      <section id="ios-specific-definitions">
	<h3 aria-level="2" role="heading" id="h3_ios-specific-definitions"><span class="secno">7.1 </span>iOS-specific Definitions</h3>
	<section id="x-callback-url-transport">
	  
	  <h4 aria-level="3" role="heading" id="h4_x-callback-url-transport"><span class="secno">7.1.1 </span>X-Callback-URL Transport</h4>
	  
	  <p>When the relying party application communicates with the FIDO UAF Client, it sends a URL with the
            standard <code>x-callback-url</code> format (see <a href="http://x-callback-url.com">x-callback-url.com</a>):</p>
	  
	  <div class="example"><div class="example-title"><span>Example 5</span></div><pre class="example">FidoUAFClient1://x-callback-url/<code>[UAFxRequestType]</code>?x-success=<code>[RelyingPartyURL]</code>://x-callback-url/
       <code>[UAFxResponseType]</code>&amp;
       key=<code>[SecretKey]</code>&amp;
       state=<code>[STATE]</code>&amp;
       json=<code>[Base64EncodedJSON]</code></pre></div>

	  <ul>
            <li><code>FidoUAFClient1</code> is the iOS custom URL scheme used by FIDO UAF Clients. As specified
              in the <code>x-callback-url</code> standard, version information for the transport layer is encoded in
              the URL scheme itself (in this case, <code>FidoUAFClient1</code>). This is so other applications can check
              for support for the 1.0 version by using the <code>canOpenURL</code> call.
            </li>
            <li>
              <code>[UAFxRequestType]</code> is the type that should be used for request operations,
              which are described later in this document.
            </li>	
            <li>
              <code>[RelyingPartyURL]</code> is the URL that the relying party app has registered in order
              to receive the response. According to the <code>x-callback-url</code> 
	      standard, this is defined using the <code>x-success</code> parameter.
            </li>
            <li>
              <code>[UAFxResponseType]</code> is the type that should be used for response operations,
              which are described later in this document.
            </li>
            <li>
              <code>[SecretKey]</code> is a base64url-encoded, without padding, random key generated for each request by the calling application.
              <p>The response from the FIDO UAF Client will be encrypted with this key
		in order to prevent rogue applications from obtaining information by spoofing the return URL.</p>
            </li>	
            <li>
              <code>[STATE]</code> is data that can be used to match the request with the response.
            </li>
            <li>
              Finally <code>[Base64EncodedJSON]</code> contains the message to be sent to the FIDO UAF Client.
              <p>Items are stored in JSON format and then base64url-encoded without padding.</p>
            </li>
	  </ul>

	  <p>For FIDO UAF Clients, the custom URL scheme handler entrypoint is the openURL() function:</p>


   <div class="example"><div class="example-title"><span>Example 6</span></div><pre class="example highlight prettyprint prettyprinted" style=""><span class="pun">(</span><span class="pln">BOOL</span><span class="pun">)</span><span class="pln">application</span><span class="pun">:(</span><span class="typ">UIApplication</span><span class="pln"> </span><span class="pun">*)</span><span class="pln">application openURL</span><span class="pun">:(</span><span class="pln">NSURL </span><span class="pun">*)</span><span class="pln">url sourceApplication</span><span class="pun">:(</span><span class="typ">NSString</span><span class="pln"> </span><span class="pun">*)</span><span class="pln">sourceApplication annotation</span><span class="pun">:(</span><span class="pln">id</span><span class="pun">)</span><span class="pln">annotation</span></pre></div>

	  <p>Here, the URL above is received via the <code>url</code> parameter. For security considerations,
            the <code>sourceApplication</code> parameter contains the iOS bundle ID of the relying party application.
            This bundle ID <em class="rfc2119" title="MUST">MUST</em> be used to verify the application <code>FacetID</code>.</p>

	  <p>Conversely, when the FIDO UAF Client responds to the request, it sends the following URL back
            in standard <code>x-callback-url</code> format:</p>


   <div class="example"><div class="example-title"><span>Example 7</span></div><pre class="example"><code>[RelyingPartyURL]</code>://x-callback-url/<code>
      [UAFxResponseType]</code>&amp;
      state=<code>[STATE]</code>&amp;
      json=<code>[Base64EncodedJWE]</code></pre></div>


	  <p>The parameters in the response are similar to those of the request, except that the
            <code>[Base64EncodedEncryptedJSON]</code> parameter is encrypted with the public key before
            being base64url-encoded without padding. <code>[STATE]</code> is the same <code>STATE</code> as was sent in the request--it is echoed
            back to the sender to verify the matched response.</p>

	  <p>In the relying party application's <code>openURL()</code> handler, the <code>url</code> parameter will be the URL
            listed above and the <code>sourceApplication</code> parameter
            will be the iOS bundle ID for the FIDO client application.</p>
	</section>

	<section id="secret-key-generation">      
	  <h4 aria-level="3" role="heading" id="h4_secret-key-generation"><span class="secno">7.1.2 </span>Secret Key Generation</h4>
	  <p>A new secret encryption key <em class="rfc2119" title="MUST">MUST</em> be generated by the calling application every time it sends a request to FIDO UAF Client.
            The FIDO UAF Client <em class="rfc2119" title="MUST">MUST</em> then use this key to encrypt the response message before responding to the caller.
	  </p>
	  <p>
            <a href="http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-31">JSON Web Encryption (JWE)</a>,
            JSON Serialization (<a href="http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-31#section-7.2">JWE Section 7.2</a>)
            format <em class="rfc2119" title="MUST">MUST</em> be used to represent the encrypted response message.
	  </p>
	  <p>The encryption algorithm is that specified in 
	    <a href="http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-31#appendix-B">"A128CBC-HS256"</a>
            where the JWE "Key Management Mode" employed is "Direct Encryption" and the JWE "Content Encryption Key (CEK)" is the secret key generated by the calling application and passed to the FIDO UAF Client in the <code>key</code> parameter of the request.</p>


   <div class="example"><div class="example-title"><span>Example 8</span></div><pre class="example">{
   "unprotected": {"alg": "dir", "enc": "A128CBC-HS256"},
   "iv": "...",
   "ciphertext": "...",
   "tag": "..."
}</pre></div>

	</section>

	<section id="origin">
	  <h4 aria-level="3" role="heading" id="h4_origin"><span class="secno">7.1.3 </span>Origin</h4>
	  <p>iOS applications requesting services from the FIDO
            Client can do so under their
            own identity, or they can act as the
            user's agent by explicitly declaring an
            RFC6454 [<cite><a class="bibref" href="#bib-RFC6454">RFC6454</a></cite>] serialization of the
            remote server's origin when invoking the FIDO UAF Client.</p>
	  
	  <p>An application that is operating on behalf of a single entity
            <em class="rfc2119" title="MUST NOT">MUST NOT</em> set an explicit origin. Omitting an explicit origin
            will cause the FIDO UAF Client to determine the caller's identity as
            <code>"ios:bundle-id"</code>. The FIDO UAF Client will
            then compare this with the list of authorized application facets
            for the target AppID and proceed if it is listed as trusted.</p>

	  <p>See the UAF Protocol Specification [<cite><a class="bibref" href="#bib-UAFProtocol">UAFProtocol</a></cite>] for more
            information on application and facet identifiers.</p>

	  <p>If the application is explicitly intended to operate as the
            user's agent in the context of an arbitrary number of remote
            applications (as when implementing a full web browser)
            it may set origin to the
            RFC6454 [<cite><a class="bibref" href="#bib-RFC6454">RFC6454</a></cite>] Unicode serialization of the remote
            application's Origin. The application <em class="rfc2119" title="MUST">MUST</em> satisfy the
            necessary conditions described in
            <a href="#TransportSecurityRequirements">Transport Security Requirements</a>
            for authenticating the remote server before
            setting origin.</p>

	</section>
	<section class="informative" id="channelbindings-1">
	  <h4 aria-level="3" role="heading" id="h4_channelbindings-1"><span class="secno">7.1.4 </span>channelBindings</h4><p><em>This section is non-normative.</em></p>

	  <p>In the DOM API, the browser or browser plugin is responsible for
            supplying any available channel binding information to the FIDO
            Client, but an iOS application, as the direct owner of the
            transport channel, must provide this information itself.</p>

	  <p>The channelBindings data structure is <code>Map&lt;String,String&gt;</code> with
            the keys as defined for the <code>ChannelBinding</code> structure in the FIDO UAF
            Protocol Specification. [<cite><a class="bibref" href="#bib-UAFProtocol">UAFProtocol</a></cite>]</p>

	  <p>The use of channel bindings for TLS helps assure the server that
            the channel over which UAF protocol messages are transported is
            the same channel the legitimate client is using and that
            messages have not been forwarded through a malicious party. UAF
            defines support for the <code>tls-unique</code> and <code>tls-server-end-point</code>
            bindings from [<cite><a class="bibref" href="#bib-RFC5929">RFC5929</a></cite>], as well as server certificate and
            <code>ChannelID</code> [<cite><a class="bibref" href="#bib-ChannelID">ChannelID</a></cite>] bindings. The client should supply all
            channel binding information available to it.</p>
	  <p>Missing or invalid channel binding information may cause a relying
	    party server to reject a transaction.</p>
	</section>

	<section id="uafxtype">
	  <h4 aria-level="3" role="heading" id="h4_uafxtype"><span class="secno">7.1.5 </span>UAFxType</h4>
	  <p>This value describes the type of operation for the <code>x-callback-url</code> operations implementing the iOS API.</p>
	  
	  <pre class="idl"><span class="idlEnum" id="idl-def-UAFxType">enum <span class="idlEnumID">UAFxType</span> {
    "<a href="#idl-def-UAFxType.xDISCOVER" class="idlEnumItem">DISCOVER</a>",
    "<a href="#idl-def-UAFxType.xDISCOVER_RESULT" class="idlEnumItem">DISCOVER_RESULT</a>",
    "<a href="#idl-def-UAFxType.xCHECK_POLICY" class="idlEnumItem">CHECK_POLICY</a>",
    "<a href="#idl-def-UAFxType.xCHECK_POLICY_RESULT" class="idlEnumItem">CHECK_POLICY_RESULT</a>",
    "<a href="#idl-def-UAFxType.xUAF_OPERATION" class="idlEnumItem">UAF_OPERATION</a>",
    "<a href="#idl-def-UAFxType.xUAF_OPERATION_RESULT" class="idlEnumItem">UAF_OPERATION_RESULT</a>",
    "<a href="#idl-def-UAFxType.xUAF_OPERATION_COMPLETION_STATUS" class="idlEnumItem">UAF_OPERATION_COMPLETION_STATUS</a>"
};</span></pre><table class="simple"><tbody><tr><th colspan="2">Enumeration description</th></tr><tr><td><code id="idl-def-UAFxType.xDISCOVER">DISCOVER</code></td><td>Discovery</td></tr><tr><td><code id="idl-def-UAFxType.xDISCOVER_RESULT">DISCOVER_RESULT</code></td><td>Discovery results</td></tr><tr><td><code id="idl-def-UAFxType.xCHECK_POLICY">CHECK_POLICY</code></td><td>Perform a no-op check if a message could be processed.</td></tr><tr><td><code id="idl-def-UAFxType.xCHECK_POLICY_RESULT">CHECK_POLICY_RESULT</code></td><td>Check Policy results.</td></tr><tr><td><code id="idl-def-UAFxType.xUAF_OPERATION">UAF_OPERATION</code></td><td>The UAF message operation type (for example <code>Registration</code>).</td></tr><tr><td><code id="idl-def-UAFxType.xUAF_OPERATION_RESULT">UAF_OPERATION_RESULT</code></td><td>UAF Operation results.</td></tr><tr><td><code id="idl-def-UAFxType.xUAF_OPERATION_COMPLETION_STATUS">UAF_OPERATION_COMPLETION_STATUS</code></td><td>Inform the FIDO UAF Client of 
	      the completion status of a UAF operation (such as <code>Registration</code>.</td></tr></tbody></table>
	</section>
      </section>

      <section id="json-values">
	<h3 aria-level="2" role="heading" id="h3_json-values"><span class="secno">7.2 </span>JSON Values</h3>
	<p>The specifics of the UAFxType operation are carried by various JSON values 
	  encoded in the <code>json</code> <code>x-callback-url</code> parameter.
	  
	  </p><table class="tlv">
	    <thead>
	      <tr><th>JSON value</th><th>Type</th><th>Description</th></tr>
	    </thead>
	    <tbody>
	      <tr>
		<td><code>discoveryData</code></td>
		<td>String</td>
		<td><a title="DiscoveryData" href="#idl-def-DiscoveryData" class="idlType"><code>DiscoveryData</code></a> JSON dictionary.</td>
	      </tr>
	      <tr>
		<td><code>errorCode</code></td>
		<td>short</td>
		<td><a title="ErrorCode" href="#idl-def-ErrorCode" class="idlType"><code>ErrorCode</code></a> value for operation</td>
	      </tr>
	      <tr>
		<td><code>message</code></td>
		<td>String</td>
		<td><a title="UAFMessage" href="#idl-def-UAFMessage" class="idlType"><code>UAFMessage</code></a> request to test or process, depending on <a title="UAFxType" href="#idl-def-UAFxType" class="idlType"><code>UAFxType</code></a>.</td>
	      </tr>
	      <tr>
		<td><code>origin</code></td>
		<td>String</td>
		<td>An RFC6454 Web Origin [<cite><a class="bibref" href="#bib-RFC6454">RFC6454</a></cite>]
		  string for the request.</td>
	      </tr>
	      <tr>
		<td><code>channelBindings</code></td>
		<td>String</td>
		<td>The channel bindings
		  JSON dictionary for the operation.</td>
	      </tr>
	      <tr>
		<td><code>responseCode</code></td>
		<td>short</td>
		<td>The <code>uafResult</code> field of a <code>ServerResponse</code>. </td>
	      </tr>
	    </tbody>
	  </table>

	  <p>The following table shows what JSON values are expected, depending on the 
	    value of the <code>UAFxType</code> <code>x-callback-url</code> operation:</p>
	  <table class="tlv">
	    <thead>
	      <tr>
		<th>UAFxType operation</th>
		<th>discoveryData</th>
		<th>errorCode</th>
		<th>message</th>
		<th>origin</th>
		<th>channelBindings</th>
		<th>responseCode</th>
	      </tr>
	    </thead>
	    <tbody>
	      <tr>
		<td>"DISCOVER"</td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
	      </tr>
	      <tr>
		<td>"DISCOVER_RESULT"</td>
		<td><em class="rfc2119" title="OPTIONAL">OPTIONAL</em></td>
		<td><em class="rfc2119" title="REQUIRED">REQUIRED</em></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
	      </tr>
	      <tr>
		<td>"CHECK_POLICY"</td>
		<td></td>
		<td></td>
		<td><em class="rfc2119" title="REQUIRED">REQUIRED</em></td>
		<td><em class="rfc2119" title="OPTIONAL">OPTIONAL</em></td>
		<td></td>
		<td></td>
	      </tr>
	      <tr>
		<td>"CHECK_POLICY_RESULT"</td>
		<td></td>
		<td><em class="rfc2119" title="REQUIRED">REQUIRED</em></td>
		<td></td>
		<td></td>
		<td></td>
		<td></td>
	      </tr>
	      <tr>
		<td>"UAF_OPERATION"</td>
		<td></td>
		<td></td>
		<td><em class="rfc2119" title="REQUIRED">REQUIRED</em></td>
		<td><em class="rfc2119" title="OPTIONAL">OPTIONAL</em></td>
		<td><em class="rfc2119" title="REQUIRED">REQUIRED</em></td>
		<td></td>
	      </tr>
	      <tr>
		<td>"UAF_OPERATION_RESULT"</td>
		<td></td>
		<td><em class="rfc2119" title="REQUIRED">REQUIRED</em></td>
		<td><em class="rfc2119" title="OPTIONAL">OPTIONAL</em></td>
		<td></td>
		<td></td>
		<td></td>
	      </tr>
	      <tr>
		<td>"UAF_OPERATION_COMPLETION_STATUS"</td>
		<td></td>
		<td></td>
		<td><em class="rfc2119" title="REQUIRED">REQUIRED</em></td>
		<td></td>
		<td></td>
		<td><em class="rfc2119" title="REQUIRED">REQUIRED</em></td>
	      </tr>
	    </tbody>
	  </table>
	  
	  <section id="discover">
	    <h4 aria-level="3" role="heading" id="h4_discover"><span class="secno">7.2.1 </span>DISCOVER</h4>      
	    
	    <p>This operation invokes the FIDO UAF Client to discover the
              available authenticators and capabilities. The FIDO UAF
              Client generally will not show a user interface associated
              with the handling of this operation, but will simply
              return the resulting JSON structure.</p>
	    <p>The calling application cannot depend on this however, as the
              client <em class="rfc2119" title="MAY">MAY</em> show a user interface for privacy
              purposes, allowing the user to choose whether and which
              authenticators to disclose to the calling application. </p>
	    <div class="note"><div class="note-title" aria-level="4" role="heading" id="h_note_18"><span>Note</span></div><p class="">iOS custom URL scheme handlers always require an application switch for every 
	      request and response, even if no user interface is displayed.</p></div>
	  </section>

	  <section id="discover_result">
	    <h4 aria-level="3" role="heading" id="h4_discover_result"><span class="secno">7.2.2 </span>DISCOVER_RESULT</h4>
	    
	    <p>An operation with this type is returned by the FIDO UAF Client 
	      in response to receiving an <code>x-callback-url</code>
	      operation of type <code>DISCOVER</code>.</p>

	    <p>If the <code>resultCode</code> is <code>RESULT_OK</code>,
              and the JSON value <code>errorCode</code> is <a href="#NO_ERROR">NO_ERROR</a>,
              then this operation has a JSON value, <code>discoveryData</code>, containing a <code>String</code>
              representation of a <a title="DiscoveryData" href="#idl-def-DiscoveryData" class="idlType"><code>DiscoveryData</code></a> JSON dictionary listing the
              available authenticators and their capabilities.</p>
	  </section>

	  <section id="check_policy">
	    <h4 aria-level="3" role="heading" id="h4_check_policy"><span class="secno">7.2.3 </span>CHECK_POLICY</h4>

	    <p>This operation invokes the FIDO UAF Client to discover if
              the client would be able to process the supplied message,
              without prompting the user.</p>
	    <p>The related <code>Action</code> handling this
              operation <em class="rfc2119" title="SHOULD NOT">SHOULD NOT</em> show an interface to the user. </p>

	    <div class="note"><div class="note-title" aria-level="4" role="heading" id="h_note_19"><span>Note</span></div><p class="">iOS custom URL scheme handlers always require an application switch 
	      for every request and response, even if no UI is displayed.</p></div>
	    <p>This x-callback-url operation requires the following JSON values:</p>

	    <ul>
              <li><code>message</code>, containing a <code>String</code> representation
		of a <a title="UAFMessage" href="#idl-def-UAFMessage" class="idlType"><code>UAFMessage</code></a> representing the request message to test.</li>
              <li><code>origin</code>, an <em class="rfc2119" title="OPTIONAL">OPTIONAL</em> JSON value that allows a caller to supply 
		an RFC6454 Origin [<cite><a class="bibref" href="#bib-RFC6454">RFC6454</a></cite>] string to be used instead of the application's
		own identity.</li>
	    </ul>

	  </section>

	  <section id="check_policy_result">
	    <h4 aria-level="3" role="heading" id="h4_check_policy_result"><span class="secno">7.2.4 </span>CHECK_POLICY_RESULT</h4>
	    
	    <p>This operation is returned by the FIDO UAF Client in response to 
	      receiving a <code>CHECK_POLICY</code> x-callback-url operation.</p>
	    
	    <p>In addition to the <code>resultCode</code>,
              this x-callback-url operation has a JSON value, <code>errorCode</code>, 
	      containing an <a title="ErrorCode" href="#idl-def-ErrorCode" class="idlType"><code>ErrorCode</code></a> value
              indicating the specific error condition or <a href="#NO_ERROR">NO_ERROR</a> if the FIDO Cliet could
              process the message.</p>
	  </section>
	  
	  <section id="uaf_operation">
	    <h4 aria-level="3" role="heading" id="h4_uaf_operation"><span class="secno">7.2.5 </span>UAF_OPERATION</h4>
            
	    <p>This operation invokes the FIDO UAF Client to process the supplied request
              message and return a result message ready for delivery to the FIDO UAF Server.
              The sender <em class="rfc2119" title="SHOULD">SHOULD</em> assume that the FIDO UAF Client will display a UI to the user to
              handle this x-callback-url operation, e.g. prompting the user to complete their verification ceremony.</p>
	    
	    <p>This x-callback-url operation requires the following JSON values:</p>
	    <ul>
              <li><code>message</code>, containing a <code>String</code> representation
		of a <a title="UAFMessage" href="#idl-def-UAFMessage" class="idlType"><code>UAFMessage</code></a> representing the request message to process.</li>
              <li><code>channelBindings</code>, containing a <code>String</code> representation
		of a JSON dictionary as defined by the <code>ChannelBinding</code> structure in the
		UAF Protocol Specification [<cite><a class="bibref" href="#bib-UAFProtocol">UAFProtocol</a></cite>].</li>
              <li><code>origin</code>, an <em class="rfc2119" title="OPTIONAL">OPTIONAL</em> JSON value that allows a caller
		to supply an RFC6454 Origin [<cite><a class="bibref" href="#bib-RFC6454">RFC6454</a></cite>] string to be used instead of the application's
		own identity.</li>
	    </ul>
	  </section>
	  
	  <section id="uaf_operation_result">
	    <h4 aria-level="3" role="heading" id="h4_uaf_operation_result"><span class="secno">7.2.6 </span>UAF_OPERATION_RESULT</h4>
	    
	    <p>This x-callback-url operation is returned by the FIDO UAF Client in 
	      response to receiving a <code>UAF_OPERATION</code> x-callback-url operation.</p>

	    <p>If the <code>resultCode</code> is <code>RESULT_CANCELLED</code>,
              this x-callback-url operation has a JSON value, <code>errorCode</code>, 
	      containing an <a title="ErrorCode" href="#idl-def-ErrorCode" class="idlType"><code>ErrorCode</code></a> value
              indicating the specific error condition.</p>

	    <p>If the <code>resultCode</code> is <code>RESULT_OK</code>,,
              and the x-callback-url JSON value <code>errorCode</code> is <a href="#NO_ERROR">NO_ERROR</a>,
              this x-callback-url operation has a JSON value, <code>message</code>, containing a <code>String</code>
              representation of a <a title="UAFMessage" href="#idl-def-UAFMessage" class="idlType"><code>UAFMessage</code></a>, being the UAF protocol response message
              to be delivered to the FIDO Server.</p>      
	  </section>
	  
	  <section id="uaf_operation_completion_status">
	    <h4 aria-level="3" role="heading" id="h4_uaf_operation_completion_status"><span class="secno">7.2.7 </span>UAF_OPERATION_COMPLETION_STATUS</h4>
	    
	    <p>This x-callback-url operation <em class="rfc2119" title="MUST">MUST</em> be delivered to the FIDO UAF Client to indicate the completion status of
              a FIDO UAF message delivered to the remote server.  This is especially important as, e.g. a new
              registration may be considered in a pending status until it is known the server accepted it.</p>      
	  </section>
      </section>

      <section id="implementation-guidelines-for-ios-implementations">
	<h3 aria-level="2" role="heading" id="h3_implementation-guidelines-for-ios-implementations"><span class="secno">7.3 </span>Implementation Guidelines for iOS Implementations</h3>
	
	Each iOS Custom URL based request results in a human-noticeable context switch between the App and FIDO UAF Client and vice
	versa. This will be most noticeable when invoking DISCOVER and CHECK_POLICY requests since typically these requests
	will be invoked automatically, without user's involvement. Such a context switch impacts the User Experience and
	therefore it's <em class="rfc2119" title="RECOMMENDED">RECOMMENDED</em> to avoid making these two requests and integrate FIDO without using them.
      </section>

      <section class="informative" id="security-considerations-for-ios-implementations">
	<h3 aria-level="2" role="heading" id="h3_security-considerations-for-ios-implementations"><span class="secno">7.4 </span>Security Considerations for iOS Implementations</h3><p><em>This section is non-normative.</em></p>
	
	<p> A security concern with custom URLs under iOS is that any app can register any custom URL.
	  If multiple applications register the same custom URL, the behavior for handling the URL call in iOS is undefined.</p>
	
	<p> On the FIDO UAF Client side, this issue with custom URL scheme handlers is solved by using the
	  <code>sourceApplication</code> parameter which provides the bundle ID of the URL originator.
	  This is effective as long as the device has not been jailbroken and as long as Apple has done due diligence
	  vetting submissions to the app store for malware with faked bundle IDs.
	  The <code>sourceApplication</code> parameter can be matched with the FacetID list to ensure that
	  the calling app is approved to use the credentials for the relying party.</p>

	<p> On the relying party app side, encryption is used to prevent a rogue app from spoofing
	  the relying party app's response URL. The relying party app generates a random encryption key on every request and
	  sends it to the FIDO client.
	  The FIDO client then encrypts the response to this key. In this manner, only the relying party app
	  can decrypt the response. Even in the event that malware is able to spoof the relying party app's URL and
	  intercept the response, it would not be able to decode it.</p>

	<p> To protect against potentially malicious applications registering
	  themselves to handle the FIDO UAF Client custom URL scheme, relying party
	  Applications can obtain the bundle-id of the responding app and utilize it in
	  risk management decisions around the authentication or transaction
	  events.  For example, a relying party might maintain a list of
	  bundle-ids known to belong to malware and refuse to accept operations
	  completed with such clients, or a list of bundle-ids of known-good
	  clients that receive preferred risk-scoring.</p>
      </section>
    </section>


    <section class="normativeDisclaimer" id="transport-binding-profile">
      <!--OddPage--><h2 aria-level="1" role="heading" id="h2_transport-binding-profile"><span class="secno">8. </span>Transport Binding Profile</h2><p><em>This section is normative.</em></p>
      
      <p>This section describes general normative security requirements
	for how a client application transports FIDO UAF protocol
	messages, gives specific requirements for Transport Layer
	Security [TLS], and describes an interoperability profile for
	using HTTP over TLS [RFC2818] with the FIDO UAF protocol.</p>

      <section id="TransportSecurityRequirements" class="informative certification" typeof="bibo:Chapter" resource="#ref" rel="bibo:Chapter">
	<h3 aria-level="2" role="heading" id="h3_TransportSecurityRequirements"><span class="secno">8.1 </span>Transport Security Requirements</h3><p><em>This section is non-normative.</em></p>

	<p>The UAF protocol contains no inherent means of identifying a
	  relying party server, or for end-to-end protection of UAF
	  protocol messages. To perform a secure UAF protocol exchange,
	  the following abstract requirements apply:</p>
	<ol>
	  <li>The client application must securely authenticate the server
	    endpoint as authorized, from that client's viewpoint, to
	    represent the Web origin [<cite><a class="bibref" href="#bib-RFC6454">RFC6454</a></cite>] (scheme:host:port tuple)
	    reported to the FIDO UAF Client by the client
	    application. Most typically this will be done by using TLS and
	    verifying the server's certificate is valid, asserts the
	    correct DNS name, and chains up to a root trusted by the
	    client platform. Clients <em class="rfc2119" title="MAY">MAY</em> also utilize other means to
	    authenticate a server, such as via a pre-provisioned
	    certificate or key that is distributed with an application, or
	    alternative network authentication protocols such as Kerberos
	    [<cite><a class="bibref" href="#bib-RFC4120">RFC4120</a></cite>].</li>
	  
	  <li>The transport mechanism for UAF protocol messages must
	    provide confidentiality for the message, to prevent disclosure
	    of their contents to unauthorized third parties. These
	    protections should be cryptographically bound to proof of the
	    server's identity as described above.
	  </li>
	  
	  <li>The transport mechanism for UAF protocol messages must protect
	    the integrity of the message from tampering by unauthorized
	    third parties. These protections should be cryptographically
	    bound to proof of the server's identity in as described above.
	  </li>
	</ol>
      </section>

      <section class="informative certification" id="tls-security-requirements">
	<h3 aria-level="2" role="heading" id="h3_tls-security-requirements"><span class="secno">8.2 </span>TLS Security Requirements</h3><p><em>This section is non-normative.</em></p>
	
	<p>If using HTTP over TLS ([<cite><a class="bibref" href="#bib-RFC2246">RFC2246</a></cite>] [<cite><a class="bibref" href="#bib-RFC4346">RFC4346</a></cite>], [<cite><a class="bibref" href="#bib-RFC5246">RFC5246</a></cite>] or
	  [<cite><a class="bibref" href="#bib-TLS13draft02">TLS13draft02</a></cite>]) to transport an UAF protocol exchange, the following
	  specific requirements apply:</p>
	<ol>
	  <li>If there are any TLS errors, whether "warning" or "fatal" or any
	    other error level with the TLS connection, the HTTP client must
	    terminate the connection without prompting the user. For
	    example, this includes any errors found in certificate validity
	    checking that HTTP clients employ, such as via TLS server
	    identity checking [<cite><a class="bibref" href="#bib-RFC6125">RFC6125</a></cite>], Certificate Revocation Lists
	    (CRLs) [<cite><a class="bibref" href="#bib-RFC5280">RFC5280</a></cite>], or via the Online Certificate Status Protocol
	    (OCSP) [<cite><a class="bibref" href="#bib-RFC2560">RFC2560</a></cite>].</li>
	  
	  <li>Whenever comparisons are made between the presented TLS server
	    identity (as presented during the TLS handshake, typically
	    within the server certificate) and the intended source TLS
	    server identity (e.g., as entered by a user, or embedded in a
	    link), [<cite><a class="bibref" href="#bib-RFC6125">RFC6125</a></cite>] server identity checking must be employed. The
	    client must terminate the connection without prompting the user
	    upon any error condition.</li>
	  
	  <li>The TLS server certificate must either be provisioned explicitly
	    out-of-band (e.g. packaged with an app as a "pinned
	    certificate") or be trusted by chaining to a root included in
	    the certificate store of the operating system or a major
	    browser by virtue of being currently in compliance with their
	    root store program requirements. The client must terminate the
	    connection without user recourse if there are any error
	    conditions when building the chain of trust.</li>

	  <li>The "anon" and "null" crypto suites are not allowed and insecure
	    cryptographic algorithms in TLS (e.g. MD4, RC4, SHA1) should be
	    avoided (see NIST SP800-131A [<cite><a class="bibref" href="#bib-SP800-131A">SP800-131A</a></cite>]).</li>
	  
	  <li>The client and server should use the latest practicable TLS
	    version.</li>
	  
	  <li>The client should supply, and the server should verify whatever
	    practicable channel binding information is available, including
	    a ChannelID [<cite><a class="bibref" href="#bib-ChannelID">ChannelID</a></cite>] public key, the <code>tls-unique</code> and
	    <code>tls-server-end-point</code> bindings [<cite><a class="bibref" href="#bib-RFC5929">RFC5929</a></cite>], and TLS server
	    certificate binding [<cite><a class="bibref" href="#bib-UAFProtocol">UAFProtocol</a></cite>]. This information provides
	    protection against certain classes of network attackers and the
	    forwarding of protocol messages, and a server may reject a
	    message that lacks or has channel binding data that does not
	    verify correctly.</li>
	</ol>
      </section>

      <section id="HttpsTransportInteroperabilityProfile" class="normativeDisclaimer" typeof="bibo:Chapter" resource="#ref" rel="bibo:Chapter">
	<h3 aria-level="2" role="heading" id="h3_HttpsTransportInteroperabilityProfile"><span class="secno">8.3 </span>HTTPS Transport Interoperability Profile</h3><p><em>This section is normative.</em></p>

	<p>Conforming applications <em class="rfc2119" title="MAY">MAY</em> support this profile.</p>
	<p>Complex and highly-optimized applications utilizing UAF will
	  often transport UAF protocol messages in-line with other
	  application protocol messages. The profile defined here for
	  transporting UAF protocol messages over HTTPS is intended to:</p>
	<ul>
	  <li>Provide an interoperability profile to enable easier composition
	    of client-side application libraries and server-side
	    implementations for FIDO UAF-enabled products from different
	    vendors.</li>
	  
	  <li>Provide detailed illustration of specific necessary security
	    properties for the transport layer and HTTP interfaces,
	    especially as they may interact with a browser-hosted
	    application.</li>
	  
	  <li>This profile is also utilized in the examples that constitute
	    the appendices of this document. This profile is <em class="rfc2119" title="OPTIONAL">OPTIONAL</em> to
	    implement. RFC 2119 key words are used in this section to
	    indicate necessary security and other properties for
	    implementations that intend to use this profile to
	    interoperate.</li>
	  
	  <li><div class="note"><div class="note-title" aria-level="3" role="heading" id="h_note_20"><span>Note</span></div><p class="">Certain FIDO UAF operations, in
	    particular, transaction confirmation, will always require
	    an application-specific implementation. This interoperability
	    profile only provides a skeleton framework suitable for
	    replacing username/password authentication.</p></div>
	  </li>
	</ul>
	
	<section id="obtaining-a-uaf-request-message">
	  <h4 aria-level="3" role="heading" id="h4_obtaining-a-uaf-request-message"><span class="secno">8.3.1 </span>Obtaining a UAF Request message</h4>
	  
	  <p>A UAF-enabled web application might typically deliver request
	    messages as part of a response body containing other
	    application content, e.g in a script block as such:</p>
	  <div class="example"><div class="example-title"><span>Example 9</span></div><pre class="example highlight prettyprint prettyprinted" style=""><span class="pun">...</span><span class="pln">

</span><span class="pun">&lt;</span><span class="pln">script type</span><span class="pun">=”</span><span class="pln">application</span><span class="pun">/</span><span class="pln">json</span><span class="pun">”&gt;</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
</span><span class="pun">“</span><span class="pln">initialRequest</span><span class="pun">”:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="com">// initial request message here</span><span class="pln">
</span><span class="pun">},</span><span class="pln">

</span><span class="pun">“</span><span class="pln">lifetimeMillis</span><span class="pun">”:</span><span class="pln"> </span><span class="lit">60000</span><span class="pun">;</span><span class="pln"> </span><span class="com">// hint: this initial request is valid for 60 seconds</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="pun">&lt;/</span><span class="pln">script</span><span class="pun">&gt;</span><span class="pln">

</span><span class="pun">...</span></pre></div>

	  <p>However, request messages have a limited lifetime, and an
	    installed application cannot be delivered with a request, so
	    client applications generally need the ability to retrieve a
	    fresh request.</p>
	  
	  <p>When sending a request message over HTTPS with XMLHttpRequest
	    [XHR] or another HTTP API:</p>
	  <ol>
	    <li>The URI of the server endpoint, and how it is communicated to the
	      client, is application-specific.</li>
	    
	    <li>The client <em class="rfc2119" title="MUST">MUST</em> set the HTTP method to POST. [<cite><a class="bibref" href="#bib-RFC7231">RFC7231</a></cite>]</li>
	    
	    <li>The client <em class="rfc2119" title="MUST">MUST</em> set the HTTP “Content-Type” header to
	      <code>“application/fido+uaf; charset=utf-8”.</code> [<cite><a class="bibref" href="#bib-RFC7231">RFC7231</a></cite>]</li>
	    
	    <li>The client <em class="rfc2119" title="SHOULD">SHOULD</em> include <code>“application/fido+uaf”</code> as a media type
	      in the HTTP “Accept” header. [<cite><a class="bibref" href="#bib-RFC7231">RFC7231</a></cite>]</li>
	    
	    <li>The client <em class="rfc2119" title="MAY">MAY</em> need to supply additional headers, such as a
	      HTTP Cookie [<cite><a class="bibref" href="#bib-RFC6265">RFC6265</a></cite>], to demonstrate, in an application-specific
	      manner, their authorization to perform a request.</li>
	    
	    <li>The entire POST body <em class="rfc2119" title="MUST">MUST</em> consist entirely of a JSON [<cite><a class="bibref" href="#bib-ECMA-404">ECMA-404</a></cite>]
	      structure described by the <a href="#getuafrequest-dictionary"><code>GetUAFRequest</code> dictionary</a>.</li>
	    
	    <li>The server's response <em class="rfc2119" title="SHOULD">SHOULD</em> set the HTTP “Content-Type” to
	      <code>“application/fido+uaf; charset=utf-8”</code></li>
	    
	    <li>The client <em class="rfc2119" title="SHOULD">SHOULD</em> decode the response byte string as UTF-8 with error handling. [<cite><a class="bibref" href="#bib-HTML5">HTML5</a></cite>]</li>
	    
	    <li>The decoded body of the response <em class="rfc2119" title="MUST">MUST</em> consist entirely of a JSON structure described by
	      the <a href="#returnuafrequest-dictionary"><code>ReturnUAFRequest</code> interface</a>.</li>
	    
	  </ol>
	  
	</section>
	<section id="operation-enum">
	  <h4 aria-level="3" role="heading" id="h4_operation-enum"><span class="secno">8.3.2 </span>Operation enum</h4>
	  
	  <p>Describes the operation type of a FIDO UAF message or request for a message.
	    
	    </p><pre class="idl"><span class="idlEnum" id="idl-def-Operation">enum <span class="idlEnumID">Operation</span> {
    "<a href="#idl-def-Operation.xReg" class="idlEnumItem">Reg</a>",
    "<a href="#idl-def-Operation.xAuth" class="idlEnumItem">Auth</a>",
    "<a href="#idl-def-Operation.xDereg" class="idlEnumItem">Dereg</a>"
};</span></pre><table class="simple"><tbody><tr><th colspan="2">Enumeration description</th></tr><tr><td><code id="idl-def-Operation.xReg">Reg</code></td><td>Registration</td></tr><tr><td><code id="idl-def-Operation.xAuth">Auth</code></td><td>Authentication or Transaction Confirmation</td></tr><tr><td><code id="idl-def-Operation.xDereg">Dereg</code></td><td>Deregistration</td></tr></tbody></table>
	</section>
	
	<section id="getuafrequest-dictionary">
	  <h4 aria-level="3" role="heading" id="h4_getuafrequest-dictionary"><span class="secno">8.3.3 </span>GetUAFRequest dictionary</h4>
	  
	  
	  <pre class="idl"><span class="idlDictionary" id="idl-def-GetUAFRequest">dictionary <span class="idlDictionaryID">GetUAFRequest</span> {
<span class="idlMember">    <span class="idlMemberType"><a href="#idl-def-Operation" class="idlType"><code>Operation</code></a></span> <span class="idlMemberName"><a href="#widl-GetUAFRequest-op">op</a></span>;</span>
<span class="idlMember">    <span class="idlMemberType">DOMString</span> <span class="idlMemberName"><a href="#widl-GetUAFRequest-previousRequest">previousRequest</a></span>;</span>
<span class="idlMember">    <span class="idlMemberType">DOMString</span> <span class="idlMemberName"><a href="#widl-GetUAFRequest-context">context</a></span>;</span>
};</span></pre><section id="dictionary-getuafrequest-members"><h5 aria-level="4" role="heading" id="h5_dictionary-getuafrequest-members"><span class="secno">8.3.3.1 </span>Dictionary <a class="idlType" href="#idl-def-GetUAFRequest"><code>GetUAFRequest</code></a> Members</h5><dl class="dictionary-members"><dt id="widl-GetUAFRequest-op"><code>op</code> of type <span class="idlMemberType"><a href="#idl-def-Operation" class="idlType"><code>Operation</code></a></span></dt><dd>
	      The type of the UAF request message desired. Allowable string
	      values are defined by the Operation enum. This field is
	      <em class="rfc2119" title="OPTIONAL">OPTIONAL</em> but <em class="rfc2119" title="MUST">MUST</em> be set if the operation is not known to the
	      server through other context, e.g. an operation-specific URL
	      endpoint.
	    </dd><dt id="widl-GetUAFRequest-previousRequest"><code>previousRequest</code> of type <span class="idlMemberType">DOMString</span></dt><dd>
	      If the application is requesting a new UAF request message
	      because a previous one has expired, this <em class="rfc2119" title="OPTIONAL">OPTIONAL</em> key can include
	      the previous one to assist the server in locating any state
	      that should be re-associated with a new request message, should
	      one be issued.
	    </dd><dt id="widl-GetUAFRequest-context"><code>context</code> of type <span class="idlMemberType">DOMString</span></dt><dd>
	      Any additional contextual information that may be useful or
	      necessary for the server to generate the correct request
	      message. This key is <em class="rfc2119" title="OPTIONAL">OPTIONAL</em> and the format and nature of this
	      data is application-specific.
	    </dd></dl></section>
	  
	</section>
	<section id="returnuafrequest-dictionary">
	  
	  <h4 aria-level="3" role="heading" id="h4_returnuafrequest-dictionary"><span class="secno">8.3.4 </span>ReturnUAFRequest dictionary</h4>
	  
	  <pre class="idl"><span class="idlDictionary" id="idl-def-ReturnUAFRequest">dictionary <span class="idlDictionaryID">ReturnUAFRequest</span> {
<span class="idlMember">    <span class="idlMemberType">required unsigned long</span> <span class="idlMemberName"><a href="#widl-ReturnUAFRequest-statusCode">statusCode</a></span>;</span>
<span class="idlMember">    <span class="idlMemberType">DOMString</span>              <span class="idlMemberName"><a href="#widl-ReturnUAFRequest-uafRequest">uafRequest</a></span>;</span>
<span class="idlMember">    <span class="idlMemberType"><a href="#idl-def-Operation" class="idlType"><code>Operation</code></a></span>              <span class="idlMemberName"><a href="#widl-ReturnUAFRequest-op">op</a></span>;</span>
<span class="idlMember">    <span class="idlMemberType">long</span>                   <span class="idlMemberName"><a href="#widl-ReturnUAFRequest-lifetimeMillis">lifetimeMillis</a></span>;</span>
};</span></pre><section id="dictionary-returnuafrequest-members"><h5 aria-level="4" role="heading" id="h5_dictionary-returnuafrequest-members"><span class="secno">8.3.4.1 </span>Dictionary <a class="idlType" href="#idl-def-ReturnUAFRequest"><code>ReturnUAFRequest</code></a> Members</h5><dl class="dictionary-members"><dt id="widl-ReturnUAFRequest-statusCode"><code>statusCode</code> of type <span class="idlMemberType">required unsigned long</span></dt><dd>The UAF Status Code for the operation (see section <a href="#uaf-status-codes" class="sec-ref"><span class="secno">3.1</span> <span class="sec-title">UAF Status Codes</span></a>).</dd><dt id="widl-ReturnUAFRequest-uafRequest"><code>uafRequest</code> of type <span class="idlMemberType">DOMString</span></dt><dd>The new UAF Request Message, <em class="rfc2119" title="OPTIONAL">OPTIONAL</em>, if the server decided to issue one</dd><dt id="widl-ReturnUAFRequest-op"><code>op</code> of type <span class="idlMemberType"><a href="#idl-def-Operation" class="idlType"><code>Operation</code></a></span></dt><dd>An <em class="rfc2119" title="OPTIONAL">OPTIONAL</em> hint to the client of the operation type of the
	      message, useful if the server might return a different type
	      than was requested. For example, a server might return a
	      deregister message if an authentication request referred to a
	      key it no longer considers valid. Allowable string values are
	      defined by the Operation enum.</dd><dt id="widl-ReturnUAFRequest-lifetimeMillis"><code>lifetimeMillis</code> of type <span class="idlMemberType">long</span></dt><dd>If the server returned a <code>uafRequest</code>, this is an <em class="rfc2119" title="OPTIONAL">OPTIONAL</em> hint
	      informing the client application of the lifetime of the message
	      in milliseconds.</dd></dl></section>
	  
	</section>

	<section id="senduafresponse-dictionary">
	  <h4 aria-level="3" role="heading" id="h4_senduafresponse-dictionary"><span class="secno">8.3.5 </span>SendUAFResponse dictionary</h4>
	  
	  <pre class="idl"><span class="idlDictionary" id="idl-def-SendUAFResponse">dictionary <span class="idlDictionaryID">SendUAFResponse</span> {
<span class="idlMember">    <span class="idlMemberType">required DOMString</span> <span class="idlMemberName"><a href="#widl-SendUAFResponse-uafResponse">uafResponse</a></span>;</span>
<span class="idlMember">    <span class="idlMemberType">DOMString</span>          <span class="idlMemberName"><a href="#widl-SendUAFResponse-context">context</a></span>;</span>
};</span></pre><section id="dictionary-senduafresponse-members"><h5 aria-level="4" role="heading" id="h5_dictionary-senduafresponse-members"><span class="secno">8.3.5.1 </span>Dictionary <a class="idlType" href="#idl-def-SendUAFResponse"><code>SendUAFResponse</code></a> Members</h5><dl class="dictionary-members"><dt id="widl-SendUAFResponse-uafResponse"><code>uafResponse</code> of type <span class="idlMemberType">required DOMString</span></dt><dd>The UAF Response Message. It <em class="rfc2119" title="MUST">MUST</em> be set to
              <code>UAFMessage.uafProtocolMessage</code> returned by FIDO UAF Client.</dd><dt id="widl-SendUAFResponse-context"><code>context</code> of type <span class="idlMemberType">DOMString</span></dt><dd>Any additional contextual information that may be useful or necessary for the server to process
              the response message.
              This key is optional and the format and nature of this data is application-specific.</dd></dl></section>

	</section>

	<section id="delivering-a-uaf-response">
	  
	  <h4 aria-level="3" role="heading" id="h4_delivering-a-uaf-response"><span class="secno">8.3.6 </span>Delivering a UAF Response</h4>
	  
	  <p>Although it is not the only pattern possible, an asynchronous
	    HTTP request is a useful way of delivering a UAF Response to
	    the remote server for either web applications or standalone
	    applications.</p>
	  
	  <p>When delivering a response message over HTTPS with
	    XMLHttpRequest [<cite><a class="bibref" href="#bib-XHR">XHR</a></cite>] or another API:</p>
	  <ol>
	    <li>The URI of the server endpoint and how it is communicated to the
	      client is application-specific.</li>
	    
	    <li>The client <em class="rfc2119" title="MUST">MUST</em> set the HTTP method to POST. [<cite><a class="bibref" href="#bib-RFC7231">RFC7231</a></cite>]</li>
	    
	    <li>The client <em class="rfc2119" title="MUST">MUST</em> set the HTTP “Content-Type” header to
	      <code>“application/fido+uaf; charset=utf-8”</code>. [<cite><a class="bibref" href="#bib-RFC7231">RFC7231</a></cite>]</li>
	    
	    <li>The client <em class="rfc2119" title="SHOULD">SHOULD</em> include <code>“application/fido+uaf”</code> as a media type
	      in the HTTP “Accept” header. [<cite><a class="bibref" href="#bib-RFC7231">RFC7231</a></cite>]</li>
	    
	    <li>The client <em class="rfc2119" title="MAY">MAY</em> need to supply additional headers, such as a
	      HTTP Cookie [<cite><a class="bibref" href="#bib-RFC6265">RFC6265</a></cite>], to demonstrate, in an application-specific
	      manner, their authorization to perform an operation.</li>
	    
	    <li>The entire POST body <em class="rfc2119" title="MUST">MUST</em> consist entirely of a JSON
	      [<cite><a class="bibref" href="#bib-ECMA-404">ECMA-404</a></cite>] structure described by the
	      <code>SendUAFResponse</code>.</li>
	    
	    <li>The server's response <em class="rfc2119" title="SHOULD">SHOULD</em> set the “Content-Type” to
	      <code>“application/fido+uaf; charset=utf-8”</code> and the body of the
	      response <em class="rfc2119" title="MUST">MUST</em> consist entirely of a JSON structure described by
	      the <code>ServerResponse</code> interface.</li>
	  </ol>
	</section>
	<section id="serverresponse-interface">
	  <h4 aria-level="3" role="heading" id="h4_serverresponse-interface"><span class="secno">8.3.7 </span>ServerResponse Interface</h4>
	  
	  <p>The <code>ServerResponse</code> interface represents the completion status
	    and additional application-specific additional data that
	    results from successful processing of a Register, Authenticate,
	    or Transaction Confirmation operation. This message is not
	    formally part of the UAF protocol, but the <code>statusCode</code> should be
	    posted to the FIDO UAF Client, for housekeeping, using the
	    <code>notifyUAFResult()</code> operation.
	    
	    </p><pre class="idl"><span class="idlInterface" id="idl-def-ServerResponse">interface <span class="idlInterfaceID">ServerResponse</span> {
<span class="idlAttribute">    readonly    attribute <span class="idlAttrType">int</span>       <span class="idlAttrName"><a href="#widl-ServerResponse-statusCode">statusCode</a></span>;</span>
<span class="idlAttribute">    [<span class="extAttr">Optional</span>]
    readonly    attribute <span class="idlAttrType">DOMString</span> <span class="idlAttrName"><a href="#widl-ServerResponse-description">description</a></span>;</span>
<span class="idlAttribute">    [<span class="extAttr">Optional</span>]
    readonly    attribute <span class="idlAttrType"><a href="#idl-def-Token" class="idlType"><code>Token</code></a>[]</span>   <span class="idlAttrName"><a href="#widl-ServerResponse-additionalTokens">additionalTokens</a></span>;</span>
<span class="idlAttribute">    [<span class="extAttr">Optional</span>]
    readonly    attribute <span class="idlAttrType">DOMString</span> <span class="idlAttrName"><a href="#widl-ServerResponse-location">location</a></span>;</span>
<span class="idlAttribute">    [<span class="extAttr">Optional</span>]
    readonly    attribute <span class="idlAttrType">DOMString</span> <span class="idlAttrName"><a href="#widl-ServerResponse-postData">postData</a></span>;</span>
<span class="idlAttribute">    [<span class="extAttr">Optional</span>]
    readonly    attribute <span class="idlAttrType">DOMString</span> <span class="idlAttrName"><a href="#widl-ServerResponse-newUAFRequest">newUAFRequest</a></span>;</span>
};</span></pre><section id="attributes-2"><h5 aria-level="4" role="heading" id="h5_attributes-2"><span class="secno">8.3.7.1 </span>Attributes</h5><dl class="attributes"><dt id="widl-ServerResponse-statusCode"><code>statusCode</code> of type <span class="idlAttrType">int</span>, readonly   </dt><dd>The FIDO UAF response status code. Note that this status code
		describes the result of processing the tunneled UAF operation,
		not the status code for the outer HTTP transport.</dd><dt id="widl-ServerResponse-description"><code>description</code> of type <span class="idlAttrType">DOMString</span>, readonly   </dt><dd>A detailed message describing the status code or providing
		additional information to the user.</dd><dt id="widl-ServerResponse-additionalTokens"><code>additionalTokens</code> of type array of <span class="idlAttrType"><a href="#idl-def-Token" class="idlType"><code>Token</code></a></span>, readonly   </dt><dd>This key contains new authentication or authorization token(s)
		for the client that are not natively handled by the HTTP
		transport. Tokens <em class="rfc2119" title="SHOULD">SHOULD</em> be processed prior to processing of
		<code>location</code>.</dd><dt id="widl-ServerResponse-location"><code>location</code> of type <span class="idlAttrType">DOMString</span>, readonly   </dt><dd>If present, indicates to the client web application that it
		should navigate the Document context to the URI contained on
		this field after processing any tokens.</dd><dt id="widl-ServerResponse-postData"><code>postData</code> of type <span class="idlAttrType">DOMString</span>, readonly   </dt><dd>If present in combination with <code>location</code>, indicates that the
		client should POST the contents to the specified location after
		processing any tokens.</dd><dt id="widl-ServerResponse-newUAFRequest"><code>newUAFRequest</code> of type <span class="idlAttrType">DOMString</span>, readonly   </dt><dd>The server may use this to return a new UAF protocol message.
		This might be used to supply a fresh request to retry an
		operation in response to a transient failure, to request
		additional confirmation for a transaction, or to send a
		deregistration message in response to a permanent failure.</dd></dl></section>
	</section>
	<section id="token-interface">
	  <h4 aria-level="3" role="heading" id="h4_token-interface"><span class="secno">8.3.8 </span>Token interface</h4>
	  <div class="note"><div class="note-title" aria-level="4" role="heading" id="h_note_21"><span>Note</span></div><p class="">The UAF Server is not responsible for creating
	    additional tokens returned as part of a UAF response. Such
	    tokens exist to provide a means for the relying party
	    application to update the authentication/authorization state
	    of the client in response to a successful UAF operation. For
	    example, these fields could be used to allow UAF to serve as
	    the initial authentication leg of a federation protocol, but
	    the scope and details of any such federation are outside of
	    the scope of UAF.</p></div>
	  
	  <pre class="idl"><span class="idlInterface" id="idl-def-Token">interface <span class="idlInterfaceID">Token</span> {
<span class="idlAttribute">    readonly    attribute <span class="idlAttrType"><a href="#idl-def-TokenType" class="idlType"><code>TokenType</code></a></span> <span class="idlAttrName"><a href="#widl-Token-type">type</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class="idlAttrType">DOMString</span> <span class="idlAttrName"><a href="#widl-Token-value">value</a></span>;</span>
};</span></pre><section id="attributes-3"><h5 aria-level="4" role="heading" id="h5_attributes-3"><span class="secno">8.3.8.1 </span>Attributes</h5><dl class="attributes"><dt id="widl-Token-type"><code>type</code> of type <span class="idlAttrType"><a href="#idl-def-TokenType" class="idlType"><code>TokenType</code></a></span>, readonly   </dt><dd>The type of the additional authentication / authorization token.</dd><dt id="widl-Token-value"><code>value</code> of type <span class="idlAttrType">DOMString</span>, readonly   </dt><dd>The string value of the additional authentication / authorization token.</dd></dl></section>
	  
	</section>
	<section id="tokentype-enum">
	  <h4 aria-level="3" role="heading" id="h4_tokentype-enum"><span class="secno">8.3.9 </span>TokenType enum</h4>
	  
	  <pre class="idl"><span class="idlEnum" id="idl-def-TokenType">enum <span class="idlEnumID">TokenType</span> {
    "<a href="#idl-def-TokenType.xHTTP_COOKIE" class="idlEnumItem">HTTP_COOKIE</a>",
    "<a href="#idl-def-TokenType.xOAUTH" class="idlEnumItem">OAUTH</a>",
    "<a href="#idl-def-TokenType.xOAUTH2" class="idlEnumItem">OAUTH2</a>",
    "<a href="#idl-def-TokenType.xSAML1_1" class="idlEnumItem">SAML1_1</a>",
    "<a href="#idl-def-TokenType.xSAML2" class="idlEnumItem">SAML2</a>",
    "<a href="#idl-def-TokenType.xJWT" class="idlEnumItem">JWT</a>",
    "<a href="#idl-def-TokenType.xOPENID_CONNECT" class="idlEnumItem">OPENID_CONNECT</a>"
};</span></pre><table class="simple"><tbody><tr><th colspan="2">Enumeration description</th></tr><tr><td><code id="idl-def-TokenType.xHTTP_COOKIE">HTTP_COOKIE</code></td><td>If the user agent is a standard web browser or other HTTP native
	      client with a cookie store, this TokenType <em class="rfc2119" title="SHOULD NOT">SHOULD NOT</em> be used.
	      Cookies should be set directly with the Set-Cookie HTTP header
	      for processing by the user agent. For non-HTTP or non-browser
	      contexts this indicates a token intended to be set as an HTTP
	      cookie. [<cite><a class="bibref" href="#bib-RFC6265">RFC6265</a></cite>] For example, a native VPN client that
	      authenticates with UAF might use this TokenType to
	      automatically add a cookie to the browser cookie jar.</td></tr><tr><td><code id="idl-def-TokenType.xOAUTH">OAUTH</code></td><td>Indicates that the token is of type OAUTH. [<cite><a class="bibref" href="#bib-RFC5849">RFC5849</a></cite>].</td></tr><tr><td><code id="idl-def-TokenType.xOAUTH2">OAUTH2</code></td><td>Indicates that the token is of type OAUTH2. [<cite><a class="bibref" href="#bib-RFC6749">RFC6749</a></cite>].</td></tr><tr><td><code id="idl-def-TokenType.xSAML1_1">SAML1_1</code></td><td>Indicates that the token is of type SAML 1.1. [<cite><a class="bibref" href="#bib-SAML11">SAML11</a></cite>].</td></tr><tr><td><code id="idl-def-TokenType.xSAML2">SAML2</code></td><td>Indicates that the token is of type SAML 2.0. [<cite><a class="bibref" href="#bib-SAML2-CORE">SAML2-CORE</a></cite>]</td></tr><tr><td><code id="idl-def-TokenType.xJWT">JWT</code></td><td>Indicates that the token is of type JSON Web Token (JWT). [<cite><a class="bibref" href="#bib-JWT">JWT</a></cite>]</td></tr><tr><td><code id="idl-def-TokenType.xOPENID_CONNECT">OPENID_CONNECT</code></td><td>Indicates that the token is an OpenID Connect “id_token”.  [<cite><a class="bibref" href="#bib-OpenIDConnect">OpenIDConnect</a></cite>]</td></tr></tbody></table>
	</section>
	
	<section class="informative certification" id="security-considerations">
	  <h4 aria-level="3" role="heading" id="h4_security-considerations"><span class="secno">8.3.10 </span>Security Considerations</h4><p><em>This section is non-normative.</em></p>
	  
	  <p>It is important that the client set, and the server require, the
	    method be POST and the “Content-Type” HTTP header be the correct
	    values. Because the response body is valid ECMAScript, to
	    protect against unauthorized cross-origin access, a server must not
	    respond to the type of request that can be generated by a
	    script tag, e.g. <code>&lt;script
	    src=”https://example.com/fido/uaf/getRequest”&gt;</code>. The request a
	    user agent generates with this kind of embedding cannot set
	    custom headers.</p>

	  <p>Likewise, by requiring a custom “Content-Type” header,
	    cross-origin requests cannot be made with an XMLHttpRequest [<cite><a class="bibref" href="#bib-XHR">XHR</a></cite>]
	    without triggering a CORS preflight access check. [<cite><a class="bibref" href="#bib-CORS">CORS</a></cite>]</p>
	  
	  <p>As FIDO UAF messages are only valid when used same-origin, servers
	    should not supply an “Access-Control-Allow-Origin” [<cite><a class="bibref" href="#bib-CORS">CORS</a></cite>]
	    header with responses that would allow them to be read by
	    non-same-origin content.</p>
	  
	  <p>To protect from some classes of cross-origin, browser-based,
	    distributed denial-of-service attacks, request endpoints should
	    ignore, without performing additional processing, all requests
	    with an “Access-Control-Request-Method” [<cite><a class="bibref" href="#bib-CORS">CORS</a></cite>] HTTP header or
	    an incorrect “Content-Type” HTTP header.
	  </p> 
	  <p>If a server chooses to respond to requests made with the GET
	    method and without the custom “Content-Type” header, it should
	    apply a prefix string such as “<code>while(1);</code>” or
	    “<code>&amp;&amp;&amp;BEGIN_UAF_RESPONSE&amp;&amp;&amp;</code>” to the body of all replies and so
	    prevent their being read through cross-origin &lt;script&gt; tag
	    embedding. Legitimate same-origin callers will need to (and
	    alone be able to) strip this prefix string before parsing the
	    JSON content.</p>
	</section>
      </section>
    </section>
  

<section id="references" class="appendix" typeof="bibo:Chapter" resource="#ref" rel="bibo:Chapter"><!--OddPage--><h2 aria-level="1" role="heading" id="h2_references"><span class="secno">A. </span>References</h2><section id="normative-references" typeof="bibo:Chapter" resource="#ref" rel="bibo:Chapter"><h3 aria-level="2" role="heading" id="h3_normative-references"><span class="secno">A.1 </span>Normative references</h3><dl class="bibliography" about=""><dt id="bib-AndroidAppManifest">[AndroidAppManifest]</dt><dd rel="dcterms:requires"><a href="http://developer.android.com/guide/topics/manifest/manifest-intro.html"><cite>Android App Manifest</cite></a>. Google, Inc., the Open Handset Alliance and the Android Open Source Project (Work in progress) URL: <a href="http://developer.android.com/guide/topics/manifest/manifest-intro.html">http://developer.android.com/guide/topics/manifest/manifest-intro.html</a>
</dd><dt id="bib-ChannelID">[ChannelID]</dt><dd rel="dcterms:requires">D. Balfanz <a href="http://tools.ietf.org/html/draft-balfanz-tls-channelid"><cite>Transport Layer Security (TLS) Channel IDs</cite></a>. (Work In Progress) URL: <a href="http://tools.ietf.org/html/draft-balfanz-tls-channelid">http://tools.ietf.org/html/draft-balfanz-tls-channelid</a>
</dd><dt id="bib-DOM">[DOM]</dt><dd rel="dcterms:requires">Anne van Kesteren; Aryeh Gregor; Ms2ger; Alex Russell; Robin Berjon. <a href="http://www.w3.org/TR/dom/"><cite>W3C DOM4</cite></a>. 10 July 2014. W3C Last Call Working Draft. URL: <a href="http://www.w3.org/TR/dom/">http://www.w3.org/TR/dom/</a>
</dd><dt id="bib-ECMA-262">[ECMA-262]</dt><dd rel="dcterms:requires"><a href="http://www.ecma-international.org/publications/standards/Ecma-262.htm"><cite>ECMAScript Language Specification, Edition 5.1</cite></a>. June 2011. URL: <a href="http://www.ecma-international.org/publications/standards/Ecma-262.htm">http://www.ecma-international.org/publications/standards/Ecma-262.htm</a>
</dd><dt id="bib-ECMA-404">[ECMA-404]</dt><dd rel="dcterms:requires">. <a href="http://www.ecma-international.org/publications/files/ECMA-ST/ECMA-404.pdf"><cite>The JSON Data Interchange Format</cite></a>. 1 October 2013. Standard. URL: <a href="http://www.ecma-international.org/publications/files/ECMA-ST/ECMA-404.pdf">http://www.ecma-international.org/publications/files/ECMA-ST/ECMA-404.pdf</a>
</dd><dt id="bib-FIDOGlossary">[FIDOGlossary]</dt><dd rel="dcterms:requires">R. Lindemann, D. Baghdasaryan, B. Hill, J. Hodges, <cite>FIDO Technical Glossary</cite>. FIDO Alliance Proposed Standard. URLs: <br>HTML: <a href="https://fidoalliance.org/specs/fido-uaf-v1.0-ps-20141208/fido-glossary-v1.0-ps-20141208.html">fido-glossary-v1.0-ps-20141208.html</a> <br>PDF: <a href="https://fidoalliance.org/specs/fido-uaf-v1.0-ps-20141208/fido-glossary-v1.0-ps-20141208.pdf">fido-glossary-v1.0-ps-20141208.pdf</a>
</dd><dt id="bib-HTML5">[HTML5]</dt><dd rel="dcterms:requires">Ian Hickson; Robin Berjon; Steve Faulkner; Travis Leithead; Erika Doyle Navara; Edward O'Connor; Silvia Pfeiffer. <a href="http://www.w3.org/TR/html5/"><cite>HTML5</cite></a>. 28 October 2014. W3C Recommendation. URL: <a href="http://www.w3.org/TR/html5/">http://www.w3.org/TR/html5/</a>
</dd><dt id="bib-JWT">[JWT]</dt><dd rel="dcterms:requires">M. Jones; J. Bradley; N. Sakimura. <a href="http://tools.ietf.org/html/draft-ietf-oauth-json-web-token-01"><cite>JSON Web Token (JWT)</cite></a>. 6 July 2012. Internet Draft. URL: <a href="http://tools.ietf.org/html/draft-ietf-oauth-json-web-token-01">http://tools.ietf.org/html/draft-ietf-oauth-json-web-token-01</a>
</dd><dt id="bib-OpenIDConnect">[OpenIDConnect]</dt><dd rel="dcterms:requires"><a href="http://openid.net/connect/"><cite>OpenID Connect</cite></a>. OpenID Foundation (Work in Progress) URL: <a href="http://openid.net/connect/">http://openid.net/connect/</a>
</dd><dt id="bib-PNG">[PNG]</dt><dd rel="dcterms:requires">Tom Lane. <a href="http://www.w3.org/TR/PNG"><cite>Portable Network Graphics (PNG) Specification (Second Edition)</cite></a>. 10 November 2003. W3C Recommendation. URL: <a href="http://www.w3.org/TR/PNG">http://www.w3.org/TR/PNG</a>
</dd><dt id="bib-RFC2119">[RFC2119]</dt><dd rel="dcterms:requires">S. Bradner. <a href="https://tools.ietf.org/html/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. March 1997. Best Current Practice. URL: <a href="https://tools.ietf.org/html/rfc2119">https://tools.ietf.org/html/rfc2119</a>
</dd><dt id="bib-RFC2397">[RFC2397]</dt><dd rel="dcterms:requires">L. Masinter. <a href="https://tools.ietf.org/html/rfc2397"><cite>The "data" URL scheme</cite></a>. August 1998. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc2397">https://tools.ietf.org/html/rfc2397</a>
</dd><dt id="bib-RFC2818">[RFC2818]</dt><dd rel="dcterms:requires">E. Rescorla. <a href="https://tools.ietf.org/html/rfc2818"><cite>HTTP Over TLS</cite></a>. May 2000. Informational. URL: <a href="https://tools.ietf.org/html/rfc2818">https://tools.ietf.org/html/rfc2818</a>
</dd><dt id="bib-RFC4648">[RFC4648]</dt><dd rel="dcterms:requires">S. Josefsson, <a href="http://www.ietf.org/rfc/rfc4648.txt"><cite>The Base16, Base32, and Base64 Data Encodings (RFC 4648)</cite></a>, IETF, October 2006, URL: <a href="http://www.ietf.org/rfc/rfc4648.txt">http://www.ietf.org/rfc/rfc4648.txt</a>
</dd><dt id="bib-RFC5849">[RFC5849]</dt><dd rel="dcterms:requires">E. Hammer-Lahav, <a href="http://www.ietf.org/rfc/rfc5849.txt"><cite>The OAuth 1.0 Protocol (RFC 5849)</cite></a>, IETF, April 2010, URL: <a href="http://www.ietf.org/rfc/rfc5849.txt">http://www.ietf.org/rfc/rfc5849.txt</a>
</dd><dt id="bib-RFC5929">[RFC5929]</dt><dd rel="dcterms:requires">J. Altman, N. Williams, L. Zhu, <a href="http://www.ietf.org/rfc/rfc5929.txt"><cite>Channel Bindings for TLS (RFC 5929)</cite></a>, IETF, July 2010, URL: <a href="http://www.ietf.org/rfc/rfc5929.txt">http://www.ietf.org/rfc/rfc5929.txt</a>
</dd><dt id="bib-RFC6125">[RFC6125]</dt><dd rel="dcterms:requires">P. Saint-Andre, J. Hodges, <a href="http://www.ietf.org/rfc/rfc6125.txt"><cite>Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS) (RFC 6125)</cite></a>, IETF, March 2011, URL: <a href="http://www.ietf.org/rfc/rfc6125.txt">http://www.ietf.org/rfc/rfc6125.txt</a>
</dd><dt id="bib-RFC6265">[RFC6265]</dt><dd rel="dcterms:requires">A. Barth. <a href="https://tools.ietf.org/html/rfc6265"><cite>HTTP State Management Mechanism</cite></a>. April 2011. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc6265">https://tools.ietf.org/html/rfc6265</a>
</dd><dt id="bib-RFC6454">[RFC6454]</dt><dd rel="dcterms:requires">A. Barth. <a href="https://tools.ietf.org/html/rfc6454"><cite>The Web Origin Concept</cite></a>. December 2011. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc6454">https://tools.ietf.org/html/rfc6454</a>
</dd><dt id="bib-RFC6749">[RFC6749]</dt><dd rel="dcterms:requires">D. Hardt, Ed., <a href="http://www.ietf.org/rfc/rfc6749.txt"><cite>The OAuth 2.0 Authorization Framework (RFC 6749)</cite></a>, IETF, October 2012, URL: <a href="http://www.ietf.org/rfc/rfc6749.txt">http://www.ietf.org/rfc/rfc6749.txt</a>
</dd><dt id="bib-RFC7230">[RFC7230]</dt><dd rel="dcterms:requires">R. Fielding, Ed.; J. Reschke, Ed.. <a href="https://tools.ietf.org/html/rfc7230"><cite>Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing</cite></a>. June 2014. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc7230">https://tools.ietf.org/html/rfc7230</a>
</dd><dt id="bib-RFC7231">[RFC7231]</dt><dd rel="dcterms:requires">R. Fielding, Ed.; J. Reschke, Ed.. <a href="https://tools.ietf.org/html/rfc7231"><cite>Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content</cite></a>. June 2014. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc7231">https://tools.ietf.org/html/rfc7231</a>
</dd><dt id="bib-SAML11">[SAML11]</dt><dd rel="dcterms:requires">E. Maler, P. Mishra and R. Philpott, <a href="https://www.oasis-open.org/standards#samlv1.1"><cite>The Security Assertion Markup Language (SAML) v1.1</cite></a>. OASIS, October 2003, URL: <a href="https://www.oasis-open.org/standards#samlv1.1">https://www.oasis-open.org/standards#samlv1.1</a>
</dd><dt id="bib-SAML2-CORE">[SAML2-CORE]</dt><dd rel="dcterms:requires">Scott Cantor; John Kemp; Rob Philpott; Eve Maler. <a href="http://docs.oasis-open.org/security/saml/v2.0/saml-core-2.0-os.pdf"><cite>Assertions and Protocols for SAML V2.0</cite></a> 15 March 2005. URL: <a href="http://docs.oasis-open.org/security/saml/v2.0/saml-core-2.0-os.pdf">http://docs.oasis-open.org/security/saml/v2.0/saml-core-2.0-os.pdf</a>
</dd><dt id="bib-UAFAuthnrMetadata">[UAFAuthnrMetadata]</dt><dd rel="dcterms:requires">B. Hill, D. Baghdasaryan, J. Kemp, <cite>FIDO UAF Authenticator Metadata Statements v1.0</cite>. FIDO Alliance Proposed Standard. URLs: <br>HTML:  <a href="https://fidoalliance.org/specs/fido-uaf-v1.0-ps-20141208/fido-uaf-authnr-metadata-v1.0-ps-20141208.html">fido-uaf-authnr-metadata-v1.0-ps-20141208.html</a><br>PDF: <a href="https://fidoalliance.org/specs/fido-uaf-v1.0-ps-20141208/fido-uaf-authnr-metadata-v1.0-ps-20141208.pdf">fido-uaf-authnr-metadata-v1.0-ps-20141208.pdf</a>
</dd><dt id="bib-UAFProtocol">[UAFProtocol]</dt><dd rel="dcterms:requires">R. Lindemann, D. Baghdasaryan, E. Tiffany, D. Balfanz, B. Hill, J. Hodges, <cite>FIDO UAF Protocol Specification v1.0</cite>. FIDO Alliance Proposed Standard. URLs: <br>HTML: <a href="https://fidoalliance.org/specs/fido-uaf-v1.0-ps-20141208/fido-uaf-protocol-v1.0-ps-20141208.html">fido-uaf-protocol-v1.0-ps-20141208.html</a> <br>PDF: <a href="https://fidoalliance.org/specs/fido-uaf-v1.0-ps-20141208/fido-uaf-protocol-v1.0-ps-20141208.pdf">fido-uaf-protocol-v1.0-ps-20141208.pdf</a>
</dd><dt id="bib-UAFRegistry">[UAFRegistry]</dt><dd rel="dcterms:requires">R. Lindemann, D. Baghdasaryan, B. Hill, <cite>FIDO UAF Registry of Predefined Values</cite>. FIDO Alliance Proposed Standard. URLs: <br>HTML: <a href="https://fidoalliance.org/specs/fido-uaf-v1.0-ps-20141208/fido-uaf-reg-v1.0-ps-20141208.html">fido-uaf-reg-v1.0-ps-20141208.html</a> <br>PDF: <a href="https://fidoalliance.org/specs/fido-uaf-v1.0-ps-20141208/fido-uaf-reg-v1.0-ps-20141208.pdf">fido-uaf-reg-v1.0-ps-20141208.pdf</a>
</dd><dt id="bib-WebIDL-ED">[WebIDL-ED]</dt><dd rel="dcterms:requires">Cameron McCormack, <a href="http://heycam.github.io/webidl/"><cite>Web IDL</cite></a>, W3C.  Editor's Draft 13 November 2014.  URL: <a href="http://heycam.github.io/webidl/">http://heycam.github.io/webidl/</a>
</dd></dl></section><section id="informative-references" typeof="bibo:Chapter" resource="#ref" rel="bibo:Chapter"><h3 aria-level="2" role="heading" id="h3_informative-references"><span class="secno">A.2 </span>Informative references</h3><dl class="bibliography" about=""><dt id="bib-ANDROID">[ANDROID]</dt><dd rel="dcterms:references"><a href="http://developer.android.com/"><cite>The Android™ Operating System</cite></a>. Google, Inc., the Open Handset Alliance and the Android Open Source Project (Work in progress) URL: <a href="http://developer.android.com/">http://developer.android.com/</a>
</dd><dt id="bib-Android5Changes">[Android5Changes]</dt><dd rel="dcterms:references"><a href="http://developer.android.com/about/versions/android-5.0-changes.html"><cite>Android 5.0 Changes</cite></a>. Google, Inc., the Open Handset Alliance and the Android Open Source Project (Work in progress) URL: <a href="http://developer.android.com/about/versions/android-5.0-changes.html">http://developer.android.com/about/versions/android-5.0-changes.html</a>
</dd><dt id="bib-CORS">[CORS]</dt><dd rel="dcterms:references">Anne van Kesteren. <a href="http://www.w3.org/TR/cors/"><cite>Cross-Origin Resource Sharing</cite></a>. 16 January 2014. W3C Recommendation. URL: <a href="http://www.w3.org/TR/cors/">http://www.w3.org/TR/cors/</a>
</dd><dt id="bib-RFC2045">[RFC2045]</dt><dd rel="dcterms:references">N. Freed; N. Borenstein. <a href="https://tools.ietf.org/html/rfc2045"><cite>Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies</cite></a>. November 1996. Draft Standard. URL: <a href="https://tools.ietf.org/html/rfc2045">https://tools.ietf.org/html/rfc2045</a>
</dd><dt id="bib-RFC2246">[RFC2246]</dt><dd rel="dcterms:references">T. Dierks, E. Rescorla, <a href="http://www.ietf.org/rfc/rfc2246.txt"><cite>The TLS Protocol Version 1.0</cite></a>, IETF, January 1999, URL: <a href="http://www.ietf.org/rfc/rfc2246.txt">http://www.ietf.org/rfc/rfc2246.txt</a>
</dd><dt id="bib-RFC2560">[RFC2560]</dt><dd rel="dcterms:references">M. Myers; R. Ankney; A. Malpani; S. Galperin; C. Adams. <a href="https://tools.ietf.org/html/rfc2560"><cite>X.509 Internet Public Key Infrastructure Online Certificate Status Protocol - OCSP</cite></a>. June 1999. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc2560">https://tools.ietf.org/html/rfc2560</a>
</dd><dt id="bib-RFC4120">[RFC4120]</dt><dd rel="dcterms:references">C. Neuman, T. Yu, S. Hartman, K. Raeburn, <a href="http://www.ietf.org/rfc/rfc4120.txt"><cite>The Kerberos Network Authentication Protocol (V5) (RFC 4120)</cite></a>, IETF, July 2005, URL: <a href="http://www.ietf.org/rfc/rfc4120.txt">http://www.ietf.org/rfc/rfc4120.txt</a>
</dd><dt id="bib-RFC4346">[RFC4346]</dt><dd rel="dcterms:references">T. Dierks, E. Rescorla, <a href="http://www.ietf.org/rfc/rfc4346.txt"><cite>The Transport Layer Security (TLS) Protocol Version 1.1</cite></a>, IETF, April 2006, URL: <a href="http://www.ietf.org/rfc/rfc4346.txt">http://www.ietf.org/rfc/rfc4346.txt</a>
</dd><dt id="bib-RFC5246">[RFC5246]</dt><dd rel="dcterms:references">T. Dierks, E. Rescorla, <a href="http://www.ietf.org/rfc/rfc5246.txt"><cite>The Transport Layer Security (TLS) Protocol</cite></a>, IETF, August 2008, URL: <a href="http://www.ietf.org/rfc/rfc5246.txt">http://www.ietf.org/rfc/rfc5246.txt</a>
</dd><dt id="bib-RFC5280">[RFC5280]</dt><dd rel="dcterms:references">D. Cooper, S. Santesson, s. Farrell, S.Boeyen, R. Housley, W. Polk; <a href="http://www.ietf.org/rfc/rfc5280.txt"><cite>Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</cite></a>, IETF, May 2008, URL: <a href="http://www.ietf.org/rfc/rfc5280.txt">http://www.ietf.org/rfc/rfc5280.txt</a>
</dd><dt id="bib-SOP">[SOP]</dt><dd rel="dcterms:references"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Same_origin_policy_for_JavaScript"><cite>Same Origin Policy for JavaScript</cite></a>. Mozilla Developer Network, January 2014 URL: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Same_origin_policy_for_JavaScript">https://developer.mozilla.org/en-US/docs/Web/JavaScript/Same_origin_policy_for_JavaScript</a>
</dd><dt id="bib-SP800-131A">[SP800-131A]</dt><dd rel="dcterms:references">E. Barker, A. Roginsky, <a href="http://csrc.nist.gov/publications/nistpubs/800-131A/sp800-131A.pdf"><cite>NIST Special Publication 800-131A: Transitions: Recommendation for Transitioning the Use of Cryptographic Algorithms and Key Lengths</cite></a>. National Institute of Standards and Technology, January 2011, URL: <a href="http://csrc.nist.gov/publications/nistpubs/800-131A/sp800-131A.pdf">http://csrc.nist.gov/publications/nistpubs/800-131A/sp800-131A.pdf</a>
</dd><dt id="bib-TLS13draft02">[TLS13draft02]</dt><dd rel="dcterms:references">T. Dierks, E. Rescorla, <a href="https://tools.ietf.org/html/draft-ietf-tls-tls13-02"><cite>The Transport Layer Security (TLD) Protocol Version 1.3 (draft 02)</cite></a>, IETF, July, 2014, URL: <a href="https://tools.ietf.org/html/draft-ietf-tls-tls13-02">https://tools.ietf.org/html/draft-ietf-tls-tls13-02</a>
</dd><dt id="bib-UAFASM">[UAFASM]</dt><dd rel="dcterms:references">D. Baghdasaryan, J. Kemp, R. Lindemann, B. Hill, R. Sasson, <cite>FIDO UAF Authenticator-Specific Module API</cite>. FIDO Alliance Proposed Standard. URLs: <br>HTML: <a href="https://fidoalliance.org/specs/fido-uaf-v1.0-ps-20141208/fido-uaf-asm-api-v1.0-ps-20141208.html">fido-uaf-asm-api-v1.0-ps-20141208.html</a><br>PDF:  <a href="https://fidoalliance.org/specs/fido-uaf-v1.0-ps-20141208/fido-uaf-asm-api-v1.0-ps-20141208.pdf">fido-uaf-asm-api-v1.0-ps-20141208.pdf</a>
</dd><dt id="bib-WebIDL">[WebIDL]</dt><dd rel="dcterms:references">Cameron McCormack. <a href="http://www.w3.org/TR/WebIDL/"><cite>Web IDL</cite></a>. 19 April 2012. W3C Candidate Recommendation. URL: <a href="http://www.w3.org/TR/WebIDL/">http://www.w3.org/TR/WebIDL/</a>
</dd><dt id="bib-XHR">[XHR]</dt><dd rel="dcterms:references">Anne van Kesteren. <a href="https://xhr.spec.whatwg.org/"><cite>XMLHttpRequest</cite></a>. Living Standard . URL: <a href="https://xhr.spec.whatwg.org/">https://xhr.spec.whatwg.org/</a>
</dd><dt id="bib-webmessaging">[webmessaging]</dt><dd rel="dcterms:references">Ian Hickson. <a href="http://www.w3.org/TR/webmessaging/"><cite>HTML5 Web Messaging</cite></a>. 1 May 2012. W3C Candidate Recommendation. URL: <a href="http://www.w3.org/TR/webmessaging/">http://www.w3.org/TR/webmessaging/</a>
</dd></dl></section></section></body></html>